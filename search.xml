<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>中小型园区网络构建（一）—— 概述与SDN网络</title>
      <link href="/ed5df591/"/>
      <url>/ed5df591/</url>
      
        <content type="html"><![CDATA[<h1 id="概述-4">概述</h1><p>为了构建一个可以实现互联互通、支持多种网络技术并可提供一定网络功能的中小型网络，通过分析讨论我们的实现规划如下：</p><ol><li>确定拓扑，针对中小型网络，搭建拓扑结构</li><li>确定所需的硬件或软件设备，我们计划在Ubuntu系统中，使用Mininet完成拓扑搭建同时完成各项要求</li><li>实现网络设备的正确的安装和配置，实现各个网络设备之间的互联互通，同时在此基础上，考虑设备之间的冗余、鲁棒性问题</li><li>完成各项网络技术的实现，如：使用SDN网络控制器进行联通、区分子网、使用NAT技术实现外网联通等</li><li>配置网络的安全设置，包括防火墙、访问控制列表等</li><li>安装和配置必要的软件，包括服务器软件、数据库软件等</li></ol><hr><h1 id="SDN网络介绍">SDN网络介绍</h1><p>软件定义网络SDN（Software Defined Network）是由美国斯坦福大学CLean Slate研究组提出的一种新型网络创新架构，可通过软件编程的形式定义和控制网络，其控制平面和转发平面分离及开放性可编程的特点，被认为是网络领域的一场革命，为新型互联网体系结构研究提供了新的实验途径，也极大地推动了下一代互联网的发展。</p><h2 id="SDN网络架构">SDN网络架构</h2><p>SDN的整体架构由下到上（由南到北）分为数据平面、控制平面和应用平面，具体如图2-1所示。其中，数据平面由交换机等网络通用硬件组成，各个网络设备之间通过不同规则形成的SDN数据通路连接；控制平面包含了逻辑上为中心的SDN控制器，它掌握着全局网络信息，负责各种转发规则的控制；应用平面包含着各种基于SDN的网络应用，用户无需关心底层细节就可以编程、部署新应用。</p><p><img src="https://image.asa-world.cn/pic/image-20230206151457029.png" alt="SDN架构图"></p><p>控制平面与数据平面之间通过SDN控制数据平面接口（control-data-plane interface，简称CDPI）进行通信，它具有统一的通信标准，主要负责将控制器中的转发规则下发至转发设备，最主要应用的是OpenFlow协议。控制平面与应用平面之间通过SDN北向接口（northbound interface，简称NBI）进行通信，而NBI并非统一标准，它允许用户根据自身需求定制开发各种网络管理应用。</p><p>SDN中的接口具有开放性，以控制器为逻辑中心，南向接口负责与数据平面进行通信，北向接口负责与应用平面进行通信，东西向接口负责多控制器之间的通信。最主流的南向接口CDPI采用的是OpenFlow协议。OpenFlow最基本的特点是基于流（Flow）的概念来匹配转发规则，每一个交换机都维护一个流表（Flow Table），依据流表中的转发规则进行转发，而流表的建立、维护和下发都是由控制器完成的。针对北向接口，应用程序通过北向接口编程来调用所需的各种网络资源，实现对网络的快速配置和部署。东西向接口使控制器具有可扩展性，为负载均衡和性能提升提供了技术保障。</p><h2 id="SDN的优势">SDN的优势</h2><p>SDN具有传统网络无法比拟的优势：首先，数据控制解耦合使得应用升级与设备更新换代相互独立，加快了新应用的快速部署；其次，网络抽象简化了网络模型,将运营商从繁杂的网络管理中解放出来，能够更加灵活地控制网络；最后，控制的逻辑中心化使用户和运营商等可以通过控制器获取全局网络信息，从而优化网络，提升网络性能。</p><hr><h1 id="SDN设计方案">SDN设计方案</h1><h2 id="需求分析-4">需求分析</h2><p>在我们设计的网络中，为了更加方便的管理网络并且利用编程的方式去设计网络，因此我们需要选择利用SDN网络技术去搭建我们的网络。并且我们所设计的网络是一个划分子网的网络架构，因此我们需要一个路由协议，对我们该网络的报文进行转发处理。而由于原本的OSPF以及RIP动态路由协议不适合部署在SDN网络下，因此我们选择自己构建私有的路由协议实现路由功能，使得转发自动寻路。</p><p>而在路由协议的过程中，我们需要考虑到拓扑的带宽是否充足，是否会发生拥塞，避免某一条链路负载过大的现象发生，因此我们还需要设计流量监控的功能，便于我们分析网络中的链路负载信息，从而实现路由协议选择路径的时候，能够动态的选择最优路径，从而减轻对于我们网络中链路中的负载。</p><h2 id="SDN网络规划">SDN网络规划</h2><p>我们需要将网络划分网段，并且构建核心交换部分，其中主干网拓扑图所示，在我们设计的网络中，包括DHCP服务器、NAPT服务节点S7、web服务器、ftp服务器、以及各个网段，所属网段分别为192.168.1.0/24、192.168.2.0/24、192.168.3.0/24、192.168.4.0/24。</p><p><img src="https://image.asa-world.cn/pic/image-20230206151724843.png" alt="SDN主干网络设计"></p><h2 id="网络路由设计方案">网络路由设计方案</h2><p>在我们设计的网络中，我们将网段分别为192.168.1.0/24、192.168.2.0/24、192.168.3.0/24、192.168.4.0/24。而其中每个子网的网关分别为子网中的openflow交换机。其中所用架构为SDN网络，并没有传统路由器，因此无法使用如OSPF、RIP等动态路由协议，因此为了实现跨子网的联通和交互自动寻路过程，我们选择设计私有的路由协议，从而现实我们的SDN网络中的跨子网通信。</p><p><img src="https://image.asa-world.cn/pic/image-20230206152055294.png" alt="路由协议流程图"></p><p>其中我们所设计的路由协议流程如下：</p><ol><li>当网络中主机发送报文的时候首先判断目的IP是否为自己所在为同一个网络，如果是则按照同一子网进行交互，如果不是则请求网关mac，并发向网关。</li><li>当网关收到报文后，判断是否有流表项匹配可以转发该报文，如果有则按照流表修改mac并进行转发，如果没有则发送给控制器。</li><li>控制器接收到报文后，判断目的地址是否有arp记录，如果没有则，从每个边界交换机向边界发送arp请求，并缓存报文。如果有则跳向5)。</li><li>当控制器收到arp回复报文之后记录源地址的mac和ip对应情况，以及端口、交换机信息。跳向5)</li><li>控制器根据报文的源信息和目的信息（mac地址、交换机、端口号、链路的负载情况），利用Dijkstra算法进行寻路计算，计算出当前的最优路径。</li><li>根据寻路结果进行寻路流表和mac地址更改流表的下发，使得下一次报文可以直接依靠流表进行转发。</li><li>将报文从目的地址记录的交换机和端口送出。</li></ol><blockquote><p>其中在步骤6，下发流表的情况如下所述：</p><ol><li>路径中的第一个openflow交换机：匹配为报文的目的IP地址，且目的mac为网关mac地址；作用为修改报文的mac地址为其IP对应的mac地址以及转发该报文。</li><li>路径中的后续openflow交换机：匹配为报文的目的IP地址；作用为转发报文。</li></ol></blockquote><p>采用以上的路由协议可以实现我们的SDN网络的划分子网的通信，并且依靠下发流表的方式，并且采用Dijkstra算法进行寻路计算，可以使得在一次寻路之后，短时间内依靠流表进行转发，并且转发路径为当前最优，提高我们的减少我们的报文传输延迟和降低我们的丢包率。</p><h2 id="流量监控设计方案">流量监控设计方案</h2><p>在上述我们设计的网络以及路由协议中，我们所用的寻路方法为掌网络拓扑信息后利用Dijkstra算法进行寻路计算，而这之中，需要知道每条链路的权重信息。因此我们这里选择利用控制器定期请求每个交换机的每个端口的byte接收总数，并与历史记录中的byte数相减，从而算出近段时间内的链路负载情况，随后将链路负载情况归一化计算得出每条链路的权重，从而使得我们可以利用Dijkstra算法算出我们的最优报文转发数据。</p><p><img src="https://image.asa-world.cn/pic/image-20230206152103897.png" alt="流量监控流程图"></p><hr><h1 id="SDN网络的实现">SDN网络的实现</h1><h2 id="拓扑搭建">拓扑搭建</h2><details class="folding-tag" blue><summary> 网络和控制器的生成 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">net = Mininet(topo=<span class="literal">None</span>,</span><br><span class="line">              build=<span class="literal">False</span>,</span><br><span class="line">              ipBase=<span class="string">&#x27;192.168.0.0/20&#x27;</span>)</span><br><span class="line"></span><br><span class="line">info(<span class="string">&#x27;*** Adding controller\n&#x27;</span>)</span><br><span class="line">c0 = net.addController(name=<span class="string">&#x27;c0&#x27;</span>,</span><br><span class="line">                       controller=RemoteController,</span><br><span class="line">                       ip=<span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">                       protocol=<span class="string">&#x27;tcp&#x27;</span>,</span><br><span class="line">                       port=<span class="number">6633</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 交换机的生成 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">info(<span class="string">&#x27;*** Add switches\n&#x27;</span>)</span><br><span class="line">s9 = net.addSwitch(<span class="string">&#x27;s9&#x27;</span>, cls=OVSKernelSwitch, failMode=<span class="string">&#x27;standalone&#x27;</span>)</span><br><span class="line">s5 = net.addSwitch(<span class="string">&#x27;s5&#x27;</span>, cls=OVSKernelSwitch, dpid=<span class="string">&#x27;0000000000000005&#x27;</span>)</span><br><span class="line">s4 = net.addSwitch(<span class="string">&#x27;s4&#x27;</span>, cls=OVSKernelSwitch, dpid=<span class="string">&#x27;0000000000000004&#x27;</span>)</span><br><span class="line">s11 = net.addSwitch(<span class="string">&#x27;s11&#x27;</span>, cls=OVSKernelSwitch, failMode=<span class="string">&#x27;standalone&#x27;</span>)</span><br><span class="line">s3 = net.addSwitch(<span class="string">&#x27;s3&#x27;</span>, cls=OVSKernelSwitch, dpid=<span class="string">&#x27;0000000000000003&#x27;</span>)</span><br><span class="line">s6 = net.addSwitch(<span class="string">&#x27;s6&#x27;</span>, cls=OVSKernelSwitch, dpid=<span class="string">&#x27;0000000000000006&#x27;</span>)</span><br><span class="line">s10 = net.addSwitch(<span class="string">&#x27;s10&#x27;</span>, cls=OVSKernelSwitch, failMode=<span class="string">&#x27;standalone&#x27;</span>)</span><br><span class="line">s7 = net.addSwitch(<span class="string">&#x27;s7&#x27;</span>, cls=OVSKernelSwitch, dpid=<span class="string">&#x27;0000000000000007&#x27;</span>)</span><br><span class="line">s8 = net.addSwitch(<span class="string">&#x27;s8&#x27;</span>, cls=OVSKernelSwitch, failMode=<span class="string">&#x27;standalone&#x27;</span>)</span><br><span class="line">s1 = net.addSwitch(<span class="string">&#x27;s1&#x27;</span>, cls=OVSKernelSwitch, dpid=<span class="string">&#x27;0000000000000001&#x27;</span>)</span><br><span class="line">s2 = net.addSwitch(<span class="string">&#x27;s2&#x27;</span>, cls=OVSKernelSwitch, dpid=<span class="string">&#x27;0000000000000002&#x27;</span>)</span><br><span class="line">dhcp = net.addSwitch(<span class="string">&#x27;dhcp&#x27;</span>, cls=OVSKernelSwitch, dpid=<span class="string">&#x27;0000000000000008&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 主机的生成 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">info(<span class="string">&#x27;*** Add hosts\n&#x27;</span>)</span><br><span class="line">h8 = net.addHost(<span class="string">&#x27;h8&#x27;</span>, cls=Host,ip=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br><span class="line">h9 = net.addHost(<span class="string">&#x27;h9&#x27;</span>, cls=Host,ip=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br><span class="line"><span class="comment">#h4 = net.addHost(&#x27;h4&#x27;, cls=Host, ip=&#x27;192.168.2.60/24&#x27;, defaultRoute=&#x27;via 192.168.2.254&#x27;)</span></span><br><span class="line">h4 = net.addHost(<span class="string">&#x27;h4&#x27;</span>, cls=Host,ip=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br><span class="line">h7 = net.addHost(<span class="string">&#x27;h7&#x27;</span>, cls=Host,ip=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br><span class="line"><span class="comment">#h1 = net.addHost(&#x27;h1&#x27;, cls=Host, ip=&#x27;192.168.1.60/24&#x27;, defaultRoute=&#x27;via 192.168.1.254&#x27;)</span></span><br><span class="line">h1 = net.addHost(<span class="string">&#x27;h1&#x27;</span>, cls=Host,ip=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br><span class="line">h3 = net.addHost(<span class="string">&#x27;h3&#x27;</span>, cls=Host,ip=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br><span class="line">h2 = net.addHost(<span class="string">&#x27;h2&#x27;</span>, cls=Host,ip=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br><span class="line">h5 = net.addHost(<span class="string">&#x27;h5&#x27;</span>, cls=Host,ip=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br><span class="line">h6 = net.addHost(<span class="string">&#x27;h6&#x27;</span>, cls=Host,ip=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> NAPT和服务器的网卡接入 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">info(<span class="string">&#x27;*** Add NAT\n&#x27;</span>)</span><br><span class="line"><span class="comment"># nat = net.addNAT(&#x27;nat&#x27;, connect=False, ip=&#x27;192.168.5.1/20&#x27;, inNamespace = False)</span></span><br><span class="line">_intf_1 = Intf(intfName1, node=s7, port=<span class="number">1</span>)</span><br><span class="line">_intf_2 = Intf(intfName2, node=s11, port=<span class="number">5</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 链路连接的生成 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">info(<span class="string">&#x27;*** Add links\n&#x27;</span>)</span><br><span class="line"><span class="comment"># net.addLink(nat, s7, 1, 1)</span></span><br><span class="line">net.addLink(s10, s3, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">net.addLink(s9, s2, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">net.addLink(s8, s1, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">net.addLink(s11, s6, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">net.addLink(s6, s7, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">net.addLink(s7, s4, <span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line">net.addLink(s7, s5, <span class="number">4</span>, <span class="number">1</span>)</span><br><span class="line">net.addLink(s4, s5, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">net.addLink(s4, s1, <span class="number">3</span>, <span class="number">2</span>)</span><br><span class="line">net.addLink(s4, s2, <span class="number">4</span>, <span class="number">2</span>)</span><br><span class="line">net.addLink(s4, s3, <span class="number">5</span>, <span class="number">2</span>)</span><br><span class="line">net.addLink(s1, s5, <span class="number">3</span>, <span class="number">3</span>)</span><br><span class="line">net.addLink(s5, s2, <span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line">net.addLink(s5, s3, <span class="number">5</span>, <span class="number">3</span>)</span><br><span class="line">net.addLink(h1, s8, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">net.addLink(s8, h2, <span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line">net.addLink(s8, h3, <span class="number">4</span>, <span class="number">1</span>)</span><br><span class="line">net.addLink(s9, h4, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">net.addLink(s9, h5, <span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line">net.addLink(s9, h6, <span class="number">4</span>, <span class="number">1</span>)</span><br><span class="line">net.addLink(s10, h7, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">net.addLink(s10, h8, <span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line">net.addLink(s10, h9, <span class="number">4</span>, <span class="number">1</span>)</span><br><span class="line">net.addLink(dhcp, s4, <span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line">net.addLink(dhcp, s5, <span class="number">2</span>, <span class="number">6</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 交换机与网络的启动 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">info(<span class="string">&#x27;*** Starting network\n&#x27;</span>)</span><br><span class="line">net.build()</span><br><span class="line">net.start()</span><br><span class="line">info(<span class="string">&#x27;*** Starting controllers\n&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> controller <span class="keyword">in</span> net.controllers:</span><br><span class="line">    controller.start()</span><br><span class="line"></span><br><span class="line">info(<span class="string">&#x27;*** Starting switches\n&#x27;</span>)</span><br><span class="line">net.get(<span class="string">&#x27;s9&#x27;</span>).start([])</span><br><span class="line">net.get(<span class="string">&#x27;s5&#x27;</span>).start([c0])</span><br><span class="line">net.get(<span class="string">&#x27;s4&#x27;</span>).start([c0])</span><br><span class="line">net.get(<span class="string">&#x27;s11&#x27;</span>).start([])</span><br><span class="line">net.get(<span class="string">&#x27;s3&#x27;</span>).start([c0])</span><br><span class="line">net.get(<span class="string">&#x27;s6&#x27;</span>).start([c0])</span><br><span class="line">net.get(<span class="string">&#x27;s10&#x27;</span>).start([])</span><br><span class="line">net.get(<span class="string">&#x27;s7&#x27;</span>).start([c0])</span><br><span class="line">net.get(<span class="string">&#x27;s8&#x27;</span>).start([])</span><br><span class="line">net.get(<span class="string">&#x27;s1&#x27;</span>).start([c0])</span><br><span class="line">net.get(<span class="string">&#x27;s2&#x27;</span>).start([c0])</span><br><span class="line">net.get(<span class="string">&#x27;dhcp&#x27;</span>).start([c0])</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> NAPT和DHCP中继的脚本运行 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">    h1.cmd(<span class="string">&quot;chmod 777 /etc/resolv.conf&quot;</span>)</span><br><span class="line">    h1.cmd(<span class="string">&quot;echo $&#x27;nameserver 8.8.8.8\noptions edns0\nsearch localdomain example.org&#x27;  &gt; /etc/resolv.conf&quot;</span>)</span><br><span class="line"></span><br><span class="line">    net.get(<span class="string">&#x27;dhcp&#x27;</span>).cmd(<span class="string">&#x27;ifconfig dhcp-eth1 192.168.0.1 netmask 255.255.255.0&#x27;</span>)</span><br><span class="line">    net.get(<span class="string">&#x27;dhcp&#x27;</span>).cmd(<span class="string">&#x27;ifconfig dhcp-eth2 192.168.0.2 netmask 255.255.255.0&#x27;</span>)</span><br><span class="line">    net.get(<span class="string">&#x27;dhcp&#x27;</span>).cmd(<span class="string">&quot; ip route add 192.168.0.0/21 dev dhcp-eth1 via 192.168.0.254&quot;</span>)</span><br><span class="line">    dhcp.cmd(<span class="string">&quot; arp -s 192.168.0.254 00:00:00:00:11:00&quot;</span>)</span><br><span class="line">    dhcp.cmd(<span class="string">&quot;rm -r /var/lib/dhcp/dhclient.leases&quot;</span>)</span><br><span class="line">    dhcp.cmd(<span class="string">&quot;rm -r /var/lib/dhcp/dhcpd.leases&quot;</span>)</span><br><span class="line">    dhcp.cmd(<span class="string">&quot;service isc-dhcp-server restart &amp;&quot;</span>)</span><br><span class="line">    <span class="built_in">input</span>(<span class="string">&quot;------------Waiting to start controller and enter space to continue------------&quot;</span>)</span><br><span class="line">    info(<span class="string">&#x27;*** Post configure switches and hosts\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> host <span class="keyword">in</span> net.hosts:</span><br><span class="line">        <span class="keyword">if</span> host.params[<span class="string">&#x27;ip&#x27;</span>] == <span class="string">&#x27;0.0.0.0&#x27;</span>:</span><br><span class="line">            get_ip(host)</span><br><span class="line">    info(<span class="string">&#x27;*** Post configure switches and hosts\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    CLI(net)</span><br><span class="line">    net.stop()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_ip</span>(<span class="params">host</span>):</span><br><span class="line">    info(<span class="string">&#x27;*** get ip for &#123;&#125;\n&#x27;</span>.<span class="built_in">format</span>(host))</span><br><span class="line">    host.cmd(<span class="string">&quot;dhclient &#123;&#125;-eth1&quot;</span>.<span class="built_in">format</span>(host.name))</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="控制器的初始化">控制器的初始化</h2><p>在控初始阶段制器需要进行初始化，才能知晓全局的交换拓扑信息，并且交换机才有默认发给控制器的流表项，随后才能实现我们项目中的报文交互过程，并且这个初始化也能实现我们项目中某条链路断开后的重新掌握信息，增加网络的健壮性。</p><details class="folding-tag" blue><summary> 检测链路的加入和离开 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@set_ev_cls(<span class="params">event.EventLinkAdd</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_link_add_handler</span>(<span class="params">self, event</span>):</span><br><span class="line">    self.logger.info(<span class="string">&quot;!!!A link add.Topology rediscovery...&quot;</span>)</span><br><span class="line">    self.switch_status_handler(event, <span class="string">&#x27;add&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@set_ev_cls(<span class="params">event.EventLinkDelete</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_link_delete_handler</span>(<span class="params">self, event</span>):</span><br><span class="line">    self.logger.info(<span class="string">&quot;!!!A link leaved.Topology rediscovery...&quot;</span>)</span><br><span class="line">    self.switch_status_handler(event, <span class="string">&#x27;dele&#x27;</span>)</span><br><span class="line">    self.dele_flow(event)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dele_flow</span>(<span class="params">self, event</span>):</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> self.all_switches:</span><br><span class="line">        datapath = s.dp</span><br><span class="line">        ofproto = datapath.ofproto</span><br><span class="line">        parser = datapath.ofproto_parser</span><br><span class="line">        <span class="keyword">match</span> = parser.OFPMatch(eth_type=ether_types.ETH_TYPE_IP)</span><br><span class="line">        mod = parser.OFPFlowMod(datapath=datapath,</span><br><span class="line">                                command=ofproto.OFPFC_DELETE,</span><br><span class="line">                                out_port=ofproto.OFPP_ANY,</span><br><span class="line">                                out_group=ofproto.OFPG_ANY,</span><br><span class="line">                                <span class="keyword">match</span>=<span class="keyword">match</span>)</span><br><span class="line">        datapath.send_msg(mod)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 记录链路和交换机并初始化 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">switch_status_handler</span>(<span class="params">self, event, <span class="built_in">type</span></span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span> == <span class="string">&#x27;dele&#x27;</span>:</span><br><span class="line">            self.topo.init()</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&#x27;add&#x27;</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        all_switches = copy.copy(get_switch(self, <span class="literal">None</span>))</span><br><span class="line">        self.all_switches = all_switches</span><br><span class="line">        <span class="comment"># 获取交换机的端口地址</span></span><br><span class="line">        self.switch_adds = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> s <span class="keyword">in</span> all_switches:</span><br><span class="line">            <span class="keyword">for</span> port <span class="keyword">in</span> s.ports:</span><br><span class="line">                self.switch_adds[(s.dp.<span class="built_in">id</span>, port.port_no)] = port.hw_addr</span><br><span class="line">        self.nat_switch = copy.copy(get_switch(self, self.nat_switch_id))[<span class="number">0</span>]</span><br><span class="line">        self.logger.info(<span class="string">&#x27;-----------------------------nat switch is: &#123;&#125;----------------&#x27;</span>.<span class="built_in">format</span>(self.nat_switch.dp.<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># get all datapathid</span></span><br><span class="line">        <span class="comment"># 获取交换机的ID值</span></span><br><span class="line">        self.topo.switches = [s.dp.<span class="built_in">id</span> <span class="keyword">for</span> s <span class="keyword">in</span> all_switches]</span><br><span class="line"></span><br><span class="line">        self.logger.info(<span class="string">&quot;switches &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.topo.switches))</span><br><span class="line"></span><br><span class="line">        self.datapaths = [s.dp <span class="keyword">for</span> s <span class="keyword">in</span> all_switches]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># get link and get port</span></span><br><span class="line"></span><br><span class="line">        all_link_stats = [(l.src.dpid, l.dst.dpid, l.src.port_no, l.dst.port_no) <span class="keyword">for</span> l <span class="keyword">in</span></span><br><span class="line">                          copy.copy(get_link(self, <span class="literal">None</span>))]</span><br><span class="line">        self.all_links = <span class="built_in">dict</span>(</span><br><span class="line">            [[(l.src.dpid, l.src.port_no), [l.dst.dpid, l.dst.port_no]] <span class="keyword">for</span> l <span class="keyword">in</span> copy.copy(get_link(self, <span class="literal">None</span>))])</span><br><span class="line"></span><br><span class="line">        self.logger.info(<span class="string">&quot;Number of links &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(all_link_stats)))</span><br><span class="line"></span><br><span class="line">        all_link_repr = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        dhcp_links = copy.copy(get_link(self, self.dhcp_switch))</span><br><span class="line">        self.dhcp_link_stats = [(l.src.dpid, l.dst.dpid, l.src.port_no, l.dst.port_no) <span class="keyword">for</span> l <span class="keyword">in</span> dhcp_links]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;dhcp links:  &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.dhcp_link_stats))</span><br><span class="line">        <span class="keyword">for</span> s1, s2, p1, p2 <span class="keyword">in</span> all_link_stats:</span><br><span class="line">            <span class="comment"># 如果之前没有记录才新增邻居记录，并初始化</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (self.topo.find_adjacent(s1, s2)) <span class="keyword">and</span> <span class="keyword">not</span> (self.topo.find_adjacent(s2, s1)):</span><br><span class="line">                self.topo.set_adjacent(s1, s2, p1)</span><br><span class="line">                self.topo.set_adjacent(s2, s1, p2)</span><br><span class="line">            all_link_repr += <span class="string">&#x27;s&#123;&#125;p&#123;&#125;--s&#123;&#125;p&#123;&#125;\n&#x27;</span>.<span class="built_in">format</span>(s1, p1, s2, p2)</span><br><span class="line">        self.logger.info(<span class="string">&quot;All links:\n&quot;</span> + all_link_repr)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 获取边界交换机</span></span><br><span class="line">        self.edge_switch = []</span><br><span class="line">        intra_port = []</span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> all_link_stats:</span><br><span class="line">            intra_port.append((l[<span class="number">0</span>], l[<span class="number">2</span>]))</span><br><span class="line">            intra_port.append((l[<span class="number">1</span>], l[<span class="number">3</span>]))</span><br><span class="line">        <span class="keyword">for</span> s <span class="keyword">in</span> all_switches:</span><br><span class="line">            <span class="keyword">for</span> port <span class="keyword">in</span> s.ports:</span><br><span class="line">                <span class="keyword">if</span> (s.dp.<span class="built_in">id</span>, port.port_no) <span class="keyword">not</span> <span class="keyword">in</span> intra_port:</span><br><span class="line">                    self.edge_switch.append((s, port.port_no))</span><br><span class="line">                    self.logger.info(<span class="string">&quot;edge_switch:&#123;&#125;   port:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(s.dp.<span class="built_in">id</span>, port.port_no))</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 交换机初始化 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@set_ev_cls(<span class="params">ofp_event.EventOFPSwitchFeatures, CONFIG_DISPATCHER</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">switch_features_handler</span>(<span class="params">self, ev</span>):</span><br><span class="line">    datapath = ev.msg.datapath</span><br><span class="line">    ofproto = datapath.ofproto</span><br><span class="line">    parser = datapath.ofproto_parser</span><br><span class="line"></span><br><span class="line">    <span class="keyword">match</span> = parser.OFPMatch()</span><br><span class="line">    actions = [parser.OFPActionOutput(ofproto.OFPP_CONTROLLER,</span><br><span class="line">                                      ofproto.OFPCML_NO_BUFFER)]</span><br><span class="line">    self.add_flow(datapath, <span class="number">0</span>, <span class="keyword">match</span>, actions)</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="路由协议的RYU实现">路由协议的RYU实现</h2><p>对于我们网络中的路由协议的设计，我们需要首先实现寻路算法的封装，其次再是对与寻路后流表项的添加，而当其中可能未记录目的信息的时候会涉及报文的缓存以及arp报文的发送和处理，最终我们还要实现一个报文进入控制器的一个主要处理的功能函数，从而实现我们网络中划分子网的一个报文传输的路由协议。</p><details class="folding-tag" blue><summary> 寻路算法 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">def</span> <span class="title function_">Dijkstra</span>(<span class="params">self, src_sw, dst_sw, src_port, dst_port</span>):</span><br><span class="line">        <span class="comment"># print(&quot;now we begin to find the shortest paths from sw:&#123;&#125; port:&#123;&#125; to sw:&#123;&#125; port:&#123;&#125; &quot;.format(src_sw, src_port,</span></span><br><span class="line">        <span class="comment">#                                                                                             dst_sw,</span></span><br><span class="line">        <span class="comment">#                                                                                             dst_port))</span></span><br><span class="line">        bucket = CircleBucket(self.max_weight + <span class="number">1</span>)  <span class="comment"># 创建循环桶对象</span></span><br><span class="line">        bucket.updateBucket(<span class="number">0</span>, src_sw)  <span class="comment"># 将源点先加入桶</span></span><br><span class="line">        <span class="comment"># pre用于存储路径 并将所有交换机在路径的前置结点初始化为None</span></span><br><span class="line">        pre = &#123;&#125;</span><br><span class="line">        <span class="comment"># dis用于存储距离 并将所有交换机离源交换机距离初始化为9999999</span></span><br><span class="line">        dis = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> sw <span class="keyword">in</span> self.switches:</span><br><span class="line">            pre[sw] = <span class="literal">None</span></span><br><span class="line">            dis[sw] = <span class="number">9999999</span></span><br><span class="line">        dis[src_sw] = <span class="number">0</span>  <span class="comment"># 将源结点的距离初始化为0</span></span><br><span class="line">        flag = <span class="number">1</span>  <span class="comment"># flag 用于判断是否找到目的交换机 因为这是一个单源单宿问题</span></span><br><span class="line">        <span class="keyword">while</span> flag == <span class="number">1</span> <span class="keyword">and</span> <span class="keyword">not</span> bucket.checkBucketEmpty():  <span class="comment"># 若还没找到目的交换机或桶内结点数不为空则继续循环</span></span><br><span class="line">            sw = bucket.getFirst()  <span class="comment"># 取出现在离源交换机最近的交换机</span></span><br><span class="line">            <span class="keyword">if</span> sw == dst_sw:  <span class="comment"># 判断取出的交换机是不是目的交换机 如果是将flag置0并退出循环</span></span><br><span class="line">                flag = <span class="number">0</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">for</span> u <span class="keyword">in</span> self.switches:</span><br><span class="line">                <span class="keyword">if</span> u <span class="keyword">in</span> (self.get_adjacent(sw)).keys():</span><br><span class="line">                    <span class="comment"># print(self.get_Adjdict(sw)[u])</span></span><br><span class="line">                    <span class="comment"># 遍历取出交换机的所有邻接交换机 并更新循环桶内数据</span></span><br><span class="line">                    <span class="keyword">if</span> dis[sw] + self.get_adjacent(sw)[u][<span class="number">1</span>] &lt; dis[u]:  <span class="comment"># 判断邻接交换机离源交换机的距离有没有缩短</span></span><br><span class="line">                        dis[u] = dis[sw] + self.get_adjacent(sw)[u][<span class="number">1</span>]</span><br><span class="line">                        pre[u] = sw  <span class="comment"># 设置前置交换机</span></span><br><span class="line">                        bucket.updateBucket(dis[u], u)  <span class="comment"># 将桶数据数据更新</span></span><br><span class="line">        spath = [dst_sw]</span><br><span class="line">        sw = dst_sw</span><br><span class="line">        <span class="keyword">while</span> pre[sw] != <span class="literal">None</span>:  <span class="comment"># 通过pre找出最短路径</span></span><br><span class="line">            sw = pre[sw]</span><br><span class="line">            spath.append(sw)</span><br><span class="line">        spath.reverse()  <span class="comment"># 将路径反转为从到源交换机到目的交换机</span></span><br><span class="line">        <span class="comment"># print(&quot;Find done.The shortest path :&quot;, end=&quot; &quot;)</span></span><br><span class="line">        <span class="comment"># self.printPath(spath)  # 输出最短路径</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 现在我们已经通过Dijkstra算法找到最短路径了，接下来把该路径转化为控制器配置的格式</span></span><br><span class="line">        <span class="comment"># 交换机之间路径的配置格式如右 (src_sw,inport,outport)-&gt;.......-&gt;(dst_sw,inport,outport) 我们要把所有路经的交换机都记录为左边的格式</span></span><br><span class="line">        cpath = []  <span class="comment"># configure path</span></span><br><span class="line">        inport = src_port</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(spath) - <span class="number">1</span>):</span><br><span class="line">            s1 = spath[i]</span><br><span class="line">            s2 = spath[i + <span class="number">1</span>]</span><br><span class="line">            <span class="comment"># get s1-&gt;s2 outport</span></span><br><span class="line">            outport = self.get_adjacent(s1)[s2][<span class="number">0</span>]</span><br><span class="line">            cpath.append((s1, inport, outport))</span><br><span class="line">            inport = self.get_adjacent(s2)[s1][<span class="number">0</span>]</span><br><span class="line">        cpath.append((dst_sw, inport, dst_port))</span><br><span class="line">        <span class="comment"># return cpath can configure switch&#x27;s path  返回可以配置的路径</span></span><br><span class="line">        <span class="keyword">return</span> cpath</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">定义一个循环桶的类</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. 建一个指定容量的桶，存放(w[u],u)类型数据并能根据w[u]的大小放入相应的位置。  w[u]为结点u离源点的位置</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. 能对桶内的数据进行更新修改，并重新放置。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3. 在取出一个数据后，能自动将桶的头指针位置转移到桶内w[u]最小的桶。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CircleBucket</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, buckets_num</span>):</span><br><span class="line">        <span class="comment"># 桶中存放数据的个数</span></span><br><span class="line">        self.buckets_num = buckets_num</span><br><span class="line">        <span class="comment"># 创建桶数组 用于存放(w[u],[u])类型数据 因为距离源点同一距离的点不一定只有一个</span></span><br><span class="line">        self.buckets = [[] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.buckets_num)]</span><br><span class="line">        <span class="comment"># 桶的头指针位置 默认为0</span></span><br><span class="line">        self.first_bucket = <span class="number">0</span></span><br><span class="line">        <span class="comment"># 桶中所以数据个数</span></span><br><span class="line">        self.data_num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 更新桶的头指针位置</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">updateFirst</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 如果现在头指针位置的列表为空</span></span><br><span class="line">        <span class="keyword">if</span> self.checkListEmpty(self.first_bucket):</span><br><span class="line">            self.first_bucket = (self.first_bucket + <span class="number">1</span>) % self.buckets_num</span><br><span class="line">            <span class="keyword">while</span> self.checkListEmpty(self.first_bucket):</span><br><span class="line">                self.first_bucket = (self.first_bucket + <span class="number">1</span>) % self.buckets_num</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获得桶的头指针的数据</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getFirst</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 先进行头指针的更新</span></span><br><span class="line">        self.updateFirst()</span><br><span class="line">        <span class="comment"># 如果列表不为空才进行操作</span></span><br><span class="line">        self.data_num -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> self.buckets[self.first_bucket].pop()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 向桶内更新数据 将w位置的桶内加入u 即源结点到u的距离为w</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">updateBucket</span>(<span class="params">self, w, u</span>):</span><br><span class="line">        <span class="comment"># 向桶内加入数据 每个桶里面都是一个列表</span></span><br><span class="line">        self.buckets[w % self.buckets_num].append(u)</span><br><span class="line">        self.data_num += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">checkListEmpty</span>(<span class="params">self, w</span>):</span><br><span class="line">        <span class="comment"># 如果列表为空 返回true</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.buckets[w]:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 判断桶内是否有数据</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">checkBucketEmpty</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.data_num == <span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 添加流表 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_flow</span>(<span class="params">self, datapath, priority, <span class="keyword">match</span>, actions, buffer_id=<span class="literal">None</span>, idle_timeout=<span class="number">0</span>, hard_timeout=<span class="number">0</span></span>):</span><br><span class="line">    ofproto = datapath.ofproto</span><br><span class="line">    parser = datapath.ofproto_parser</span><br><span class="line"></span><br><span class="line">    inst = [parser.OFPInstructionActions(ofproto.OFPIT_APPLY_ACTIONS,</span><br><span class="line">                                         actions)]</span><br><span class="line">    <span class="keyword">if</span> buffer_id:</span><br><span class="line">        mod = parser.OFPFlowMod(datapath=datapath, buffer_id=buffer_id,</span><br><span class="line">                                priority=priority, <span class="keyword">match</span>=<span class="keyword">match</span>, idle_timeout=idle_timeout,</span><br><span class="line">                                hard_timeout=hard_timeout,</span><br><span class="line">                                instructions=inst)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        mod = parser.OFPFlowMod(datapath=datapath, priority=priority, idle_timeout=idle_timeout,</span><br><span class="line">                                hard_timeout=hard_timeout,</span><br><span class="line">                                <span class="keyword">match</span>=<span class="keyword">match</span>, instructions=inst)</span><br><span class="line">    datapath.send_msg(mod)</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 配置路径的流表 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">configure_path</span>(<span class="params">self, shortest_path, msg, origin_mac, dst_mac, dst_ip</span>):</span><br><span class="line">    <span class="comment"># configure shortest path to switches</span></span><br><span class="line">    recv_datapath = msg.datapath</span><br><span class="line">    <span class="keyword">for</span> switch, inport, outport <span class="keyword">in</span> shortest_path:</span><br><span class="line">        flow_list = []</span><br><span class="line">        datapath = self._find_dp(<span class="built_in">int</span>(switch))</span><br><span class="line">        actions = [datapath.ofproto_parser.OFPActionOutput(outport)]</span><br><span class="line">        <span class="comment"># 目的IP为外网报文</span></span><br><span class="line">        <span class="comment"># 第一个交换机</span></span><br><span class="line">        pkt = packet.Packet(msg.data)</span><br><span class="line">        pkt_ipv4 = pkt.get_protocol(ipv4.ipv4)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(switch) == recv_datapath.<span class="built_in">id</span>:</span><br><span class="line">            <span class="keyword">if</span> dst_ip == self.nat_ip:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                pkt_tcp = pkt.get_protocol(tcp.tcp)</span><br><span class="line">                pkt_udp = pkt.get_protocol(udp.udp)</span><br><span class="line">                <span class="keyword">if</span> pkt_tcp:</span><br><span class="line">                    tcp_match = datapath.ofproto_parser.OFPMatch(in_port=inport, ipv4_dst=dst_ip,</span><br><span class="line">                                                                 tcp_dst=pkt_tcp.dst_port,</span><br><span class="line">                                                                 eth_type=ether_types.ETH_TYPE_IP,</span><br><span class="line">                                                                 ip_proto=in_proto.IPPROTO_TCP)</span><br><span class="line">                    tcp_actions = [datapath.ofproto_parser.OFPActionSetField(</span><br><span class="line">                        ipv4_dst=self.tcp_in[pkt_tcp.dst_port][<span class="number">0</span>]), datapath.ofproto_parser.OFPActionSetField(</span><br><span class="line">                        tcp_dst=self.tcp_in[pkt_tcp.dst_port][<span class="number">1</span>]),</span><br><span class="line">                                      datapath.ofproto_parser.OFPActionSetField(eth_dst=dst_mac)] + actions</span><br><span class="line">                    dst_ip = self.tcp_in[pkt_tcp.dst_port][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">                    flow_list.append((tcp_actions, tcp_match))</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> pkt_udp:</span><br><span class="line">                    udp_match = datapath.ofproto_parser.OFPMatch(in_port=inport, ipv4_dst=dst_ip,</span><br><span class="line"></span><br><span class="line">                                                                 udp_dst=pkt_udp.dst_port,</span><br><span class="line">                                                                 eth_type=ether_types.ETH_TYPE_IP,</span><br><span class="line">                                                                 ip_proto=in_proto.IPPROTO_UDP)</span><br><span class="line"></span><br><span class="line">                    udp_actions = [datapath.ofproto_parser.OFPActionSetField(</span><br><span class="line">                        ipv4_dst=self.udp_in[pkt_udp.dst_port][<span class="number">0</span>]), datapath.ofproto_parser.OFPActionSetField(</span><br><span class="line">                        udp_dst=self.udp_in[pkt_udp.dst_port][<span class="number">1</span>]),</span><br><span class="line">                                      datapath.ofproto_parser.OFPActionSetField(eth_dst=dst_mac)] + actions</span><br><span class="line">                    dst_ip = self.udp_in[pkt_udp.dst_port][<span class="number">0</span>]</span><br><span class="line">                    <span class="comment"># print(self.udp_in)</span></span><br><span class="line">                    <span class="comment"># print(self.udp_out)</span></span><br><span class="line">                    flow_list.append((udp_actions, udp_match))</span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">int</span>(switch) == self.nat_switch_id <span class="keyword">and</span> <span class="keyword">not</span> self.ipINvpn(pkt_ipv4.dst, msg.<span class="keyword">match</span>[<span class="string">&#x27;in_port&#x27;</span>], datapath.<span class="built_in">id</span>):</span><br><span class="line"></span><br><span class="line">                pkt_tcp = pkt.get_protocol(tcp.tcp)</span><br><span class="line">                pkt_udp = pkt.get_protocol(udp.udp)</span><br><span class="line">                <span class="keyword">if</span> pkt_tcp:</span><br><span class="line">                    tcp_match = datapath.ofproto_parser.OFPMatch(in_port=inport, ipv4_src=pkt_ipv4.src,</span><br><span class="line">                                                                 tcp_src=pkt_tcp.src_port, ipv4_dst=dst_ip,</span><br><span class="line">                                                                 eth_type=ether_types.ETH_TYPE_IP,</span><br><span class="line">                                                                 ip_proto=in_proto.IPPROTO_TCP)</span><br><span class="line">                    tcp_actions = [datapath.ofproto_parser.OFPActionSetField(ipv4_src=self.nat_ip),</span><br><span class="line">                                   datapath.ofproto_parser.OFPActionSetField(</span><br><span class="line">                                       tcp_src=self.tcp_out[(pkt_ipv4.src, pkt_tcp.src_port)])] + actions</span><br><span class="line">                    flow_list.append((tcp_actions, tcp_match))</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> pkt_udp:</span><br><span class="line">                    udp_match = datapath.ofproto_parser.OFPMatch(in_port=inport, ipv4_src=pkt_ipv4.src,</span><br><span class="line">                                                                 udp_src=pkt_udp.src_port, ipv4_dst=dst_ip,</span><br><span class="line">                                                                 eth_type=ether_types.ETH_TYPE_IP,</span><br><span class="line">                                                                 ip_proto=in_proto.IPPROTO_UDP)</span><br><span class="line">                    udp_actions = [datapath.ofproto_parser.OFPActionSetField(ipv4_src=self.nat_ip),</span><br><span class="line">                                   datapath.ofproto_parser.OFPActionSetField(</span><br><span class="line">                                       udp_src=self.udp_out[(pkt_ipv4.src, pkt_udp.src_port)])] + actions</span><br><span class="line">                    flow_list.append((udp_actions, udp_match))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">                <span class="keyword">match</span> = datapath.ofproto_parser.OFPMatch(in_port=inport, eth_dst=origin_mac, ipv4_dst=dst_ip,</span><br><span class="line">                                                         eth_type=ether_types.ETH_TYPE_IP)</span><br><span class="line">                actions.insert(<span class="number">0</span>, datapath.ofproto_parser.OFPActionSetField(eth_dst=dst_mac))</span><br><span class="line">                flow_list.append((actions, <span class="keyword">match</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> self.ipInSubnet(dst_ip, self.net_ip) :</span><br><span class="line">            <span class="comment"># 如果是nat交换机 下发更改IP和端口的流表</span></span><br><span class="line">            <span class="keyword">if</span> switch == self.nat_switch_id:</span><br><span class="line">                pkt_tcp = pkt.get_protocol(tcp.tcp)</span><br><span class="line">                pkt_udp = pkt.get_protocol(udp.udp)</span><br><span class="line">                <span class="keyword">if</span> pkt_tcp:</span><br><span class="line">                    tcp_match = datapath.ofproto_parser.OFPMatch(in_port=inport, ipv4_src=pkt_ipv4.src,</span><br><span class="line">                                                                 tcp_src=pkt_tcp.src_port, ipv4_dst=dst_ip,</span><br><span class="line">                                                                 eth_type=ether_types.ETH_TYPE_IP,</span><br><span class="line">                                                                 ip_proto=in_proto.IPPROTO_TCP)</span><br><span class="line">                    tcp_actions = [datapath.ofproto_parser.OFPActionSetField(ipv4_src=self.nat_ip),</span><br><span class="line">                                   datapath.ofproto_parser.OFPActionSetField(</span><br><span class="line">                                       tcp_src=self.tcp_out[(pkt_ipv4.src, pkt_tcp.src_port)])] + actions</span><br><span class="line">                    flow_list.append((tcp_actions, tcp_match))</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> pkt_udp:</span><br><span class="line">                    udp_match = datapath.ofproto_parser.OFPMatch(in_port=inport, ipv4_src=pkt_ipv4.src,</span><br><span class="line">                                                                 udp_src=pkt_udp.src_port, ipv4_dst=dst_ip,</span><br><span class="line">                                                                 eth_type=ether_types.ETH_TYPE_IP,</span><br><span class="line">                                                                 ip_proto=in_proto.IPPROTO_UDP)</span><br><span class="line">                    udp_actions = [datapath.ofproto_parser.OFPActionSetField(ipv4_src=self.nat_ip),</span><br><span class="line">                                   datapath.ofproto_parser.OFPActionSetField(</span><br><span class="line">                                       udp_src=self.udp_out[(pkt_ipv4.src, pkt_udp.src_port)])] + actions</span><br><span class="line">                    flow_list.append((udp_actions, udp_match))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">match</span> = datapath.ofproto_parser.OFPMatch(in_port=inport, eth_dst=dst_mac,</span><br><span class="line">                                                         eth_type=ether_types.ETH_TYPE_IP)</span><br><span class="line">                flow_list.append((actions, <span class="keyword">match</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">match</span> = datapath.ofproto_parser.OFPMatch(in_port=inport, ipv4_dst=dst_ip,</span><br><span class="line">                                                     eth_type=ether_types.ETH_TYPE_IP)</span><br><span class="line">            flow_list.append((actions, <span class="keyword">match</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> datapath <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> actions, <span class="keyword">match</span> <span class="keyword">in</span> flow_list:</span><br><span class="line">            self.add_flow(datapath, <span class="number">1</span>, <span class="keyword">match</span>, actions, hard_timeout=self.hard_timeout)</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> ARP报文处理 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">arp_handler</span>(<span class="params">self, msg</span>):</span><br><span class="line"></span><br><span class="line">    datapath = msg.datapath</span><br><span class="line">    ofproto = datapath.ofproto</span><br><span class="line">    parser = datapath.ofproto_parser</span><br><span class="line">    in_port = msg.<span class="keyword">match</span>[<span class="string">&#x27;in_port&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    pkt = packet.Packet(msg.data)</span><br><span class="line"></span><br><span class="line">    eth = pkt.get_protocols(ethernet.ethernet)[<span class="number">0</span>]</span><br><span class="line">    arp_pkt = pkt.get_protocol(arp.arp)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> eth:</span><br><span class="line">        eth_dst = eth.dst</span><br><span class="line">        eth_src = eth.src</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> eth_dst == mac.BROADCAST_STR <span class="keyword">and</span> arp_pkt:</span><br><span class="line">        <span class="comment"># target ip</span></span><br><span class="line">        arp_dst_ip = arp_pkt.dst_ip</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> arp_pkt:</span><br><span class="line"></span><br><span class="line">        <span class="comment"># specify the operation that the sender is performing:1 for request,2 for reply</span></span><br><span class="line">        opcode = arp_pkt.opcode</span><br><span class="line"></span><br><span class="line">        <span class="comment"># src ip</span></span><br><span class="line">        arp_src_ip = arp_pkt.src_ip</span><br><span class="line">        <span class="comment"># dst ip</span></span><br><span class="line">        arp_dst_ip = arp_pkt.dst_ip</span><br><span class="line"></span><br><span class="line">        <span class="comment"># arp请求</span></span><br><span class="line">        <span class="keyword">if</span> opcode == arp.ARP_REQUEST:</span><br><span class="line">            <span class="keyword">if</span> arp_dst_ip == self.nat_ip <span class="keyword">or</span> self.ipINvpn(arp_dst_ip, in_port, datapath.<span class="built_in">id</span>):</span><br><span class="line">                <span class="comment"># send arp reply from in port</span></span><br><span class="line">                actions = [parser.OFPActionOutput(in_port)]</span><br><span class="line">                arp_reply = packet.Packet()</span><br><span class="line"></span><br><span class="line">                arp_reply.add_protocol(ethernet.ethernet(</span><br><span class="line">                    ethertype=eth.ethertype,</span><br><span class="line">                    dst=eth_src,</span><br><span class="line">                    src=self.switch_adds[(self.nat_switch_id, self.nat_switch_port)]))</span><br><span class="line"></span><br><span class="line">                <span class="comment"># add arp protocol</span></span><br><span class="line">                arp_reply.add_protocol(arp.arp(</span><br><span class="line">                    opcode=arp.ARP_REPLY,</span><br><span class="line">                    src_mac=self.switch_adds[(self.nat_switch_id, self.nat_switch_port)],</span><br><span class="line">                    src_ip=arp_dst_ip,</span><br><span class="line">                    dst_mac=eth_src,</span><br><span class="line">                    dst_ip=arp_src_ip))</span><br><span class="line"></span><br><span class="line">                <span class="comment"># serialize the packet to binary format 0101010101</span></span><br><span class="line">                arp_reply.serialize()</span><br><span class="line">                <span class="comment"># arp reply</span></span><br><span class="line">                out = parser.OFPPacketOut(</span><br><span class="line">                    datapath=datapath,</span><br><span class="line">                    buffer_id=ofproto.OFP_NO_BUFFER,</span><br><span class="line">                    in_port=ofproto.OFPP_CONTROLLER,</span><br><span class="line">                    actions=actions, data=arp_reply.data)</span><br><span class="line">                datapath.send_msg(out)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> arp_dst_ip <span class="keyword">in</span> self.arp_table:</span><br><span class="line">                <span class="comment"># send arp reply from in port</span></span><br><span class="line">                actions = [parser.OFPActionOutput(in_port)]</span><br><span class="line">                arp_reply = packet.Packet()</span><br><span class="line"></span><br><span class="line">                arp_reply.add_protocol(ethernet.ethernet(</span><br><span class="line">                    ethertype=eth.ethertype,</span><br><span class="line">                    dst=eth_src,</span><br><span class="line">                    src=self.arp_table[arp_dst_ip][<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">                arp_reply.add_protocol(arp.arp(</span><br><span class="line">                    opcode=arp.ARP_REPLY,</span><br><span class="line">                    src_mac=self.arp_table[arp_dst_ip][<span class="number">0</span>],</span><br><span class="line">                    src_ip=arp_dst_ip,</span><br><span class="line">                    dst_mac=eth_src,</span><br><span class="line">                    dst_ip=arp_src_ip))</span><br><span class="line">                <span class="comment"># serialize the packet to binary format 0101010101</span></span><br><span class="line">                arp_reply.serialize()</span><br><span class="line">                <span class="comment"># arp reply</span></span><br><span class="line">                out = parser.OFPPacketOut(</span><br><span class="line">                    datapath=datapath,</span><br><span class="line">                    buffer_id=ofproto.OFP_NO_BUFFER,</span><br><span class="line">                    in_port=ofproto.OFPP_CONTROLLER,</span><br><span class="line">                    actions=actions, data=arp_reply.data)</span><br><span class="line">                datapath.send_msg(out)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> in_port != self.nat_switch_port <span class="keyword">or</span> datapath.<span class="built_in">id</span> != self.nat_switch_id:</span><br><span class="line">                <span class="comment"># send arp reply from in port</span></span><br><span class="line">                actions = [parser.OFPActionOutput(in_port)]</span><br><span class="line">                arp_reply = packet.Packet()</span><br><span class="line"></span><br><span class="line">                arp_reply.add_protocol(ethernet.ethernet(</span><br><span class="line">                    ethertype=eth.ethertype,</span><br><span class="line">                    dst=eth_src,</span><br><span class="line">                    src=self.switch_adds[(datapath.<span class="built_in">id</span>, in_port)]))</span><br><span class="line"></span><br><span class="line">                <span class="comment"># add arp protocol</span></span><br><span class="line">                arp_reply.add_protocol(arp.arp(</span><br><span class="line">                    opcode=arp.ARP_REPLY,</span><br><span class="line">                    src_mac=self.switch_adds[(datapath.<span class="built_in">id</span>, in_port)],</span><br><span class="line">                    src_ip=arp_dst_ip,</span><br><span class="line">                    dst_mac=eth_src,</span><br><span class="line">                    dst_ip=arp_src_ip))</span><br><span class="line"></span><br><span class="line">                <span class="comment"># serialize the packet to binary format 0101010101</span></span><br><span class="line">                arp_reply.serialize()</span><br><span class="line">                <span class="comment"># arp reply</span></span><br><span class="line">                out = parser.OFPPacketOut(</span><br><span class="line">                    datapath=datapath,</span><br><span class="line">                    buffer_id=ofproto.OFP_NO_BUFFER,</span><br><span class="line">                    in_port=ofproto.OFPP_CONTROLLER,</span><br><span class="line">                    actions=actions, data=arp_reply.data)</span><br><span class="line">                datapath.send_msg(out)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 缓存报文 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存储并发送arp</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stor</span>(<span class="params">self, msg</span>):</span><br><span class="line">    <span class="comment"># msg = ev.msg</span></span><br><span class="line">    datapath = msg.datapath</span><br><span class="line">    port = msg.<span class="keyword">match</span>[<span class="string">&#x27;in_port&#x27;</span>]</span><br><span class="line">    pkt = packet.Packet(msg.data)</span><br><span class="line">    pkt_ethernet = pkt.get_protocol(ethernet.ethernet)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> pkt_ethernet:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    eth = pkt.get_protocols(ethernet.ethernet)[<span class="number">0</span>]</span><br><span class="line">    eth_dst = eth.dst</span><br><span class="line">    eth_src = eth.src</span><br><span class="line">    pkt_ipv4 = pkt.get_protocol(ipv4.ipv4)</span><br><span class="line">    <span class="comment"># src ip</span></span><br><span class="line">    src_ip = copy.copy(pkt_ipv4.src)</span><br><span class="line">    <span class="comment"># dst ip</span></span><br><span class="line">    dst_ip = copy.copy(pkt_ipv4.dst)</span><br><span class="line">    parser = datapath.ofproto_parser</span><br><span class="line">    <span class="comment"># 不在私网内</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> self.ipInSubnet(dst_ip, self.net_ip) <span class="keyword">and</span> <span class="keyword">not</span> (</span><br><span class="line">            self.ipInSubnet(pkt_ipv4.dst, <span class="string">&quot;/&quot;</span>.join((self.nat_ip, self.nat_mask)))):</span><br><span class="line">        <span class="comment"># 修改原ip</span></span><br><span class="line">        dst_ip = self.net_getaway_ip</span><br><span class="line">    <span class="comment"># 存储报文</span></span><br><span class="line">    self.buffer.append([src_ip, dst_ip, <span class="number">20</span>, msg])</span><br><span class="line">    self.logger.info(<span class="string">&quot;\n----------------Stor a Packet and Send ARP in edge_switch for &#123;&#125;----------------&quot;</span>.<span class="built_in">format</span>(dst_ip))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 发送arp</span></span><br><span class="line">    <span class="keyword">for</span> s, port_no <span class="keyword">in</span> self.edge_switch:</span><br><span class="line">        <span class="keyword">if</span> s.dp.<span class="built_in">id</span> == datapath.<span class="built_in">id</span> <span class="keyword">and</span> port == port_no:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        self.logger.info(<span class="string">&quot;Send ARP in edge_switch:&#123;&#125;  port:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(s.dp.<span class="built_in">id</span>, port_no))</span><br><span class="line"></span><br><span class="line">        actions = [parser.OFPActionOutput(port_no)]</span><br><span class="line">        arp_send = packet.Packet()</span><br><span class="line"></span><br><span class="line">        arp_send.add_protocol(ethernet.ethernet(</span><br><span class="line">            ethertype=<span class="number">2054</span>,</span><br><span class="line">            dst=<span class="string">&quot;ff:ff:ff:ff:ff:ff&quot;</span>,</span><br><span class="line">            src=eth_src <span class="keyword">if</span> s.dp.<span class="built_in">id</span>!=self.nat_switch_id <span class="keyword">else</span> self.switch_adds[(self.nat_switch_id, self.nat_switch_port)]))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># add arp protocol</span></span><br><span class="line">        arp_send.add_protocol(arp.arp(</span><br><span class="line">            opcode=arp.ARP_REQUEST,</span><br><span class="line">            src_mac=eth_src <span class="keyword">if</span> s.dp.<span class="built_in">id</span>!=self.nat_switch_id <span class="keyword">else</span> self.switch_adds[(self.nat_switch_id, self.nat_switch_port)],</span><br><span class="line">            src_ip=src_ip,</span><br><span class="line">            dst_mac=<span class="string">&quot;00:00:00:00:00:00&quot;</span>,</span><br><span class="line">            dst_ip=dst_ip))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># serialize the packet to binary format 0101010101</span></span><br><span class="line">        arp_send.serialize()</span><br><span class="line">        <span class="comment"># arp reply</span></span><br><span class="line">        out = parser.OFPPacketOut(</span><br><span class="line">            datapath=s.dp,</span><br><span class="line">            buffer_id=s.dp.ofproto.OFP_NO_BUFFER,</span><br><span class="line">            in_port=s.dp.ofproto.OFPP_CONTROLLER,</span><br><span class="line">            actions=actions, data=arp_send.data)</span><br><span class="line">        <span class="comment"># print(dst_ip)</span></span><br><span class="line">        s.dp.send_msg(out)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 有ARP回复后查询缓存数据并发送 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查寻发送</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_send</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(self.buffer) - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        self.logger.info(</span><br><span class="line">            <span class="string">&quot;Find a packet in buffer can be sent from &#123;&#125; to &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.buffer[i][<span class="number">0</span>], self.buffer[i][<span class="number">1</span>]))</span><br><span class="line">        curr_switch = self.buffer[i][<span class="number">3</span>].datapath.<span class="built_in">id</span></span><br><span class="line">        in_port = self.buffer[i][<span class="number">3</span>].<span class="keyword">match</span>[<span class="string">&#x27;in_port&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> self.buffer[i][<span class="number">0</span>] <span class="keyword">in</span> self.arp_table <span class="keyword">and</span> self.buffer[i][<span class="number">1</span>] <span class="keyword">in</span> self.arp_table:</span><br><span class="line">            <span class="keyword">if</span> self.buffer[i][<span class="number">1</span>] == self.net_getaway_ip:</span><br><span class="line">                pkt = packet.Packet(self.buffer[i][<span class="number">3</span>].data)</span><br><span class="line">                eth = pkt.get_protocols(ethernet.ethernet)[<span class="number">0</span>]</span><br><span class="line">                parser = self.nat_switch.dp.ofproto_parser</span><br><span class="line">                pkt_ipv4 = pkt.get_protocol(ipv4.ipv4)</span><br><span class="line">                pkt_icmp = pkt.get_protocol(icmp.icmp)</span><br><span class="line">                pkt_tcp = pkt.get_protocol(tcp.tcp)</span><br><span class="line">                pkt_udp = pkt.get_protocol(udp.udp)</span><br><span class="line">                src_ip = copy.copy(pkt_ipv4.src)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 修改mac</span></span><br><span class="line">                eth.dst = self.arp_table[self.net_getaway_ip][<span class="number">0</span>]</span><br><span class="line">                <span class="comment"># 修改原ip</span></span><br><span class="line">                pkt_ipv4.src = self.nat_ip</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> pkt_icmp:</span><br><span class="line">                    <span class="comment"># 修改id</span></span><br><span class="line">                    pkt_icmp.data.<span class="built_in">id</span> = self.icmp_out[(src_ip, pkt_icmp.data.<span class="built_in">id</span>)]</span><br><span class="line">                    self.ICMPTTLinit(pkt_icmp.data.<span class="built_in">id</span>)</span><br><span class="line">                    pkt_icmp.csum = <span class="number">0</span></span><br><span class="line">                <span class="keyword">elif</span> pkt_tcp:</span><br><span class="line">                    <span class="comment"># 修改id</span></span><br><span class="line">                    pkt_tcp.src_port = self.tcp_out[(src_ip, pkt_tcp.src_port)]</span><br><span class="line">                    pkt_tcp.csum = <span class="number">0</span></span><br><span class="line">                <span class="keyword">elif</span> pkt_udp:</span><br><span class="line">                    <span class="comment"># 修改id</span></span><br><span class="line">                    pkt_udp.src_port = self.udp_out[(src_ip, pkt_udp.src_port)]</span><br><span class="line">                    pkt_udp.csum = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">                pkt.serialize()</span><br><span class="line"></span><br><span class="line">                actions = [parser.OFPActionOutput(self.nat_switch_port)]</span><br><span class="line">                self.send_out(self.nat_switch, actions, pkt.data)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> in_port == self.nat_switch_port <span class="keyword">and</span> curr_switch == self.nat_switch_id:</span><br><span class="line">                pkt = packet.Packet(self.buffer[i][<span class="number">3</span>].data)</span><br><span class="line">                eth = pkt.get_protocols(ethernet.ethernet)[<span class="number">0</span>]</span><br><span class="line">                parser = self.nat_switch.dp.ofproto_parser</span><br><span class="line">                pkt_ipv4 = pkt.get_protocol(ipv4.ipv4)</span><br><span class="line">                <span class="built_in">print</span>(pkt_ipv4.dst)</span><br><span class="line">                dst_mac, dst_switch_id, final_port = self.arp_table[pkt_ipv4.dst]</span><br><span class="line">                <span class="comment"># print(&quot;find switch &#123;&#125; port &#123;&#125; &quot;.format(dst_switch_id, final_port))</span></span><br><span class="line">                eth.dst = dst_mac</span><br><span class="line">                <span class="built_in">print</span>(eth.dst)</span><br><span class="line">                pkt.serialize()</span><br><span class="line">                actions = [parser.OFPActionOutput(final_port)]</span><br><span class="line">                dst_switch = copy.copy(get_switch(self, dst_switch_id))[<span class="number">0</span>]</span><br><span class="line">                out = parser.OFPPacketOut(</span><br><span class="line">                    datapath=dst_switch.dp,</span><br><span class="line">                    buffer_id=dst_switch.dp.ofproto.OFP_NO_BUFFER,</span><br><span class="line">                    in_port=dst_switch.dp.ofproto.OFPP_CONTROLLER,</span><br><span class="line">                    actions=actions, data=pkt.data)</span><br><span class="line">                dst_switch.dp.send_msg(out)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.default_handler(curr_switch, in_port, self.buffer[i][<span class="number">0</span>], self.buffer[i][<span class="number">1</span>], self.buffer[i][<span class="number">3</span>])</span><br><span class="line">            self.buffer.pop(i)</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 内网报文默认处理 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">default_handler</span>(<span class="params">self, curr_switch, in_port, src_ip, dst_ip, msg</span>):</span><br><span class="line">    datapath = msg.datapath</span><br><span class="line">    ofproto = datapath.ofproto</span><br><span class="line">    parser = datapath.ofproto_parser</span><br><span class="line">    <span class="comment"># 寻路并转发，要修改mac</span></span><br><span class="line">    dst_mac, dst_switch, final_port = self.arp_table[dst_ip]</span><br><span class="line">    pkt = packet.Packet(msg.data)</span><br><span class="line">    pkt_ipv4 = pkt.get_protocol(ipv4.ipv4)</span><br><span class="line">    eth = pkt.get_protocols(ethernet.ethernet)[<span class="number">0</span>]</span><br><span class="line">    origin_mac = eth.dst</span><br><span class="line">    eth.dst = dst_mac</span><br><span class="line">    <span class="keyword">if</span> origin_mac == eth.dst <span class="keyword">and</span> (curr_switch,in_port) <span class="keyword">not</span> <span class="keyword">in</span> self.edge_switch:</span><br><span class="line">        actions = [parser.OFPActionOutput(OFPP_IN_PORT)]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        pkt.serialize()</span><br><span class="line">        msg.data = pkt.data</span><br><span class="line">        <span class="comment"># 找到源和目的主机的mac及连接的虚拟机</span></span><br><span class="line">        self.logger.info(<span class="string">&quot;Received a Packet from intranet &#123;&#125; to intranet &#123;&#125; change MAC from &#123;&#125; to &quot;</span></span><br><span class="line">                         <span class="string">&quot;&#123;&#125; \n&quot;</span>.<span class="built_in">format</span>(pkt_ipv4.src,pkt_ipv4.dst,origin_mac,dst_mac))</span><br><span class="line"></span><br><span class="line">        shortest_path = self.topo.Dijkstra(</span><br><span class="line">            curr_switch,</span><br><span class="line">            dst_switch,</span><br><span class="line">            in_port,</span><br><span class="line">            final_port)</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(shortest_path) &gt; <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        path_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># (s1,inport,outport)-&gt;(s2,inport,outport)-&gt;...-&gt;(dest_switch,inport,outport)</span></span><br><span class="line">        <span class="keyword">for</span> s, ip, op <span class="keyword">in</span> shortest_path:</span><br><span class="line">            path_str = path_str + <span class="string">&quot;--&#123;&#125;-&#123;&#125;-&#123;&#125;--&quot;</span>.<span class="built_in">format</span>(ip, s, op)</span><br><span class="line">        self.logger.info(</span><br><span class="line">            <span class="string">&quot;Configure the shortset path from &#123;&#125; to &#123;&#125; —— &#123;&#125;\n&quot;</span>.<span class="built_in">format</span>(src_ip, dst_ip, path_str))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># self.logger.info(&quot;Now configuring switches of interest&quot;)</span></span><br><span class="line">        self.configure_path(shortest_path, msg, origin_mac, dst_mac, dst_ip)</span><br><span class="line">        <span class="comment"># self.logger.info(&quot;Configure done&quot;)</span></span><br><span class="line">        <span class="comment"># sleep(1)</span></span><br><span class="line">        out_port = shortest_path[-<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">        in_port = shortest_path[-<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">        actions = [parser.OFPActionOutput(out_port)]</span><br><span class="line">        out_switch = get_switch(self, shortest_path[-<span class="number">1</span>][<span class="number">0</span>])[<span class="number">0</span>]</span><br><span class="line">        datapath = out_switch.dp</span><br><span class="line">        parser = datapath.ofproto_parser</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> msg.buffer_id == ofproto.OFP_NO_BUFFER:</span><br><span class="line">        data = msg.data</span><br><span class="line">    <span class="comment"># send the packet out to avoid packet loss</span></span><br><span class="line">    out = parser.OFPPacketOut(</span><br><span class="line">        datapath=datapath,</span><br><span class="line">        buffer_id=msg.buffer_id,</span><br><span class="line">        actions=actions,</span><br><span class="line">        in_port=in_port,</span><br><span class="line">        data=data</span><br><span class="line">    )</span><br><span class="line">    datapath.send_msg(out)</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 报文直接发往交换机端口 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@staticmethod</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_out</span>(<span class="params">switch, actions, data</span>):</span><br><span class="line">    parser = switch.dp.ofproto_parser</span><br><span class="line">    out = parser.OFPPacketOut(</span><br><span class="line">        datapath=switch.dp,</span><br><span class="line">        buffer_id=switch.dp.ofproto.OFP_NO_BUFFER,</span><br><span class="line">        in_port=switch.dp.ofproto.OFPP_CONTROLLER,</span><br><span class="line">        actions=actions, data=data)</span><br><span class="line">    switch.dp.send_msg(out)</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 报文进入控制器后的处理 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@set_ev_cls(<span class="params">ofp_event.EventOFPPacketIn, MAIN_DISPATCHER</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">packet_in_handler</span>(<span class="params">self, event</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># msg is an object which desicribes the corresponding OpenFlow message</span></span><br><span class="line">    msg = event.msg</span><br><span class="line">    datapath = msg.datapath</span><br><span class="line">    <span class="comment"># object for the negotiated Openflow version</span></span><br><span class="line">    parser = datapath.ofproto_parser</span><br><span class="line">    <span class="comment"># through which port the packet comes in</span></span><br><span class="line">    in_port = msg.<span class="keyword">match</span>[<span class="string">&#x27;in_port&#x27;</span>]</span><br><span class="line">    <span class="comment"># self.logger.info(&quot;From datapath &#123;&#125; port &#123;&#125; come in a packet&quot;.format(datapath.id,in_port))</span></span><br><span class="line">    <span class="comment"># get src_mac and dest mac</span></span><br><span class="line">    pkt = packet.Packet(msg.data)</span><br><span class="line">    eth = pkt.get_protocols(ethernet.ethernet)[<span class="number">0</span>]</span><br><span class="line">    dpid = datapath.<span class="built_in">id</span></span><br><span class="line">    <span class="comment"># drop lldp</span></span><br><span class="line">    <span class="keyword">if</span> eth.ethertype == ether_types.ETH_TYPE_LLDP:</span><br><span class="line">        <span class="comment"># self.logger.info(&quot;LLDP&quot;)</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="comment"># get source and destination mac address</span></span><br><span class="line">    dst_mac = eth.dst</span><br><span class="line">    src_mac = eth.src</span><br><span class="line">    <span class="comment"># check if this is an arp packet</span></span><br><span class="line">    arp_pkt = pkt.get_protocol(arp.arp)</span><br><span class="line">    self.mac_to_port.setdefault(dpid, &#123;&#125;)</span><br><span class="line">    self.mac_to_port[dpid][src_mac] = in_port</span><br><span class="line">    self.TTLdes()</span><br><span class="line">    pkt_ipv4 = pkt.get_protocol(ipv4.ipv4)</span><br><span class="line">    <span class="keyword">if</span> pkt_ipv4:</span><br><span class="line">        src_ip = pkt_ipv4.src</span><br><span class="line">        dst_ip = pkt_ipv4.dst</span><br><span class="line">    <span class="keyword">if</span> pkt.get_protocol(ipv6.ipv6):</span><br><span class="line">        <span class="keyword">match</span> = parser.OFPMatch(eth_type=eth.ethertype)</span><br><span class="line">        actions = []</span><br><span class="line">        self.add_flow(datapath, <span class="number">1</span>, <span class="keyword">match</span>, actions)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>                                                                                                in_port))</span><br><span class="line"></span><br><span class="line">    pkt_dhcp = pkt.get_protocol(dhcp.dhcp)</span><br><span class="line">    <span class="comment"># 判断是否为dhcp报文</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> pkt_dhcp:</span><br><span class="line">        <span class="keyword">if</span> dpid != self.dhcp_switch:</span><br><span class="line">            self.dhcp_relay_handler(msg)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="comment"># 判断是否为arp报文</span></span><br><span class="line">    <span class="keyword">if</span> arp_pkt:</span><br><span class="line">        <span class="comment"># 记录ip mac 设备号 端口号</span></span><br><span class="line">        <span class="keyword">if</span> arp_pkt.src_ip <span class="keyword">not</span> <span class="keyword">in</span> self.arp_table <span class="keyword">or</span> self.arp_table[arp_pkt.src_ip] != (</span><br><span class="line">                src_mac, dpid, in_port) <span class="keyword">and</span> src_mac != self.switch_adds[(self.nat_switch_id, self.nat_switch_port)]:</span><br><span class="line">            self.arp_table[arp_pkt.src_ip] = (src_mac, dpid, in_port)</span><br><span class="line">            <span class="comment"># 查询发送</span></span><br><span class="line">            self.find_send()</span><br><span class="line">        self.arp_handler(msg)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># if pkt_ipv4.src not in self.arp_table</span></span><br><span class="line">        <span class="comment"># 发送到外网：目的为外网，且源不是</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.ipInSubnet(dst_ip, self.net_ip) <span class="keyword">and</span> self.ipInSubnet(src_ip, self.net_ip):</span><br><span class="line">            self.NAT_out(msg)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="comment"># 外网发送到内网：目的为外网，且源也是外网</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (self.ipInSubnet(src_ip, self.net_ip)):</span><br><span class="line">            <span class="keyword">if</span> dst_ip == self.nat_ip:</span><br><span class="line">                self.NAT_in(msg)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="comment"># 查询到目的IP在ARP表中</span></span><br><span class="line">        <span class="keyword">if</span> self.find(dst_ip):</span><br><span class="line">            self.default_handler(dpid, in_port, src_ip, dst_ip, msg)</span><br><span class="line">        <span class="comment"># 未查询到结果</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.stor(msg)</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="流量检测的RYU实现">流量检测的RYU实现</h2><p>实现网络中的流量监控，需要周期的让控制器请求交换机的端口信息，并做出计算和更新，因此需要RYU实现的函数有如下。</p><details class="folding-tag" blue><summary> 周期请求端口信息 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">_monitor</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> s <span class="keyword">in</span> self.all_switches:</span><br><span class="line">            self._request_stats(s.dp)</span><br><span class="line">        hub.sleep(self.monitor_time)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_request_stats</span>(<span class="params">self, datapath</span>):</span><br><span class="line">    self.logger.debug(<span class="string">&#x27;send stats request: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(datapath.<span class="built_in">id</span>))</span><br><span class="line">    ofproto = datapath.ofproto</span><br><span class="line">    parser = datapath.ofproto_parser</span><br><span class="line"></span><br><span class="line">    req = parser.OFPPortStatsRequest(datapath, <span class="number">0</span>, ofproto.OFPP_ANY)</span><br><span class="line">    datapath.send_msg(req)</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 返回端口信息处理 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@set_ev_cls(<span class="params">ofp_event.EventOFPPortStatsReply, MAIN_DISPATCHER</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_port_stats_reply_handler</span>(<span class="params">self, ev</span>):</span><br><span class="line">    body = ev.msg.body</span><br><span class="line">    <span class="comment"># 更新流量差和全流量</span></span><br><span class="line">    <span class="comment"># print(self.all_links)</span></span><br><span class="line">    <span class="keyword">for</span> stat <span class="keyword">in</span> <span class="built_in">sorted</span>(body, key=attrgetter(<span class="string">&#x27;port_no&#x27;</span>)):</span><br><span class="line">        <span class="keyword">if</span> (ev.msg.datapath.<span class="built_in">id</span>, stat.port_no) <span class="keyword">in</span> self.all_links:</span><br><span class="line">            <span class="comment"># 计算流量差</span></span><br><span class="line">            traffic_sub = stat.rx_bytes - self.topo.get_adjacent(ev.msg.datapath.<span class="built_in">id</span>)[</span><br><span class="line">                self.all_links[(ev.msg.datapath.<span class="built_in">id</span>, stat.port_no)][<span class="number">0</span>]][<span class="number">3</span>]</span><br><span class="line">            self.topo.update_adjacent(ev.msg.datapath.<span class="built_in">id</span>, self.all_links[(ev.msg.datapath.<span class="built_in">id</span>, stat.port_no)][<span class="number">0</span>],</span><br><span class="line">                                      cycle_traffic=traffic_sub, all_traffic=stat.rx_bytes)</span><br><span class="line">    <span class="comment"># 更新完后更新权重</span></span><br><span class="line">    self.topo.update_weight()</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 链路权重更新 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">update_adjacent</span>(<span class="params">self, s1, s2, port=<span class="literal">None</span>, weight=<span class="literal">None</span>, cycle_traffic=<span class="literal">None</span>, all_traffic=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> port:</span><br><span class="line">        self.adjacent[s1][s2][<span class="number">0</span>] = port</span><br><span class="line">    <span class="keyword">if</span> weight:</span><br><span class="line">        self.adjacent[s1][s2][<span class="number">1</span>] = weight</span><br><span class="line">    <span class="keyword">if</span> cycle_traffic:</span><br><span class="line">        self.adjacent[s1][s2][<span class="number">2</span>] = cycle_traffic</span><br><span class="line">    <span class="keyword">if</span> all_traffic:</span><br><span class="line">        self.adjacent[s1][s2][<span class="number">3</span>] = all_traffic</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_weight</span>(<span class="params">self</span>):</span><br><span class="line">    all_traffic = [<span class="built_in">list</span>(edge.values()) <span class="keyword">for</span> edge <span class="keyword">in</span> self.adjacent.values()]</span><br><span class="line">    max_cycle_traffic = <span class="built_in">max</span>([<span class="built_in">max</span>(i, key=<span class="keyword">lambda</span> item: item[<span class="number">2</span>])[<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> all_traffic])</span><br><span class="line">    min_cycle_traffic = <span class="built_in">min</span>([<span class="built_in">min</span>(i, key=<span class="keyword">lambda</span> item: item[<span class="number">2</span>])[<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> all_traffic])</span><br><span class="line">    self.update_times += <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> s1, data <span class="keyword">in</span> self.adjacent.items():</span><br><span class="line">        <span class="keyword">for</span> s2, [_, _, cycle_traffic, _] <span class="keyword">in</span> data.items():</span><br><span class="line">            <span class="comment"># 计算权重并更新</span></span><br><span class="line">            weight = math.ceil(((cycle_traffic - min_cycle_traffic) * <span class="number">100</span> / (</span><br><span class="line">                    max_cycle_traffic - min_cycle_traffic) <span class="keyword">if</span> max_cycle_traffic != min_cycle_traffic <span class="keyword">and</span> cycle_traffic != min_cycle_traffic <span class="keyword">else</span> <span class="number">1</span>) )</span><br><span class="line">            self.update_adjacent(s1, s2, weight=weight)</span><br><span class="line">    <span class="keyword">if</span> self.update_times % <span class="built_in">len</span>(self.switches) ==<span class="number">0</span>:</span><br><span class="line">        self.print_weight()</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><hr><h1 id="效果展示">效果展示</h1><h2 id="拓扑展示">拓扑展示</h2><p>从图中可以得到h1至h4有s1-s4-s2以及s1-s5-s2两条路线。</p><p><img src="https://image.asa-world.cn/pic/image-20230206161904294.png" alt="拓扑图"></p><h2 id="寻路展示">寻路展示</h2><p>在h1 ping h4之前查看流表项如下可以看出流表中没有寻路的表。</p><p><img src="https://image.asa-world.cn/pic/image-20230206162034245.png" alt="寻路前流表"></p><p>h1 ping h4显示两点间连通性正常：</p><p><img src="https://image.asa-world.cn/pic/image-20230206162111172.png" alt="ping操作"></p><p>此时再查看流表项可以得到s1与s2间已经产生对应的转发表，以及可以将对应IP地址的mac地址修改正确的流表项。</p><p><img src="https://image.asa-world.cn/pic/image-20230206162140472.png" alt="查看流表"></p><p>同时可以看到s4已经产生两条转发流表，证明寻路选择了s1-s4-s2这条路径。</p><p><img src="https://image.asa-world.cn/pic/image-20230206162200598.png" alt="查看流表"></p><h2 id="抓包分析">抓包分析</h2><p>通过对s1的1端口与s2的1端口进行抓包分析可知：其均向对应的网关发送arp请求以得到相应的mac地址。</p><p><img src="https://image.asa-world.cn/pic/image-20230206162303460.png" alt="抓包分析"></p><p>同时可知，icmp报文在经过s1前后其mac地址也得到了相应的更改，此处的修改即将s1处经过的该icmp报文mac地址修改为s4处，使其按照预定的寻路路径s1-s4-s2到达目的地h4。</p><p><img src="https://image.asa-world.cn/pic/image-20230206162321977.png" alt="抓包分析"></p><p>内网的连通性得以验证，此时pingall可以发现内网主机是可以相互ping通的。</p><p><img src="https://image.asa-world.cn/pic/image-20230206162350760.png" alt="pingall操作"></p>]]></content>
      
      
      <categories>
          
          <category> 项目报告 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SDN </tag>
            
            <tag> 项目开发 </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>探索火星的奥秘 ——&quot;探索号&quot;火星车发布会</title>
      <link href="/f5eadc1/"/>
      <url>/f5eadc1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>欢迎大家来到&quot;探索号&quot;火星车发布会的现场！</p></blockquote><p>美国有NASA，我们有MARSA，这是它的英文名字Mars Assistance，火星探索辅助设备。</p><hr><h1 id="火星情况">火星情况</h1><p>要想去到遥远的火星去执行任务，我们当然要先弄清楚火星上面的基本情况是什么样的。通过查找资料，尤其是《火星救援》这部电影给了我们启发很多。</p><p>我们了解到火星，火星表面的平均大气压强不足地球上的1%，所以它时不时就会来一场席卷整颗行星大风暴。因此风化严重，火星上遍布撞击坑、峡谷、沙丘和砾石。另外，2014年科学家发现在火星内部存在庞大的水资源，酷似巨型“地下水库”。俗话说水是生命之源，我们有理由怀疑火星上会不会真的有生命，或者说是外星人呢。</p><p><img src="https://image.asa-world.cn/pic/dN7PLKx9jo_small.jpg" alt="日落下的火星山脉"></p><p>有了这个怀疑，我们想要做的就是火星生命的探测。</p><hr><h1 id="探索号特点与功能">探索号特点与功能</h1><p>&quot;探索号&quot;火星车，它有以下几个特点和功能。</p><h2 id="外观">外观</h2><p>首先外观上，大家可以看出我们使用了履带的设计。刚才我们讲到火星多风沙，那么履带的设计大大增强了火星车的稳定性；在坑洼地段履带比轮胎的脱困能力也会好很多；因为履带和地面的接触面积更大，所以对地面压强就很小，在沙地泥地里更不容易陷进去。</p><p><img src="https://image.asa-world.cn/pic/image-20230205141406914.png" alt="履带式设计"></p><h2 id="超声波避障功能">超声波避障功能</h2><p>另外，为了应对比较恶劣的地质环境，我们还加入了超声波避障功能。</p><p>由于环境复杂多样，我们设计了两种避障策略。</p><ul><li>面对比较矮小的障碍物，火星车会利用自身的机械臂将自身撑起来而实现翻越障碍物；</li><li>如果障碍物比较高大，火星车就会骂骂咧咧的走开，重新规划路线。</li></ul><div class="video"><video controls preload><source src='https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/video/%E9%81%BF%E9%9A%9C%E5%8A%9F%E8%83%BD_x264.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><h2 id="多级变速功能">多级变速功能</h2><p>为了使火星车前进的更加稳定，我们使用了姿态传感器，通过对欧拉角的判断实现了上坡加速，下坡减速。</p><div class="video"><video controls preload><source src='https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/video/%E6%99%BA%E8%83%BD%E5%BE%AA%E8%BF%B9_batch.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><h2 id="智能检测功能">智能检测功能</h2><p>我们关注多学科交叉融合，坚持产学研一体化，刚才我们是火星车的任务是探测生命，于是我们调整我们之前做的大创项目，使用YOLO目标检测算法，通过火星车上的摄像头将视频流传回上位机进行检测。我们的算法可检测类别八十余种。</p><h2 id="红外寻迹功能">红外寻迹功能</h2><p>难道外星人真的好找吗，不一定。我们火星车还实现了寻迹功能，可以外星生命的痕迹主动探索。</p><div class="video"><video controls preload><source src='https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/video/%E6%99%BA%E8%83%BD%E5%BE%AA%E8%BF%B9_batch.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><hr><h1 id="实现原理">实现原理</h1><h2 id="超声波避障">超声波避障</h2><p>障碍物类型的判断方法：当超声波检测障碍物距离小于阈值时，机械臂触地将火星车支撑起来，超声波持续检测，如果还能检测到障碍物则说明是高大障碍物，否则判断为矮小障碍物。</p><p>对于低矮障碍物，因为机械臂可使火星车直接翻越，因此火星车将慢速前进并收回机械臂；对于高大障碍物，火星车将后退并右转重新寻路。</p><p><img src="https://image.asa-world.cn/pic/image-20230205140137319.png" alt="避障流程图"></p><p>技术细节：通过Get_distance函数获取超声波传感器检测前方障碍物的距离值，通过不断调试，我们将阈值调整到15。Angle[0]、Angle[1]、Angle[3]分别对应0、1、3号舵机负责调整机械臂姿态。</p><p>通过MOTOR_GO_FORWARD、MOTOR_GO_STOP、MOTOR_GO_RIGHT函数直接控制火星车的行进方向。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">shangpo</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">          MOTOR_GO_STOP;</span><br><span class="line">        <span class="comment">//停车</span></span><br><span class="line">        Angle[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">        Angle[<span class="number">1</span>]=<span class="number">70</span>;</span><br><span class="line">        Angle[<span class="number">3</span>]=<span class="number">0</span>;</span><br><span class="line">        Delay_ms(<span class="number">500</span>);</span><br><span class="line">        <span class="type">float</span> distance = Get_distance();    <span class="comment">//获取超声波传感器距离值</span></span><br><span class="line">        <span class="keyword">if</span>((<span class="number">15</span>&lt;distance)||(distance&lt;=<span class="number">0</span>))             <span class="comment">//判断超声波传感器距离值大于15小于等于0</span></span><br><span class="line">        &#123;</span><br><span class="line">            MOTOR_GO_FORWARD;</span><br><span class="line">            Delay_ms(<span class="number">300</span>);</span><br><span class="line">            MOTOR_GO_STOP;</span><br><span class="line">            Angle[<span class="number">0</span>]=<span class="number">180</span>;</span><br><span class="line">            Angle[<span class="number">3</span>]=<span class="number">0</span>;</span><br><span class="line">            Delay_ms(<span class="number">500</span>);</span><br><span class="line">            Angle[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">            Delay_ms(<span class="number">50</span>);</span><br><span class="line">            MOTOR_GO_FORWARD;</span><br><span class="line">            Delay_ms(<span class="number">500</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">            <span class="comment">//forward(adjust,500);</span></span><br><span class="line">            Delay_ms(<span class="number">500</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          Angle[<span class="number">0</span>]=<span class="number">180</span>;</span><br><span class="line">          Angle[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">          Angle[<span class="number">3</span>]=<span class="number">0</span>;</span><br><span class="line">          Delay_ms(<span class="number">500</span>);</span><br><span class="line">          MOTOR_GO_BACK;</span><br><span class="line">          Delay_ms(<span class="number">500</span>);</span><br><span class="line">          MOTOR_GO_RIGHT;</span><br><span class="line">          Delay_ms(<span class="number">250</span>);</span><br><span class="line">          MOTOR_GO_STOP;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多级变速">多级变速</h2><p>变速策略为当火星车通过姿态传感器判断处于上坡状态或下坡状态。当处于上坡状态时，火星车加速前进，当处于下坡状态时，火星车减速前进。</p><p><img src="https://image.asa-world.cn/pic/image-20230205140424140.png" alt="变速原理"></p><p>本功能的解码模块如图所示，其主要部分参考姿态传感器官方文档的帧设定。当传入数据帧头为0x53时，传递的是姿态信息。通过官方给的变换公式，我们便可以得到三个角度的姿态信息和一个温度信息。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> Communication <span class="title function_">Decode3</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(Communication_Decode_flag3)&#123;</span><br><span class="line">Communication_Decode_flag3=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(buffer3[<span class="number">0</span>]==<span class="number">0x53</span>)&#123;</span><br><span class="line">ro11x=(buffer:<span class="number">3</span>[<span class="number">2</span>]&lt;&lt;<span class="number">8</span>)|buffer3[<span class="number">1</span>])/<span class="number">32768.0</span>*<span class="number">180</span>;</span><br><span class="line">pitchy=(buffer3[<span class="number">4</span>]&lt;<span class="number">8</span>)|buffer:<span class="number">3</span>[<span class="number">3</span>])/<span class="number">32768.0</span>*<span class="number">180</span>;</span><br><span class="line">yawz=(buffer3[<span class="number">6</span>]&lt;&lt;<span class="number">8</span>)|buffer3[<span class="number">5</span>])/<span class="number">32768.0</span>*<span class="number">180</span>;</span><br><span class="line">temperature=((buffer3[<span class="number">8</span>]&lt;&lt;<span class="number">8</span>)buffer3[<span class="number">7</span>])/<span class="number">100.0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再通过其中的pitchy来判断上下坡信息并调整速度，并且上坡的度数越大，速度越快。下坡的读书越大，速度越慢。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"> <span class="type">int</span> speed=<span class="number">3</span>;</span><br><span class="line"> <span class="type">float</span> s_up=<span class="number">1</span>;</span><br><span class="line"> <span class="type">float</span> s_down=<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* 设置系统时钟为72M ;*/</span></span><br><span class="line">  SystemInit();</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  SysTick_Configuration();  <span class="comment">//SysTick中断配置，主要用来定时</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">//LCD_12864_init();//液晶屏初始化</span></span><br><span class="line">  </span><br><span class="line">  GPIO_ALL_Config(); <span class="comment">//GPIO初始化</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">//Init_LED();   //流水灯等延时38秒等待WIFI模块启动</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">//Init_Steer(); //舵机角度初始化  </span></span><br><span class="line">    </span><br><span class="line">  <span class="comment">//TIM2_PWM_Init(); //定时器2(舵机PWM初始化)</span></span><br><span class="line">  </span><br><span class="line">  TIM4_Init(); <span class="comment">//定时器4(计时)</span></span><br><span class="line">    </span><br><span class="line">  TIM5_PWM_Init(); <span class="comment">//定时器5(电机速度PWM初始化)</span></span><br><span class="line">  </span><br><span class="line">  USART1_Config();  <span class="comment">//串口初始化</span></span><br><span class="line">  </span><br><span class="line">  ifstop=<span class="number">0</span>; <span class="comment">//用来计数多长时间没有检测到黑线</span></span><br><span class="line">  USART3_Config();</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  Set_Right_Speed(<span class="number">500</span>);</span><br><span class="line">  Set_Left_Speed(<span class="number">500</span>);</span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">  &#123; </span><br><span class="line">    <span class="keyword">if</span>(ifstop&lt;<span class="number">150000</span>)&#123;</span><br><span class="line">       TrackLine();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(pitchy&gt;<span class="number">190</span>)&#123;</span><br><span class="line">       Set_Right_Speed((u16)(speed+(pitchy<span class="number">-180</span>)*s_up));</span><br><span class="line">       Set_Left_Speed((u16)(speed+(pitchy<span class="number">-180</span>)*s_up));</span><br><span class="line">     &#125;</span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span>(pitchy&lt;<span class="number">170</span>)&#123;</span><br><span class="line">      Set_Right_Speed((u16)(speed+(<span class="number">180</span>-pitchy)*s_down));</span><br><span class="line">      Set_Left_Speed((u16)(speed+(<span class="number">180</span>-pitchy)*s_down));</span><br><span class="line">    &#125; </span><br><span class="line">   <span class="keyword">else</span>&#123;</span><br><span class="line">     Set_Right_Speed(speed);</span><br><span class="line">     Set_Left_Speed(speed);</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="智能检测">智能检测</h2><p>yolov5智能检测的原理如图4-11所示。对于Yolov5，这是基于YOLOv3（一种轻量级检测网络）改进的。YOLOv5网络结构由四部分组成：输入侧，骨干，颈部和预测。输入端采用Mosaic数据增强，并针对不同数据集获得自适应锚帧计算和自适应图像缩放。骨干网络采用集中结构，同时设计两种CSP结构，一种应用于骨干网，另一种应用于Neck;颈部部分是FPN和PAN结构， 相比YOLOv4，YOLOv5不同之处在于颈部结构采用了从CSPnet设计中借鉴的CSP2结构，增强了网络特征融合的能力;输出端采用边界框损耗函数，实现更快更好的收敛效果。</p><p><img src="https://image.asa-world.cn/pic/clip_image002.jpg" alt="YOLO检测"></p><p>事实上，对于yolov5智能检测流程，未来我们还会进行进一步优化，具体如下：火星车在火星上进行搜寻，摄像系统将视频流传给火星基地，然后火星基地依靠强大的计算能力，分析得出相关结果，对小车下发指令，指导小车进行运动。下面是我们预期的工作流程图：</p><p><img src="https://image.asa-world.cn/pic/image-20230205140852371.png" alt="智能检测优化"></p><h2 id="红外循迹">红外循迹</h2><p>此功能通过两个红外传感模块实现。其基本原理为检测红外线的反射，而黑线能够吸收红外线，因此黑线不会反射红外线，也就检测不到。通过这个原理，就可以判断当前车辆相对于黑线的位置。当两边都能检测到反射时，说明黑线在两个传感器中间，车辆前进。当左边或者右边检测不到反射时，说明车辆偏向一边，此时应该左转或右转。当两边都检测不到反射时，说明车辆到达终点，应该停下来。</p><p><img src="https://image.asa-world.cn/pic/image-20230205141023165.png" alt="寻迹原理"></p><p>通过TR_L和TR_R分别接收红外传感器传来的数据，其中检测到值为1，没有检测到值为0。结合方向控制函数根据我们的基本逻辑即可实现红外循迹。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">line</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>((TR_L==<span class="number">0</span>)&amp;&amp;(TR_R==<span class="number">0</span>))<span class="comment">//两边同时都没有探测到黑线</span></span><br><span class="line">    &#123;</span><br><span class="line">        MOTOR_GO_FORWARD;</span><br><span class="line">         <span class="keyword">return</span>;</span><br><span class="line">     &#125; </span><br><span class="line">                       </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>((TR_L == <span class="number">1</span>)&amp;&amp;(TR_R== <span class="number">0</span>))<span class="comment">//右侧遇到障碍  </span></span><br><span class="line">      &#123;</span><br><span class="line">        MOTOR_GO_LEFT;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">              </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>((TR_L == <span class="number">0</span>)&amp;&amp;(TR_R == <span class="number">1</span>))<span class="comment">//左侧遇到障碍 </span></span><br><span class="line">      &#123;</span><br><span class="line">        MOTOR_GO_RIGHT;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">                       </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>((TR_L == <span class="number">1</span>)&amp;&amp;(TR_R == <span class="number">1</span>))<span class="comment">//左右都检测到黑线，就如视频中的那样遇到一道横的胶带 </span></span><br><span class="line">      &#123;</span><br><span class="line">        MOTOR_GO_STOP;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h1 id="问题与解决">问题与解决</h1><blockquote><p>超声波模块间歇失控</p></blockquote><ul><li><strong>问题描述</strong>：超声波模块有时距离障碍物很远时就启动机械臂，有时撞上障碍物时也没有反应。</li><li><strong>解决思路</strong>：我们首先怀疑是不是超声波模块有问题，我们换了几个模块还是有问题。然后我们觉得是不是模块缓冲区的问题，是不是上一次检测到障碍物时还未将结果存入缓冲区，再次启动时才将缓冲区读取出来，这样就可以解释“撞上障碍物时也没有反应，后面再次启动时又会立刻有反应”这一现象了。</li><li><strong>解决方法</strong>：最后我们发现是因为主代码中有一段中断程序，过了一段时间程序就会进入该中断而不再执行我们的代码，删掉中断程序后即可正常运行。</li></ul><blockquote><p>火星车行进偏移</p></blockquote><ul><li><strong>问题描述</strong>：火星车前进路线不直，上到跷跷板后会掉下来。</li><li><strong>解决方法</strong>：因为每个电机的生产情况不尽相同，因此相同的PWM信号也会使电机的旋转情况不同。需要自己手动补偿速度差异。</li></ul><blockquote><p>姿态传感器无效</p></blockquote><ul><li><strong>问题描述</strong>：在最初进行这个功能的调试过程中，我们发现火星车无法通过串口接收姿态传感器传递的内容</li><li><strong>解决思路</strong>：最开始我们以为是自身算法没有写好，但经过层层排查之后，我们发现用串口助手也无法接收到姿态传感器的内容，于是考虑是姿态传感器的问题，最终在更换姿态传感器后解决。</li></ul><blockquote><p>姿态传感器数据不准确</p></blockquote><ul><li><strong>问题描述</strong>：姿态传感器的角度信息不准确，当处于平地的时候会认为处于上坡。</li><li><strong>解决思路</strong>：通过多次实验发现姿态传感器的角度数据有一个固定的偏差，通过对接收到的角度数据做一个固定的调零后可以解决这个问题。</li></ul><blockquote><p>火星车的wifi模块的不稳定</p></blockquote><ul><li><strong>问题描述</strong>：火星车的wifi模块和电脑的连接经常会出现断连，重连的现象。</li><li><strong>解决方法</strong>：经过检查和分析，是火星车的STM32主板给wifi模块供电的电压不足。</li></ul><blockquote><p>火星车和WiFi模块的上位机通信</p></blockquote><ul><li><strong>问题描述</strong>：上位机（电脑或者手机）接入火星车的wifi之后，便仅能接收到视频，而不能给火星车下放指令。</li><li><strong>原因推断</strong>：在wifi开启之后，38秒流水灯还没有走完的情况之下，电脑就接入wifi，会打断STM32主板里面的相关指令接收模块的初始化。因为接入会给主板发送一个信号，相当于一个指令。</li></ul><blockquote><p>红外传感器灵敏度不足</p></blockquote><ul><li><strong>问题描述</strong>：红外传感器无法准确探测黑线，灵敏度不足。</li><li><strong>解决方法</strong>：通过手动使用螺丝刀调节红外传感器的灵敏度，可以调整红外循迹的流畅度，从而更好地实现循迹。</li></ul><hr><blockquote><p>鸣谢：勇勇子、奇奇子</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 项目报告 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目开发 </tag>
            
            <tag> C语言 </tag>
            
            <tag> 人工智能 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于软件工程的学生基本信息管理系统数据库设计报告</title>
      <link href="/86ecce66/"/>
      <url>/86ecce66/</url>
      
        <content type="html"><![CDATA[<h1 id="概述-2">概述</h1><h2 id="软件工程定义">软件工程定义</h2><p>关于软件工程的定义，在GB/T11457-2006《消息技术 软件工程术语》中将其定义为&quot;应用计算机科学理论和技术以及工程管理原则和方法，按预算和进度，实现满足用户要求的软件产品的定义、开发、和维护的工程或进行研究的学科&quot;。</p><h2 id="软件工程意义">软件工程意义</h2><h3 id="软件工程与软件开发">软件工程与软件开发</h3><p>软件的开发到底是一门科学还是一门工程，这是一个被争论了很久的问题。实际上，软件开发兼有两者的特点。但是这并不意味着它们可以被互相混淆。很多人认为软件工程基于计算机科学和信息科学就如传统意义上的工程学之于物理和化学一样。在美国，大约40%的软件工程师具有计算机科学的学位。在世界其他地方，这个比例也差不多。他们并不一定会每天使用计算机科学方面的知识，但是他们每天都会使用软件工程方面的知识。</p><h3 id="软件工程地位">软件工程地位</h3><p>软件工程学科是计算学科的分支，计算学科中理论、抽象、设计等三个学科形态，绑定、大问题的复杂性、概念和形式模型、一致性和完备性、效率、演化、抽象层次、按空间排序、按时间排序、重用、安全性、折衷与决策等十二个基本概念，数学方法、系统科学方法在软件工程学科中占有重要地位。此外，软件工程还十分重视管理过程，以提高软件产品的质量、降低开发成本、保证工程按时完成。系统性、规范性、可度量性也是软件工程非常关注的。</p><p>软件工程学科的理论基础是数学、计算机科学。软件工程的研究和实践涉及人力、技术、资金、进度的综合管理，是开展最优化生产活动的过程；软件工程必须划分系统的边界，给出系统的解决方案。因此，软件工程的相关学科有计算机科学与技术、数学、计算机工程、管理学、系统工程和人类工程学等。</p><hr><h1 id="需求分析-2">需求分析</h1><h2 id="信息需求分析">信息需求分析</h2><p>对学校而言，学生成绩管理是管理工作中重要的一环，但是高校学生的成绩管理工作量大、繁杂，人工处理非常困难。因此，借助于强大计算机的处理能力，能够把人从繁重的成绩管理工作中解脱出来，并且更加准确、安全、清晰的管理环境。</p><p>该数据库需要记录的数据有学生入学时会记录身份信息，包括姓名、性别、出生日期、民族、身份证号、学号、政治面貌、手机号码等相关信息；学校的多个学院和多个校区信息；每个校区的宿舍楼信息，其中宿舍楼的类别有博士生公寓、硕士生公寓和本科生公寓。</p><p>因此系统需要完整记录学生的基本信息、当前所在学院、所在校区、所住宿舍楼寝室，以及其他可能需要的信息。</p><h2 id="功能需求分析">功能需求分析</h2><p>能够进行数据库的数据定义、数据操纵、数据控制等处理功能。具体功能应包括：可提供学生基本信息查询、添加、插入、删除、更新，以及调整校区、学院、寝室的功能。</p><h2 id="安全性和完整性需求分析">安全性和完整性需求分析</h2><p>对于学生基本信息数据库来讲，由于其主要数据是学生基本信息，只能由本人以及学校单位知道，因此做好数据安全性是重中之重。另外，要求所有在校学生的信息都要录入其中，并且要设计好个别情况。</p><hr><h1 id="系统设计-2">系统设计</h1><h2 id="概念结构设计">概念结构设计</h2><p>概念结构设计是整个数据库设计的关键，它通过对用户需求进行综合、归纳与抽象，形成一个独立于具体DBMS的概念模型。</p><p>根据学生基本信息管理系统数据库设计需求抽象出学生、学院、校区、宿舍四个实体，对四个实体做简化处理，因简化后关系结构比较简单，故省略了局部E-R图。对4个实体之间的关系进行分析如下：</p><ul><li><p>一位学生位于一个学院，一个学院拥有多名学生，所以学生与学院之间是一对多（1:n）的关系；</p></li><li><p>一位学生住在一个宿舍，一门课程住着多名学生，所以学生与宿舍之间是一对多（1:n）的关系；</p></li><li><p>一个校区会有多个寝室和多个学院，而一个寝室和校区仅被一个校区拥有，所以校区与寝室、学院都是一对多（1:n）的关系；</p></li></ul><h3 id="系统实体抽象">系统实体抽象</h3><ul><li>学生（学号、姓名、性别、出生日期、民族、身份证号、政治面貌、手机号码、学院、宿舍）；</li><li>学院（编号、名称、类型）；</li><li>校区（编号、名称、地址）；</li><li>宿舍（编号、类型、校区）</li></ul><h3 id="全局E-R图">全局E-R图</h3><p><img src="https://image.asa-world.cn/pic/clip_image002.jpg" alt="全局E-R模型图"></p><h2 id="逻辑结构设计">逻辑结构设计</h2><h3 id="关系模式">关系模式</h3><p>E-R图向关系模型转化要解决的问题是如何将实体型和实体间的联系转化为关系模式，如何确定这些关系模式的属性和码。</p><p>设计学生基本信息管理系统数据库，包括学生（student）、学院（school）、校区（campus）、宿舍（dormitory）四个实体，其关系模式中对每个实体定义属性如下：</p><ul><li>student表: 学号（snum）、姓名（sname）、性别（sgender）、出生日期（sbirthday）、民族（snationality）、身份证号(sid)、政治面貌（spolitical）、手机号码（sphonenum）、学院（schoolid）、宿舍（dormitoryid），此为联系“student表”所对应的关系模式，学号为该关系的候选码，满足第三范式。</li><li>school表：学院编号（schoolid）、学院名称（schoolname）学院类型（schooltype），此为联系“school表”所对应的关系模式，学院编号为该关系的候选码，满足第三范式。</li><li>campus表：（校区编号（campusid）、校区名称（campusname）、校区地址（campuaddress），此为联系“campus表”所对应的关系模式，校区编号为该关系的候选码，满足第三范式。</li><li>dormitory表：（宿舍编号（dormitorysid）、宿舍类型（dormitorytype）、校区编号（campusid），此为联系“dormitory表”所对应的关系模式，宿舍编号为该关系的候选码，满足第三范式。</li></ul><h3 id="表结构">表结构</h3><p><img src="https://image.asa-world.cn/pic/image-20230204215137911.png" alt="学生表结构"></p><p><img src="https://image.asa-world.cn/pic/image-20230204215214237.png" alt="学院表结构"></p><p><img src="https://image.asa-world.cn/pic/image-20230204215258626.png" alt="校区表结构"></p><p><img src="https://image.asa-world.cn/pic/image-20230204215311731.png" alt="宿舍表结构"></p><hr><h1 id="代码与实现">代码与实现</h1><h2 id="创建表">创建表</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ---------------------------- </span></span><br><span class="line"><span class="comment">-- 创建学生表 </span></span><br><span class="line"><span class="comment">-- ---------------------------</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student(</span><br><span class="line">STUID NUMBER(<span class="number">13</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,<span class="comment">--学号</span></span><br><span class="line">SNUM NUMBER(<span class="number">18</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span>, <span class="comment">--身份证号</span></span><br><span class="line">SNAME <span class="type">VARCHAR</span>(<span class="number">20</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span>, <span class="comment">--姓名</span></span><br><span class="line">SGENDER <span class="type">VARCHAR</span>(<span class="number">20</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span>, <span class="comment">--性别</span></span><br><span class="line">SBIRTHDAY  <span class="type">DATE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>, <span class="comment">-- 出生日期</span></span><br><span class="line">SPOLITICAL <span class="type">VARCHAR</span>(<span class="number">20</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span>, <span class="comment">--政治面貌</span></span><br><span class="line">SNATIONALITY <span class="type">VARCHAR</span>(<span class="number">20</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span>, <span class="comment">--民族</span></span><br><span class="line">SPHONENUM NUMBER(<span class="number">11</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span>,  <span class="comment">--手机号码</span></span><br><span class="line">SCHOOLID NUMBER(<span class="number">10</span>)<span class="keyword">NULL</span>, <span class="comment">--学院编号</span></span><br><span class="line">DORMITORYID <span class="type">VARCHAR</span>(<span class="number">20</span>)<span class="keyword">NULL</span> <span class="comment">--宿舍编号</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> PK_student <span class="keyword">PRIMARY</span> KEY(SNUM); <span class="comment">--创建主键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> CK_student_SGENDER</span><br><span class="line">  <span class="keyword">CHECK</span>(SGENDER <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span> <span class="keyword">OR</span> SGENDER <span class="operator">=</span> <span class="string">&#x27;女&#x27;</span>);   <span class="comment">--创建性别约束条件</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> CK_student_SPOLITICAL</span><br><span class="line">  <span class="keyword">CHECK</span>(SPOLITICAL <span class="operator">=</span> <span class="string">&#x27;中共党员&#x27;</span> <span class="keyword">OR</span> SPOLITICAL <span class="operator">=</span> <span class="string">&#x27;中共预备党员&#x27;</span> <span class="keyword">OR</span> SPOLITICAL <span class="operator">=</span> <span class="string">&#x27;共青团员&#x27;</span> <span class="keyword">OR</span> SPOLITICAL <span class="operator">=</span> <span class="string">&#x27;群众&#x27;</span> <span class="keyword">OR</span> SPOLITICAL <span class="operator">=</span> <span class="string">&#x27;其他&#x27;</span> );  <span class="comment">--创建政治面貌约束条件</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">-- ---------------------------- </span></span><br><span class="line"><span class="comment">-- 创建校区表 </span></span><br><span class="line"><span class="comment">-- ---------------------------</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> campus(</span><br><span class="line">CAMPUSID NUMBER(<span class="number">10</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span>,<span class="comment">--校区编号</span></span><br><span class="line">CAMPUSNAME <span class="type">VARCHAR</span>(<span class="number">30</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span>,<span class="comment">--校区名称</span></span><br><span class="line">CAMPUSADDRESS <span class="type">VARCHAR</span>(<span class="number">30</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span><span class="comment">--校区地址</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> campus <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> PK_campus <span class="keyword">PRIMARY</span> KEY(CAMPUSID);<span class="comment">--创建主键约束</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ---------------------------- </span></span><br><span class="line"><span class="comment">-- 创建学院表 </span></span><br><span class="line"><span class="comment">-- ---------------------------</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> school(</span><br><span class="line">SCHOOLID NUMBER(<span class="number">10</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span>,<span class="comment">--学院编号</span></span><br><span class="line">SCHOOLNAME <span class="type">VARCHAR</span>(<span class="number">20</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span>, <span class="comment">--学院名称</span></span><br><span class="line">SCHOOLTYPE <span class="type">VARCHAR</span>(<span class="number">20</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span>, <span class="comment">--学院类型</span></span><br><span class="line">CAMPUSID NUMBER(<span class="number">10</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span><span class="comment">--校区编号</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> school <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> PK_school <span class="keyword">PRIMARY</span> KEY(SCHOOLID);<span class="comment">--创建主键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> school <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> CK_school_TYPE  <span class="comment">--创建学院类型约束条件</span></span><br><span class="line">  <span class="keyword">CHECK</span>(SCHOOLTYPE <span class="operator">=</span> <span class="string">&#x27;自然科学&#x27;</span> <span class="keyword">OR</span> SCHOOLTYPE <span class="operator">=</span> <span class="string">&#x27;农业科学&#x27;</span> <span class="keyword">OR</span> SCHOOLTYPE <span class="operator">=</span> <span class="string">&#x27;医药科学&#x27;</span> <span class="keyword">OR</span> SCHOOLTYPE <span class="operator">=</span> <span class="string">&#x27;工程与技术科学&#x27;</span> <span class="keyword">OR</span> SCHOOLTYPE <span class="operator">=</span> <span class="string">&#x27;人文与社会科学&#x27;</span> ); </span><br><span class="line"><span class="comment">-- ---------------------------- </span></span><br><span class="line"><span class="comment">-- 创建宿舍表 </span></span><br><span class="line"><span class="comment">-- ---------------------------</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> dormitory(</span><br><span class="line">DORMITORYID <span class="type">VARCHAR</span>(<span class="number">20</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span>,<span class="comment">--宿舍编号</span></span><br><span class="line">DORMITORYTYPE <span class="type">VARCHAR</span>(<span class="number">20</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span>,<span class="comment">--宿舍类型</span></span><br><span class="line">CAMPUSID NUMBER(<span class="number">10</span>)<span class="keyword">NOT</span> <span class="keyword">NULL</span><span class="comment">--校区编号</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> dormitory <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> PK_dormitory <span class="keyword">PRIMARY</span> KEY(DORMITORYID);<span class="comment">--创建主键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> dormitory <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> CK_dormitory_TYPE</span><br><span class="line">  <span class="keyword">CHECK</span>(DORMITORYTYPE <span class="operator">=</span> <span class="string">&#x27;本科生公寓&#x27;</span> <span class="keyword">OR</span> DORMITORYTYPE <span class="operator">=</span> <span class="string">&#x27;硕士生公寓&#x27;</span> <span class="keyword">OR</span> DORMITORYTYPE <span class="operator">=</span> <span class="string">&#x27;硕士生公寓&#x27;</span> );  <span class="comment">--创建宿舍类型约束条件</span></span><br><span class="line"><span class="comment">-- ---------------------------- </span></span><br><span class="line"><span class="comment">-- 创建外键约束 </span></span><br><span class="line"><span class="comment">-- ---------------------------</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> FK_student_school_SCHOOLID </span><br><span class="line">  <span class="keyword">FOREIGN</span> KEY(SCHOOLID) <span class="keyword">REFERENCES</span> school(SCHOOLID);<span class="comment">--创建外键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> FK_student_DORMITORYID </span><br><span class="line">  <span class="keyword">FOREIGN</span> KEY(DORMITORYID) <span class="keyword">REFERENCES</span> dormitory(DORMITORYID);<span class="comment">--创建外键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> school <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> FK_school_campus_CAMPUSID <span class="keyword">FOREIGN</span> </span><br><span class="line">  KEY(CAMPUSID) <span class="keyword">REFERENCES</span> campus(CAMPUSID);<span class="comment">--创建外键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> dormitory <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> FK_dormitory_campus_CAMPUSID <span class="keyword">FOREIGN</span> </span><br><span class="line">  KEY(CAMPUSID) <span class="keyword">REFERENCES</span> campus(CAMPUSID);<span class="comment">--创建外键约束</span></span><br></pre></td></tr></table></figure><h2 id="插入校区信息">插入校区信息</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> campus <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;电子科技大学清水河校区&#x27;</span>,<span class="string">&#x27;四川省成都市高新区&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> campus <span class="keyword">VALUES</span> (<span class="number">2</span>,<span class="string">&#x27;电子科技大学沙河校区&#x27;</span>,<span class="string">&#x27;四川省成都市成华区&#x27;</span>);</span><br></pre></td></tr></table></figure><p><img src="https://image.asa-world.cn/pic/image-20230204215823293.png" alt="插入校区信息"></p><h2 id="插入学院信息">插入学院信息</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> school <span class="keyword">VALUES</span> (<span class="number">0001</span>,<span class="string">&#x27;信通学院&#x27;</span>,<span class="string">&#x27;工程与技术科学&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> school <span class="keyword">VALUES</span> (<span class="number">0002</span>,<span class="string">&#x27;电子学院&#x27;</span>,<span class="string">&#x27;工程与技术科学&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> school <span class="keyword">VALUES</span> (<span class="number">0003</span>,<span class="string">&#x27;微电子学院&#x27;</span>,<span class="string">&#x27;工程与技术科学&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> school <span class="keyword">VALUES</span> (<span class="number">0004</span>,<span class="string">&#x27;医学院&#x27;</span>,<span class="string">&#x27;医药科学&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> school <span class="keyword">VALUES</span> (<span class="number">0005</span>,<span class="string">&#x27;软件学院&#x27;</span>,<span class="string">&#x27;工程与技术科学&#x27;</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure><p><img src="https://image.asa-world.cn/pic/image-20230204215915615.png" alt="插入学院信息"></p><h2 id="插入宿舍信息">插入宿舍信息</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dormitory <span class="keyword">VALUES</span> (<span class="string">&#x27;27#211&#x27;</span>,<span class="string">&#x27;本科生公寓&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dormitory <span class="keyword">VALUES</span> (<span class="string">&#x27;27#439&#x27;</span>,<span class="string">&#x27;本科生公寓&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dormitory <span class="keyword">VALUES</span> (<span class="string">&#x27;27#440&#x27;</span>,<span class="string">&#x27;本科生公寓&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dormitory <span class="keyword">VALUES</span> (<span class="string">&#x27;11#440&#x27;</span>,<span class="string">&#x27;硕士生公寓&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dormitory <span class="keyword">VALUES</span> (<span class="string">&#x27;12#440&#x27;</span>,<span class="string">&#x27;硕士生公寓&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dormitory <span class="keyword">VALUES</span> (<span class="string">&#x27;37#210&#x27;</span>,<span class="string">&#x27;博士生公寓&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dormitory <span class="keyword">VALUES</span> (<span class="string">&#x27;27#211&#x27;</span>,<span class="string">&#x27;本科生公寓&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dormitory <span class="keyword">VALUES</span> (<span class="string">&#x27;27$439&#x27;</span>,<span class="string">&#x27;本科生公寓&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dormitory <span class="keyword">VALUES</span> (<span class="string">&#x27;27$440&#x27;</span>,<span class="string">&#x27;本科生公寓&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dormitory <span class="keyword">VALUES</span> (<span class="string">&#x27;11$440&#x27;</span>,<span class="string">&#x27;硕士生公寓&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dormitory <span class="keyword">VALUES</span> (<span class="string">&#x27;12$440&#x27;</span>,<span class="string">&#x27;硕士生公寓&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dormitory <span class="keyword">VALUES</span> (<span class="string">&#x27;37$210&#x27;</span>,<span class="string">&#x27;博士生公寓&#x27;</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure><p><img src="https://image.asa-world.cn/pic/image-20230204220025922.png" alt="插入宿舍信息"></p><h2 id="插入学生信息">插入学生信息</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student </span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">2020010902003</span>,<span class="number">123445567</span>,<span class="string">&#x27;小明&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,TO_DATE(<span class="string">&#x27;2000-8-9&#x27;</span>,<span class="string">&#x27;yyyy-MM-dd&#x27;</span>),<span class="string">&#x27;党员&#x27;</span>,<span class="string">&#x27;汉&#x27;</span>,<span class="number">15130796857</span>,<span class="number">1</span>, <span class="string">&#x27;27#440&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student </span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">2020010902013</span>,<span class="number">123422567</span>,<span class="string">&#x27;小红&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,TO_DATE(<span class="string">&#x27;2001-2-7&#x27;</span>,<span class="string">&#x27;yyyy-MM-dd&#x27;</span>),<span class="string">&#x27;群众&#x27;</span>,<span class="string">&#x27;汉&#x27;</span>,<span class="number">18330796857</span>,<span class="number">3</span>, <span class="string">&#x27;11$440&#x27;</span>);</span><br></pre></td></tr></table></figure><p><img src="https://image.asa-world.cn/pic/image-20230204220121934.png" alt="插入学生信息"></p><hr><h1 id="思考">思考</h1><h2 id="数据库三大范式证明">数据库三大范式证明</h2><p>student表中学号（snum）、姓名（sname）、性别（sgender）、出生日期（sbirthday）、民族（snationality）、身份证号(sid)、政治面貌（spolitical）、手机号码（sphonenum）、学院（schoolid）、宿舍（dormitoryid）字段都是单一属性的，不可再分，因此满足第一范式；</p><p>并且姓名（sname）、性别（sgender）、出生日期（sbirthday）、民族（snationality）、身份证号(sid)、政治面貌（spolitical）、手机号码（sphonenum）、学院（schoolid）、宿舍（dormitoryid）都完全依赖于学号（snum）这一个候选关键字，因此满足第二范式；</p><p>学号为该关系的候选码，不存在非关键字段对任一候选关键字段的传递函数依赖则符合第三范式，因此满足第三范式。</p>]]></content>
      
      
      <categories>
          
          <category> 项目报告 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目开发 </tag>
            
            <tag> 数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>细嗦，男生经常早上敬礼的原因与睡眠周期探究</title>
      <link href="/7c9e6d7/"/>
      <url>/7c9e6d7/</url>
      
        <content type="html"><![CDATA[<h1 id="日常敬礼">日常敬礼</h1><h2 id="原因">原因</h2><p>男性朋友们应该有因为晨勃而尴尬的经验吧？晨勃，在医学上称为&quot;夜间阴茎肿胀&quot;（nocturnal penile tumescence），是很正常的现象，所有年龄层的男性都会发生，青春期至30岁期间更为频繁，甚至连子宫里的男婴也会。</p><p>那么为什么会有晨勃呢？是不是因为作了春梦？！</p><p>在睡眠周期中，进入和离开<a href="#Tsleep">快速动眼期</a>（Rapid Eye Movement，REM）时，体内荷尔蒙和神经生理上的变化会使得<strong>睪固酮</strong>（一种雄性激素）的浓度提高从而导致勃起，这和梦境内容无关。<s>色色的春梦当然也会引发勃起</s></p><p><strong>尿急</strong>也是原因之一。坐公交车时，面对突如其来的尿意我们也只能选择憋尿，除了尿急的痛苦，可能还会伴随莫名其妙的&quot;小帐篷&quot;，可谓是尴尬到家了。其原因就是膀胱因积蓄大量尿液变大从而可能会压迫到控制勃起的神经，导致小弟弟反射性起立。</p><p>另外，小弟弟与内裤或被子的<strong>摩擦</strong>也是另一个原因。</p><p>不过因为一夜好眠会经历4到5次的睡眠周期，所以通常男性一个晚上会有4～5次勃起，也因此不只&quot;晨勃&quot;，还有&quot;子时夜勃&quot;、&quot;晓风残月勃&quot;等等。</p><h2 id="意义">意义</h2><p>一些科学家认为，晨勃在生物学上有重要的意义：规律地输入大量充氧血液到阴茎，有益于组织的健康，避免勃起障碍。所以下次当你睡眼惺忪在刷牙时，低头一看可别觉得尴尬，小弟弟正在告诉你&quot;系统正常运作&quot;。</p><hr><h1 id="Tsleep">睡眠周期</h1><p>根据脑电图的不同特征，又将睡眠分为两种状态：非眼球快速运动睡眠阶段（又称安静睡眠、慢波睡眠、NREM睡眠）和眼球快速运动睡眠阶段（又称活跃睡眠、快波睡眠、REM睡眠）。研究认为，NREM睡眠主要是大脑皮层的休息，而在REM睡眠中主要是全身性的休息。</p><h2 id="非眼球快速运动睡眠阶段">非眼球快速运动睡眠阶段</h2><p>非眼球快速运动睡眠阶段，全身肌肉松弛，没有眼球运动，内脏副交感神经活动占优势。心率、呼吸均减慢，血压降低，胃肠蠕动增加，基础代谢率低，脑部温度较醒觉时稍降低，大脑总的血流量较醒觉时减少。</p><p>非眼球快速运动睡眠以其脑电图特征分为四期</p><ul><li>第一期，脑电波以θ波为主，不出现纺锤波或K综合波，实际上是由完全清醒至睡眠之间的过渡阶段，对外界刺激的反应减弱，精神活动进入飘浮境界，思维和现实脱节；</li><li>第二期，脑电波为纺锤波与K综合波，δ波少于20%，实际上人已经进入了真正的睡眠，而属于浅睡；</li><li>第三期，脑电波δ波占20%～50%，为中等深度睡眠；</li><li>第四期，脑电波δ波占50%以上，属于深睡，不易被唤醒。</li></ul><h2 id="眼球快速运动睡眠阶段">眼球快速运动睡眠阶段</h2><p>眼球快速运动睡眠阶段，出现混合频率的去同步化的低波幅脑电波。眼球快速运动，面部及四肢肌肉有很多次发作性的小抽动，有时或出现嘴唇的吸吮动作，喉部发出短促声音，手足徐动，内脏活动高度不稳定，呼吸不规则，心率经常变动，胃酸分泌增加，脑各个部分的血流量和耗氧量都比醒觉时明显增加。</p><h2 id="睡眠过程">睡眠过程</h2><p>正常人睡眠首先进入NREM睡眠期，并迅速由1期依次进入2期，3期，4期并持续下去。在NREM睡眠期持续80-120分钟后出现第一次REM睡眠，持续几分钟后进入下一次NREM睡眠，形成NREM睡眠与REM睡眠循环周期，平均每90分钟出现一次REM睡眠，越接近睡眠后期REM睡眠持续时间逐渐延长。每次可持续10-30分钟。</p><p>在成人每昼夜总睡眠时间中REM睡眠时间占20%-25%，NREM睡眠：1期占2%-5%，2期45%-50%，3期3%-8%，4期10%-15%。整个睡眠期间这种NREM-REM睡眠周期反复循环3-5次，每个周期的各期不一定齐全，但都是从1期开始，凌晨时每个周期中的睡眠深度变浅不再达到4期，从NREM睡眠与REM睡眠的循环转换可以看出，睡眠过程并非一入睡就由浅入深并持续到天明，而是深一阵，浅一阵，深浅睡眠不断交替。</p><p><img src="https://image.asa-world.cn/pic/resize,m_lfit,w_1146,limit_1" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> 刨根问底 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习笔记 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>向思想的巨人学习，毛泽东思想概论体系重点总结</title>
      <link href="/872fcfac/"/>
      <url>/872fcfac/</url>
      
        <content type="html"><![CDATA[<h1 id="导论">导论</h1><h2 id="马克思主义中国化的提出及内涵">马克思主义中国化的提出及内涵</h2><p>1938年，毛泽东在党的六届六中全会上作了《论新阶段》的报告，标志着&quot;马克思主义中国化&quot;这一命题的正式提出。</p><p>马克思主义中国化就是坚持把马克思主义基本原理同中国具体实际相结合、同中华优秀传统文化相结合，运用马克思主义的立场、观点、方法<strong>研究和解决</strong>中国革命、建设、改革中的实际问题；就是<strong>总结和提炼</strong>中国革命、建设、改革的实践经验，从而认识和掌握客观规律，为马克思主义理论宝库增添新的内容；就是运用中国人民喜闻乐见的民族语言来<strong>阐述</strong>马克思主义理论，使之成为具有中国特色、中国风格、中国气派的马克思主义。</p><h2 id="马克思主义中国化的理论成果">马克思主义中国化的理论成果</h2><p>毛泽东思想：关于中国革命和建设的正确的理论原则和经验总结，是中国共产党集体智慧的结晶。</p><p>邓小平理论：回答了什么是社会主义、怎样建设社会主义这个首要的基本的理论问题。</p><p>三个代表重要思想：加深了对什么是社会主义、怎样建设社会主义和建设什么样的党、怎样建设党的认识。</p><p>科学发展观：深刻认识和回答了新形势下实现什么样的发展、怎样发展等重大问题。</p><p>习近平新时代中国特色社会主义思想：系统回答了新时代坚持和发展什么样的中国特色社会主义、怎样坚持和发展中国特色社会主义这个时代重大课题。</p><h2 id="毛泽东思想和中国特色社会主义理论体系的关系">毛泽东思想和中国特色社会主义理论体系的关系</h2><p>毛泽东思想和中国特色社会理论体系，都是马克思主义中国化的理论成果，都是中国化的马克思主义，他们同马克思列宁主义一起，是中国共产党长期坚持的指导思想和全国各族人民团结奋斗的共同思想基础。</p><p>2018年，十三届全国人大一次会议通过的宪法修正案把马克思列宁主义、毛泽东思想、邓小平理论、三个代表重要思想、科学发展观、习近平新时代中国特色社会主义思想共同确立为国家指导思想。</p><hr><h1 id="毛泽东思想的形成与发展">毛泽东思想的形成与发展</h1><h2 id="毛泽东思想形成的历史条件">毛泽东思想形成的历史条件</h2><p>19世纪末20世纪初，<strong>世界进入帝国主义和无产阶级革命时代</strong>，1971年，俄国10月革命的胜利开辟了世界无产阶级社会主义革命的新时代。它使中国反帝反封建的民主革命，从旧的世界<strong>资产阶级民主革命</strong>的一部分，转变为新的世界<strong>无产阶级社会主义革命</strong>的一部分。10月革命给中国送来了马克思列宁主义，帮助中国的先进分子开始用无产阶级的世界观作为观察国家命运的工具。<strong>中国革命从此有了科学的指导思想</strong>，中国在革命取得胜利后，又经历了第二次世界大战后两大阵营的对立和斗争。<strong>西方国家不仅对我国实行持续的封锁禁运，还极力推行和平演变战略</strong>，毛泽东思想正是在这样的时代条件下形成和发展起来的。</p><p>中国共产党成立之后，为中国人民谋幸福，为中华民族谋复兴，经历了千辛万苦的奋斗历程，有成功的宝贵经验，也有失败的惨痛教训。这些经验教训促使以毛泽东为主要代表的中国共产党人，更深入的思考中国革命和建设问题。<strong>毛泽东思想正是对这些经验教训进行深刻总结形成的理论成果</strong>，没有中国革命和建设的丰富实践，没有对中国革命和建设经验的深刻总结，就不可能有毛泽东思想。正是经过长期实践的反复比较，党和人民选择了毛泽东，作为自己的领袖，选择了毛泽东思想作为自己的指导思想，<strong>中国共产党领导人民进行革命和建设的成功实践，是毛泽东思想形成和发展的实践基础</strong>。</p><h2 id="毛泽东关于革命军队建设和军事战略的理论">毛泽东关于革命军队建设和军事战略的理论</h2><p>毛泽东系统解决了<strong>如何把以农民为主要成分的革命军队建设成为一支无产阶级性质的，具有严格纪律的，同人民群众保持亲密联系的新型人民军队</strong>的问题。</p><p>他<strong>规定了</strong>全心全意为人民服务是人民军队的唯一宗旨。<strong>规定了</strong>是党指挥枪，而不是枪指挥党的原则，<strong>制定了</strong>三大纪律八项注意。<strong>强调</strong>实行政治，经济、军事三大民主，实行官兵一致，军民一致和瓦解敌军的原则，<strong>提出和总结了</strong>一套军队政治工作的方针和方法，他<strong>总结了</strong>中国长期革命战争的经验，系统的<strong>提出了</strong>建设人民军队的思想，<strong>提出了</strong>以人民军队为骨干，依靠广大人民群众建立农村根据地，进行人民战争的思想，他把游击战争提到了战略的地位，<strong>认为</strong>中国革命战争在长时间内的主要作战形式是游击战和带游击性的运动战，他<strong>论述了</strong>要随着敌我力量对比的变化和战争发展的进程，正确的实行军事战略的转变，他为革命军队<strong>制定了</strong>在敌强我弱的形势下实行战略的持久战和战役战斗上的速决战，把战略上的劣势转变为战役战斗上的优势，集中优势兵力，各个歼灭敌人等一系列人民战争的战略战术，他在解放战争中<strong>总结出</strong>著名的十大军事原则，这些都是毛泽东对马克思列宁主义军事理论极为杰出的贡献，在中华人民共和国成立以后，他<strong>提出</strong>必须加强国防，建设现代化革命武装力量和发展现代化国防技术的重要指导思想。</p><h2 id="毛泽东关于党的建设的理论">毛泽东关于党的建设的理论</h2><p>在无产阶级人数很少而战斗力很强，农民和其他小资产阶级占人口大多数的国家，建设一个具有广泛群众性的、马克思主义的无产阶级政党，是极其艰巨的任务，毛泽东建党学说成功地解决了这个问题。</p><p>他特别注重从思想上建党，提出党员不但要在组织上入党，而且要在思想上入党，经常注意以无产阶级思想改造和克服各种非无产阶级思想，他<strong>指出</strong>理论和实践相结合的作风和人民群众紧密的联系在一起的作风以及自我批评的作风，是中国共产党区别于其他任何政党的显著标志，针对历史上党内斗争中存在过的&quot;残酷斗争无情打击&quot;的&quot;左&quot;的错误，他<strong>提出</strong>惩前&quot;毖后，治病救人&quot;的正确方针，<strong>强调</strong>在党内斗争中要达到既弄清思想又团结同志的目的，他<strong>创造</strong>了全党通过批评和自我批评进行马克思列宁主义思想教育的整风形势，中华人民共和国成立前后，鉴于我们党已成为领导全国政权的党，他多次<strong>提出</strong>，务必使同志们继续的保持谦虚谨慎，不骄不躁的作风，务必使同志们继续地保持艰苦奋斗的作风，<strong>要求</strong>全党警惕资产阶级思想的侵蚀，反对脱离群众的官僚主义，这些重要思想为马克思主义建党理论增添了新的内容，为中国共产党的建设指明了正确的方向。</p><h2 id="毛泽东思想活的灵魂">毛泽东思想活的灵魂</h2><h3 id="实事求是">实事求是</h3><p><strong>实事求是就是一切从实际出发，理论联系实际，坚持在实践中检验真理和发展真理</strong>。毛泽东指出，&quot;实事&quot;就是客观存在着的一切事物，&quot;是&quot;就是客观事物内部的联系及规律性，&quot;求&quot;就是我们去研究。</p><p><strong>坚持实事求是就要深入实际，了解事物的本来面貌，把握事物内在必然联系，按照客观规律办事</strong>。坚持实事求是不可能一劳永逸，我们要自觉坚定实事求是的信念，增强实事求是的本领，时时处处把实事求是牢记于心，付诸于行。</p><p><strong>坚持实事求是就要清醒认识和正确把握我国基本国情</strong>。我们一切路线方针政策的制定，仍坚持从我国基本国情出发，牢牢立足基本国情这个最大实际，充分体现这个基本国情的必然要求，任何超越现实、超越阶段而急于求成的倾向，都要努力避免，任何落后于实际，无视深刻变化着的客观事实，而因循守旧固步自封的观念和做法都要坚决纠正。</p><p><strong>坚持实事求是就要不断推进实践基础上的理论创新</strong>。实践没有止境，理论创新也没有止境，马克思主义基本原理是普遍真理，具有永恒的思想价值。而马克思主义经典作家并没有囚禁真理，而是为不断寻求真理和发展真理开辟了道路，我们必须以马克思主义为指导，继续开拓创新，在实践中丰富和发展马克思主义，与此同时，我们要及时总结党领导人民在实践中创造的新鲜经验，形成和发展中国化的马克思主义理论成果，不断开辟马克思主义中国化新境界。</p><h3 id="群众路线">群众路线</h3><p><strong>群众路线，就是一切为了群众，一切依靠群众，从群众中来到群众中去，把党的正确主张变为群众的自觉行动</strong>。群众路线是以毛泽东为主要代表的中国共产党人，坚持把马克思列宁主义关于人民群众是历史创造者的原理，系统的运用到党的全部活动中，形成的党的根本工作路线，不论过去、现在、将来，群众路线都是我们党的生命线和根本工作路线，是我们党永葆青春活力和战斗力的重要传家宝。</p><p><strong>群众路线本质上体现的是马克思主义关于人民群众是历史的创造者这一基本原理</strong>。只有坚持这一基本原理，我们才能把握历史前进的基本规律，只有按历史规律办事，我们才能无往而不胜，历史反复证明人民群众是历史发展和社会进步的主体力量。</p><p><strong>坚持群众路线，就要坚持人民是推动历史发展的根本力量</strong>。必须尊重人民首创精神，调动最广大人民的积极性主动性，创造性，充分发挥人民群众的历史推动作用。在人民面前我们永远是小学生，必须自觉拜人民为师，向能者求教，向智者问策，必须充分尊重人民所表达的意愿，所创造的经验，所拥有的权利，所发挥的作用，要正确行使，人民给予的权力，服务人民，为了人民，依靠人民，自觉接受人民监督，紧紧依靠人民创造历史伟业，使我们党的根基永远坚如磐石。</p><p><strong>坚持群众路线，就要坚持全心全意为人民服务的根本宗旨</strong>。全心全意为人民服务，是我们党一切行动的根本出发点和落脚点，是我们党区别于其他一切政党的根本，标志党除了工人阶级和广大人民群众的利益，没有自己的特殊利益，党在任何时候都把人民利益放在第一位，不允许任何党员脱离群众凌驾于群众之上，检验党的一切。工作的成效，最终要以最广大人民根本利益为最高标准。</p><p><strong>坚持群众路线，就要保持党同人民群众的血肉联系</strong>。党风问题，党同人民群众的联系问题，关系党的生死存亡，要把群众观点群众路线深深植根于全党同志思想中，真正落实到每个党员行动上。</p><h3 id="独立自主">独立自主</h3><p><strong>独立自主，就是坚持独立思考，走自己的路，就是坚定不移的维护民族独立，捍卫国家主权，把立足点放在依靠自己力量的基础上，同时积极争取外援，开展国际经济文化交流，学习外国一切对我们有益的先进事物</strong>。独立自主是中华民族的优良传统，是中国共产党中华人民共和国，立党立国的重要原则，使我们党从中国实际出发，依靠党和人民力量进行革命建设改革的必然结论，在中国这样一个人口众多和经济文化落后的东方大国进行革命和建设决定了，我们只能走自己的路，不论过去，现在和将来，我们都要把国家和民族发展放在自己力量的基点上，增强民族自尊心和自信心，坚定不移走自己的路。</p><p><strong>坚持独立自主，就要坚持中国的事情必须由中国人民自己处理</strong>。中国共产党在领导革命建设改革的长期实践中，历来坚持独立自主的开拓，进行道路，这种独立自主的探索和实践精神，这种坚持走自己的路的坚定信心和决心，使我们党全部理论和实践的立足点也是党和人民事业不断从胜利走向胜利的根本保证。</p><p><strong>坚持独立自主，就要坚持独立自主的和平外交政策，坚定不移走和平发展道路</strong>。恪守维护世界和平、促进共同发展的外交宗旨，坚持在和平共处五项原则基础上，同各国友好相处，在平等互利基础上积极开展同各国的交流合作，中国尊重各国人民自主选择发展道路的权利，维护国际公共公平正义，根据事情本身的是非曲直决定自己的立场和政策。主张以和平方式解决国际争端，反对各种形式的霸权主义和强权政治，反对把自己的意志强加于人，反对干涉别国内政，反对以强凌弱，中国无论发展到什么程度，都永远不称霸，永远不搞扩张。</p><hr><h1 id="新民主主义革命理论">新民主主义革命理论</h1><h2 id="近代中国国情和中国革命的时代特征">近代中国国情和中国革命的时代特征</h2><h3 id="近代中国国情">近代中国国情</h3><p>中华民族在5000多年的历史进程中创造了灿烂的中华文明，鸦片战争后由于西方列强的入侵，由于封建统治的腐败。中国逐渐成为半殖民地半封建社会，这是近代中国<strong>最基本的国情</strong>。半殖民地半封建社会，既不同于封建社会，也有别于资本主义社会，蕴含着特殊的社会矛盾和革命要求。</p><p>一方面，帝国主义的侵略虽然在一定程度上加速了封建社会自给自足的自然经济的解体，客观上为中国资本主义的发展创造了一定条件，但不能使中国发展成为资本主义国家，这是因为<strong>封建制度的根基</strong> —— 地主阶级对农民的剥削<strong>依旧存在</strong>，而且同买办资本和高利贷资本的剥削结合在一起，在中国社会经济生活中占据着明显优势，又因为<strong>中国民族资本主义先天不足</strong>，尽管有了某些发展，并在社会政治文化生活中起了较大作用，但它没有成为中国社会经济的主要形式，加之受外国资本，官僚资本和封建势力的<strong>多重压迫</strong>，中国民族资本主义不仅没有成为中国经济的主要形式，而且也不可能在整个社会经济中占据主导地位。封建社会皇帝和贵族的专制政权尽管被推翻了，但<strong>并未建立起资产阶级政权</strong>，代而之而起的，先是地主阶级军阀官僚的统治，接着是地主阶级和大资产阶级联盟的专政，整个社会呈现出典型的半封建性。</p><p>另一方面，帝国主义列强通过<strong>政治的、经济的和文化的侵略</strong>，使中国半殖民地化。帝国主义列强通过武装入侵和强迫清政府签订一系列不平等条约，不但操纵了中国的财政和经济命脉，而且操纵了中国的政治和军事力量。中国实际上处在许多帝国主义国家的统治或半统治之下，长期处于不统一状态，加上幅员辽阔，土地广大，中国的经济政治和文化的发展，表现出极端的不平衡性，由于帝国主义和封建主义的双重压迫中国人民，尤其是广大农民日益贫困化以致大批破产，过着饥寒交迫和毫无政治权利的生活，中国人民的贫穷和不自由程度是当时世界少有的，整个中国实际上受制于帝国主义列强沦为帝国主义列强的半殖民地。</p><p>在半殖民地半封建的近代中国，社会矛盾呈现出错综复杂的状况。在诸多社会矛盾中占主导地位的<strong>主要矛盾</strong>是帝国主义和中华民族的矛盾，封建主义和人民大众的矛盾，而帝国主义和中华民族的矛盾又是各种矛盾中<strong>最主要的矛盾</strong>，这决定了近代中国革命的<strong>根本任务</strong>，是推翻帝国主义，封建主义和官僚资本主义的统治，从根本上推翻反动腐朽的政治上层建筑，变革阻碍生产力发展的生产关系，为建设富强民主的国家，确立人民当家作主的政治制度，改善人民生活，扫清障碍，创造必要的前提。</p><h3 id="近代中国革命的时代特征">近代中国革命的时代特征</h3><p>近代中国的社会性质和主要矛盾，决定了中国革命仍然是资产阶级民主革命，但中国资产阶级民主革命不同于一般的资产阶级民主革命，经历了从旧民主主义革命向新民主主义革命的转变，具有鲜明的时代特征。</p><p><strong>以俄国十月革命的胜利为标志，中国资产阶级民主革命的时代背景发生了根本转换</strong>。从鸦片战争到辛亥革命期间，中国人民在不同时期和不同程度上进行的反帝反封建斗争属于就是民主主义革命的范畴。俄国十月革命的胜利改变了整个世界历史的方向，划分了整个世界历史的时代，开辟了世界无产阶级社会主义革命的新纪元，<strong>标志着人类历史开始了由资本主义向社会主义转变的进程</strong>，十月革命不仅促进了西方资本主义国家无产阶级的觉醒，也促进了东方殖民地半殖民地国家被压迫民族和被压迫人民的觉醒，并且建立了一条从西方无产者经过俄国革命到东方被压迫民族的新的反对世界帝国主义的革命战线，使中国的资产阶级民主主义革命，从原来属于旧的世界资产阶级民主主义革命的范畴，属于<strong>旧的世界资产阶级民主主义革命的一部分</strong>，转变为属于新的资产阶级民主主义革命的范畴，属于<strong>世界无产阶级社会主义革命的一部分</strong>。</p><p><strong>以五四运动的爆发为标志，中国资产阶级民主革命进入新民主主义革命的崭新阶段</strong>。在十月革命的影响下，1919年，五四运动之后，中国无产阶级开始以独立的政治力量登上历史舞台，由<span class="bubble-content">自在阶级 </span><span class="bubble-notation"><span class="bubble-item" style="background-color:var(--asa-main);"> 作为自在阶级，无产阶级对资本主义社会的认识还处在感性阶段，没有认识到自己受剥削受压迫的真正原因(如归罪于机器)，没有觉悟到资本家和工人队伍之间的整个阶级对立，不了解自己的阶级地位和历史使命。斗争是分散的、自发的，仅限于经济要求。 </span></span>转变为<span class="bubble-content">自为的阶级</span><span class="bubble-notation"><span class="bubble-item" style="background-color:var(--asa-main);">作为自为阶级，无产阶级对资本主义社会的认识上升到理性阶段。认识到：工人受苦的根源是资本主义剥削制度，是整个资产阶级利用国家机器压迫整个无产阶级的结果;无产阶级是资本主义的掘墓人，肩负着消灭一切剥削阶级、解放全人类的历史使命;无产阶级要求得到解放，必须团结起来，进行有意识有组织的经济斗争、思想斗争和政治斗争。</span></span>，与之同时马克思主义在中国得到广泛传播，逐步成为中国革命的指导思想，以五四运动为开端，中国革命进入一个崭新的阶段，领导革命的是无产阶级指导革命的是<strong>马克思列宁主义革命的领导阶级和指导理论</strong>，都从根本上有别于旧式的资产阶级民主革命，不仅如此，这种民主主义革命和历史上欧美各国的民主革命也大不相同，它不是要建立资产阶级的共和国造成资产阶级专政，而是要<strong>造成各革命阶级在无产阶级领导之下的联合专政</strong>，建立各革命阶级联合专政的民主共和国，为进入社会主义社会做准备，但它和一般意义的社会主义革命也不相同，它只推翻帝国主义民主，封建主义和官僚资本主义的反动通知，而<strong>不破坏参加反帝反封建的资本主义成分</strong>，这样的民主主义革命不是旧范畴的民主主义革命，而是新民主主义革命。中国革命要分两步走，第1步是完成反帝反封建的新民主主义革命任务，第2步是完成社会主义革命任务，这是性质不同但又互相联系的两个革命过程。</p><h2 id="新民主主义革命的总路线（革命动力、性质）">新民主主义革命的总路线（革命动力、性质）</h2><h3 id="总路线">总路线</h3><p>总路线是相对于具体路线而言的根本指导路线，即无产阶级领导的，人民大众的，反对帝国主义、封建主义和官僚资本主义的革命。</p><h3 id="动力">动力</h3><p>新民主主义革命的动力包括无产阶级，农民阶级，城市小资产阶级和民族资产阶级。</p><p><strong>无产阶级是中国革命最基本的动力</strong>。无产阶级中国沦为半殖民地半封建社会过程中最早出现的一个新的社会阶级。他不但是伴随着中国民族工业的产生发展而产生的，而且是伴随着美国资本主义在中国直接经营企业而产生的。中国无产阶级是新的社会生产力的代表，是近代中国最进步的阶级，是中国革命的领导力量。</p><p><strong>农民是中国革命的主力军</strong>。其中的贫雇农是无产阶级最可靠的同盟军，中农是无产阶级可靠的同盟军。在半殖民地半封建的中国社会，农民占全国人口的80%以上，他们深受帝国主义封建主义和官僚资本主义的压迫和剥削，具有强烈的反帝反封建的革命要求，农民问题是中国革命的基本问题，新民主主义革命实质上就是党领导下的农民革命，中国革命战争实质上就是党领导下的农民战争。工人阶级只有与农民阶级结成巩固的联盟，才能形成强大的力量，才能完成反帝反封建的革命任务。工人阶级对农民的领导是实现革命领导权的基础，没有工人阶级及其政党的领导，农民的革命动力作用无法得到充分实现。</p><p><strong>城市小资产阶级是无产阶级的可靠同盟者</strong>。城市小资产阶级包括广大的知识分子，小商人，手工业者和自由职业者，同样受帝国主义封建主义和官僚资本主义的压迫，因此城市小资产阶级同样是中国革命的动力。</p><p><strong>民族资产阶级也是中国革命的动力之一</strong>。半殖民地半封建社会的民族，资产阶级是一个带有两面性的阶级，一方面，民族资产阶级既受帝国主义的压迫，又受封建主义的束缚，它同帝国主义和封建主义有矛盾，是革命的力量之一，另一方面由于它在经济上和政治上与帝国主义和封建主义有着千丝万缕的联系，没有彻底的反帝反封建的勇气，在革命的关键时刻表现出明显的动摇性。民族资产阶级的这种两重性决定了它在一定时期内和一定程度上能够参加反帝反封建的革命，而在另一时期又有跟在官僚资产阶级后面反对革命的危险，因此他既不可能充当革命的主要力量，更不可能是革命的领导力量，中国共产党对民族资产阶级在经济上实行保护，民族工商业的政策在政治上争取，他对其动摇性和妥协性进行批评和斗争，既斗争又联合，这是合乎实际的，是争取革命胜利的需要。</p><h3 id="性质">性质</h3><p>近代中国半殖民地，半封建社会的性质和中国革命的历史任务决定了中国革命的性质不是无产阶级社会主义革命，而是<strong>资产阶级民主主义革命</strong>。</p><p>新民主主义革命与旧民主主义革命相比，有新的内容和特点，集中表现在中国革命处于世界无产阶级社会主义革命的时代，是世界无产阶级社会主义革命的一部分，革命的领导力量是中国无产阶级及其先锋队 —— 中国共产党，根本的指导思想是马克思列宁主义，革命的前途是社会主义而不是资本主义。</p><p>新民主主义革命与社会主义革命性质不同，新民主主义革命仍然属于资产阶级民主主义革命的范畴，他推翻帝国主义，封建主义和官僚资本主义的发展，同时在政治上争取和联合民族资产阶级去反对共同的敌人，在经济上保护民族工商业，容许有利于国计民生的私人资本主义发展，它要建立的是无产阶级领导的，各革命阶级的联合专政，而不是无产阶级专政，社会主义革命是无产阶级性质的革命，它所要实现的目标是消灭资本主义剥削制度和改造小生产的私有制。</p><h2 id="新民主主义的基本纲领（重点经济）">新民主主义的基本纲领（重点经济）</h2><h3 id="政治纲领">政治纲领</h3><p>推翻帝国主义和封建主义的统治，建立一个无产阶级领导的，以工农联盟为基础的各革命阶级联合专政的新民主主义的共和国。</p><h3 id="经济纲领">经济纲领</h3><p>没收封建地主阶级的土地归农民所有，没收官僚资产阶级的垄断资本归新民主主义的国家所有，保护民族工商业。</p><p><strong>没收封建地主阶级的土地归农民所有，是新民主主义革命的主要内容</strong>。在半殖民地半封建的中国土地制度极不合理，要解放农村生产力，改变中国贫穷落后的面貌，必须废除封建地主土地所有制，进行土地革命，实行耕者有其田，以扫除封建的剥削关系，把土地变为农民的私产，发展农民的个体经济，解放农村生产力。党在民主革命时期逐步认识到土地革命的极端重要性，形成了土地革命路线，这就是依靠贫雇农，团结中农，有步骤、有分别地消灭封建剥削制度，发展农业生产。</p><p><strong>没收官僚资本归新民主主义国家所有，是新民主主义革命的题中应有之义</strong>。反对官僚资本主义并非因为它是资本主义，而是因为这种资本主义同外国帝国主义、本国地主阶级和旧式富农密切的结合着，是一种买办的封建的国家垄断资本主义，包含着新民主主义革命和社会主义革命的双重性质，通过没收官僚资本，建立起来的具有社会主义性质的国营经济，在新民主主义社会的多种经济成分中居于领导地位，为建立新民主主义的国家政权，实现向社会主义过渡奠定了坚实的基础。</p><p><strong>保护民族工商业是新民主主义经济纲领中极具特色的一项内容</strong>。在新民主主义条件下，保护民族工商业，发展资本主义是由中国落后的生产力和新民主主义革命的性质所决定的，新民主主义革命的对象是帝国主义封建主义和官僚资本主义，它不是一般的消灭资本主义和资产阶级，同官僚资产阶级相比，民族资产阶级与帝国主义和封建主义联系较少，民族资本主义经济是一种与新生产力相联系的先进的生产方式和经济成分，它对发展现代技术发展，社会生产力具有积极作用，因此对民族资本主义工商业必须采取保护政策。在新民主主义的国家制度下，让私人资本主义经济在不能操纵国计民生的范围内获得发展的便利，有益于社会向前发展，当然这种保护不是无条件的，需要保护和发展的资本主义是有利于而不是有害于国计民生的私人资本主义经济，是不能操纵国计民生的资本主义。</p><h3 id="文化纲领">文化纲领</h3><p>新民主主义文化就是无产阶级领导的人民，大众的，反帝反封建的文化，即民族的科学的和大众的文化。</p><h2 id="新民主主义革命的三大法宝及其内容">新民主主义革命的三大法宝及其内容</h2><h3 id="统一战线">统一战线</h3><p>统一战线是无产阶级及政党策略思想的重要内容。建立最广泛的统一战线首先是<strong>由中国半殖民地半封建社会的阶级状况所决定的</strong>。作为无产阶级先锋队的中国共产党所领导的革命力量要战胜作为地主阶级和官僚资产阶级集中代表的国民党所领导的强大的反革命力量，就必须把农民、城市小资产阶级及其他中间阶级都团结在自己的周围，结成最广泛的统一战线。</p><p>建立最广泛的统一战线，也是<strong>由中国革命的长期性、残酷性及其发展的不平衡所决定的</strong>。中国政治经济发展的不平衡性，也造成了革命发展的不平衡性，这就使得无产阶级及其政党有必要采取正确的统一战线的策略，把一切可以团结和利用的力量尽可能团结在自己的周围，以逐步从根本上改变极强我弱的态势，夺取中国革命的最终胜利。</p><p>在半殖民地半封建的中国社会，诸多矛盾交织在一起，客观上为无产阶级及政党利用这些矛盾建立和发展统一战线提供了可能性。近代中国社会最大的压迫是民族压迫，决定了无产阶级及其政党可以把一切爱国的不愿受敌国主义奴役的人们团结在自己的周围。民族资产阶级深受帝国主义和封建主义的压迫，因而能够在一定时期和一定程度上参加反帝反封建的革命斗争，当革命的锋芒主要是针对某一帝国主义的时候，受别的帝国主义支持的官僚资产阶级集团，也可能在一定程度上和一定的时期内参加统一战线。</p><p>新民主主义革命时期，中国共产党领导的统一战线先后经历了第一次国共合作的统一战线，工农民主统一战线，抗日民族统一战线，人民民主统一战线等几个时期，为新民主主义革命的胜利作出了重要的贡献，从总体上讲党领导的革命统一战线包含着两个联盟：一个是工人阶级同农民阶级，广大知识分子及其他劳动者的联盟，主要是<strong>工农联盟</strong>，另一个是工人阶级和非劳动人民的联盟，主要是<strong>与民族资产阶级的联盟</strong>，第一个联盟是统一战线的基础，只有巩固工农联盟，争取农民知识分子和其他劳动人民，才能实现党对统一战线的领导权，同时只有建立第二个联盟联合一切可以联系的力量，壮大自己，鼓励主要敌人，无产阶级及政党才能掌握中国革命的全部领导权，中国革命的胜利才有完全的保障。</p><p>总结党建立、巩固和发展统一战线的实践经验，主要在于这样几个方面，<strong>一是要建立巩固的工农联盟</strong>，<strong>二是要正确对待资产阶级</strong>，尤其是民族资产阶级，在革命斗争中要依据革命的需要，对资产阶级实行既联合又斗争的策略。联合民族资产阶级要针对其两面性特点，在联合的过程中，要在思想上，政治上和组织上进行必要的斗争，<strong>三是要采取区别对待的方针</strong>，在革命的进程中要坚持发展进步势力，争取中间势力，孤立顽固势力的策略方针，<strong>四是要坚持独立自主的原则</strong>，要保持党在政治上，组织上和思想上的独立性。</p><h3 id="武装斗争">武装斗争</h3><p>武装斗争是中国革命的特点和优点之一，与资本主义国家不同，在半殖民地半封建的旧中国，无产阶级和广大人民群众无议会民主可以利用，无组织工人举行罢工的合法权利，帝国主义和封建主义总是凭借着反革命暴力对革命人民实行残酷的镇压，革命人民只有武装起来，以武装的革命反对武装的反革命。中国革命的胜利主要是依靠中国共产党所领导的，与广大人民群众血肉相连的新型人民军队，通过长期人民战争战胜强大的敌人取得的，坚持武装斗争，必须建立一支人民军队，没有一支人民的军队，便没有人民的一切，就不可能有人民的解放和国家的独立。</p><p>总结党在新民主主义革命时期发展武装斗争的革命经验，建设人民军队，<strong>一要坚持党在军队的绝对领导</strong>，坚持党对军队的绝对领导，是建设新型人民军队的根本原则，是保持人民军队无产阶级性质和建军宗旨的根本前提，也是毛泽东建军思想的核心。<strong>二要建设全心全意为人民服务的人民军队</strong>，人民军队必须以全心全意为人民服务为唯一宗旨，坚持这一宗旨是建设新型人民军队的根本前提，也是人民军队一切行动的根本准则和一切工作的出发点与归宿。它集中体现了人民军队的本质，是人民军队立于不败之地的根本所在，<strong>三要坚持正确的战略战术原则</strong>，由于中国革命战争长期处于地强我弱的特殊历史条件下，面对无论在数量上还是装备上都占绝对优势的强大敌人，党在加强人民军队建设的同时，在深入研究中国革命战争的特点和规律的基础上，形成了一整套以少生多以强生以弱胜强的人民战争的理论和一系列的战略战术原则，加强人民军队建设，要以科学的理论为指南，坚持正确的战略战术原则。</p><h3 id="党的建设">党的建设</h3><p>中国共产党要领导革命取得胜利，必须不断加强党的思想建设，组织建设和作风建设，半殖民地半封建的中国是一个以农民为主体的国度，无产阶级人数很少，农民和其他小资产阶级占人格的大多数，农民和小镇一起出身的，党员占多数，各种非无产阶级思想，特别是小资产阶级思想，必然反应到党内来，党内无产阶级思想和非共产阶级阶级思想之间的矛盾成为党内思想上的主要矛盾。加之党长期在农村发展，且处于战争环境之中，如果不加强党的组织建设，作风建设，党就会组织松散，软弱涣散，不可能成为坚强有力的战斗堡垒，不可能具有优良的作风，更不可能赢得人民群众的支持，并取得革命胜利，这些情况决定了要建成一个广大群众性的马克思主义的无产阶级政党是一件艰巨的任务，必须不断的结合革命形式和的发展，需需要加强党的建设。</p><p>中国共产党在加强自身建设中积累了丰富的经验，归纳起来主要有：第一，<strong>必须把思想建设始终放在党的建设的首位</strong>，加强党的思想建设，关键是以要以无产阶级思想克服和改造各种非物沉的思想。第二，<strong>必须在任何时候都重视党的组织建设</strong>，加强党的组织建设根本的是要贯彻民主集中制这一根本组织原则坚持在民主基础上的集中和在集中指导下的民主相结合，个人服从组织，少数服从多数，下级服从上级，全党服从中央。第三，<strong>必须重视党的作风建设</strong>，党在领导新民主主义革命的过程中，把党的建设作为一项伟大的工程，逐步形成了理论联系实际，密切联系群众，批评与自我批评相结合的三大优良作风，是中国共产党区别于其他任何政党的显著标志。第四，<strong>必须坚持党的政治路线加强党的建设</strong>。党的政治路线是党的纲领，在一定历史时期的具体体现，是完成党在一定历史阶段的政治任务的总政策，为全党的团结统一奠定政治基础，加强党的建设，必须同党的政治路线紧密联系起来，在贯彻执行党的政治纲领和路线中推进党的建设</p><hr><h1 id="社会主义改造理论">社会主义改造理论</h1><h2 id="为什么说新民主主义社会是一个过渡性的社会">为什么说新民主主义社会是一个过渡性的社会</h2><p>从中华人民共和国成立到社会主义改造基本完成，是我国从新民主主义到社会主义的过渡时期，这一时期我国社会的性质是新民主主义社会，新民主主义社会不是一个独立的社会形态，而是由新民主主义向社会主义转变的过渡性社会形态。在新民主主义社会中存在着5种经济成分，即社会主义性质的国营经济，半社会主义性质的合作社经济，农民和手工业者的个体经济，私人资本主义经济和国家资本主义经济，主要经济成分是三种：社会经济，个体经济和资本主义经济。与三种基本经济成分及与之联系的三种基本阶级力量之间的矛盾，就集中表现为社会主义和资本主义两条道路，工人阶级和资本阶级两个阶级的矛盾，随着土地改革的基本完成，工人阶级和政界的矛盾逐步成为我国社会的主要矛盾。</p><p>在新民主主义社会中，社会主义的因素不论在经济上还是在政治上，都已经居于领导地位，但非社会主义因素仍有很大比重，社会主义因素居于领导地位，加上当时有利于发展社会主义的国际条件，决定了社会主义因素将不断增长并获得最终胜利，非社会主义因素将不断受到限制和改造。新民主主义社会是属于社会主义体系的，是逐步过渡到社会主义社会的过渡性质的社会。</p><h2 id="农业的社会主义改造">农业的社会主义改造</h2><p>**第一，积极引导农民组织起来，走互助合作道路。**土地改革完成后，我国广大农民的生产积极性大大提高，这种积极性表现在两个方面，一是个体经济的积极性，二是互助合作的积极性，党中央正确分析了农民这两方面的积极性，提出一方面不能挫伤个体经营的积极性，另一方面要提倡组织起来发展互助合作的积极性，在土地改革完成后，党不失时机的引导农民，走互助合作道路，受到农民的拥护和支持。</p><p><strong>第二，遵循自愿互利，典型示范和国家帮助的原则，以互助合作的优越性，吸引农民走互助合作道路</strong>。农民既是私有者又是劳动者，对农民不能采取剥夺的办法，只能引导说服和教育，使其自愿地走合作化道路。</p><p><strong>第三，正确分析农村的阶段和阶层状况，制定正确的阶级政策</strong>。土地改革后，贫农，雇农由于分得了土地等生产资料，有半数人迅速上升为中农，根据中农在生产中的地位生活状况和对社会主义的态度，毛泽东把中农分为上中农和下中农，贫农和下中农一起占农村人口的60%~70%，是党在农村的依靠力量，从而解决了在农村依靠农民大多数和建立无产阶级优势的问题。在此基础上，党制定并贯彻执行了依靠贫下中农，发展互助合作，由逐步限制到最后消灭富农剥削的农村阶级政策，这使农业合作发展有了坚实的阶级基础和群众基础。</p><p><strong>第四，坚持积极领导、稳步前进的方针，采取循序渐进的步骤</strong>。农业社会主义改造，大体上经历了互助组、初级社和高级社三个发展阶段。第一阶段主要是发展互助组，同时试办初级组，互助组有几户或十几户农民志愿组成，土地耕畜和其他生产资料仍归农民个人所有，但在生产方面组织起来互帮互助，具有社会主义萌芽性质，第二阶段主要是建立初级农业生产合作社，初级社以土地入股和统一经营为特点，实行集体劳动产品分配，采取按劳分配和土地分股，分入股分红相结合，耕畜和大农具也付给一定的报酬，具有半社会主义性质，第三阶段是发展高级社，高级社实行生产资料，农民集体所有，按劳付酬，取消土地分红，具有完全的社会主义性质，到1956年底农业社会主义改造基本完成。</p><h2 id="资本主义工商业的社会主义改造">资本主义工商业的社会主义改造</h2><p><strong>第一，用和平赎买的方法改造资本主义工商业</strong>。无产阶级掌握国家政权后，“剥夺剥夺者”，使被资本家占有的生产资料变为人民的财产，这是社会主义革命的一个基本原则，中国共产党根据马克思、恩格斯和列宁关于采用和平方式变革所有制的设想，结合中国的具体情况，提出了对资本主义工商业实行和平赎买的方针，所谓赎买就是国家有偿地将私营企业改变为国营企业，将资本主义私有制改变为社会主义公有制，赎买的具体方式不是由国家支付一笔巨额补偿资金，而是让资本家在一定年限内从企业经营所得中获得一部分利润。</p><p>对资本主义工商业实行和平赎买，<strong>有利于</strong>发挥私营工商业在国计民生方面的积极作用，促进国民经济发展，<strong>有利于</strong>争取和团结民族资产阶级，<strong>有利于</strong>团结各民主党派和各界爱国民主人士，巩固和发展统一战线，<strong>有利于</strong>发挥民族资产阶级中大多数人的知识才能，技术专长和管理经验，<strong>也有利于</strong>争取和团结那些原来同资产阶级相联系的知识分子为社会主义建设服务。</p><p>我国之所以能够采取赎买的方式，对资本主义工商业进行和平改造，原因是多方面的。首先民族资产阶级有两面性，在社会主义革命时期，民族资产阶级既有剥削工人取得利润的一面，又有拥护宪法，愿意接受社会主义改造的一面，我国工人阶级和民族资产阶级之间存在着的剥削和被剥削的对抗性矛盾。其次中国共产党与民族资产阶级长期保持着统一战线的关系，这就为将工人阶级的一些存在着的对抗性矛盾转化为非对抗性矛盾，并按照人民内部矛盾来处理提供了前提。最后我国已经有了以工人阶级为领导共同联盟为基础的人民民主专政的国家政权，建立了强大的社会主义国营经济并掌握了国家的经济命脉，这又造成了私人资本主义在政治上、经济上对社会主义的依赖，再加上当时国家对粮食和工业原料的统购统销以及资本主义企业中工人群众对资本家的监督等因素，就使私人资本主义企业只能接受社会主义改造。</p><p><strong>第二，采取从低级到高级的国家资本主义的过渡形式</strong>。所谓国家资本主义就是在国家直接控制和支配下的资本主义经济，我国社会主义改造中出现的国家资本主义经济，是在人民政府管理之下的，用各种形式和国营社会主义经济联系着的并受工人监督的资本主义经济，这种资本主义经济已经不再是普通的资本主义经济，而是一种特殊的资本主义经济，即新式的国家资本主义经济，它主要地不是为了资本家的利益而存在，而是为了供应人民和国家的需要而存在，因此这种新式的国家资本主义经济是带着很大的社会主义性质的，是对工人和国家有利的。国家资本主义有初级形式和高级形式之分。初级形式的国家资本主义是国家对私营工商业实行委托加工、计划订货、统购报销、经销代销等，高级形式的国家资本主义是公私合营，包括个别企业的公私合营和全行业的公私合营。</p><p>对资本主义工商业的社会主义改造经历了三个步骤，<strong>第一步主要实行初级形式的国家资本主义</strong>。国家在私营工业中实行委托加工、计划订货、统购包销，在私营商业中采取委托经销、代销等形式，既帮助私营企业克服困难，也使其生产和经营开始纳入国家计划的轨道，这些企业的利润按国家所得税、企业公积金、工人福利费、资方红利这4个方面进行分配，即当时所说的&quot;四马分肥&quot;。资方红利大体占1/4，资本主义的剥削受到限制，工人在企业中的地位也发生了变化，这就使企业具体有了社会主义的因素。<strong>第二步主要实行个别企业的公私合营</strong>。国家向私营企业投资入股，企业的生产资料由国家和资本家共同所有企业的利润的分配分仍为四马分肥，国家派干部进入企业内部，根据国家建设需要同工人资本家共同管理和改造企业，公方代表居领导地位，资本家的剥削进一步受到限制，企业的经营管理与发展生产满足人民需要和完成国家计划为目标，因为已经属于半社会主义性质的企业。<strong>第三步是实行全行业的公私合营</strong>。1956年全行业公司合营进入高潮，年底全国私营工业户数的99%和私营商业户数的82%分别纳入了公司合营或合作社的轨道，这标志国家对资本主义工商业的社会主义改造以基本完成，全行业公司合营后，国家对合营企业进行清产核资、定息定股，委托委派人员负责企业的生产经营管理，统一调配企业的人财物，生产资料为国家所有，全行业公私合营后企业的生产关系已经发展了根本的变化，基本上成为社会主义国营性质的企业。</p><p><strong>第三，把资本主义工商业者改造成为自食其力的社会主义劳动者</strong>。在资本主义工商业的社会主义改造中，国家对资方在职人员和资方代理人采取包下来的政策，以企业为基地，根据&quot;量才适用，适当照顾&quot;的原则，对他们在政治上适当安排工作上发挥作用，生活上妥善照顾，通过改造阶级成分的方式达到从整体上消灭资产阶级的目的，对企业的改造和对人的改造相结合，改造资本家个人与消灭它们所属的资产阶级相结合，既避免了激烈的阶级对抗，减少了改造的阻力，又推动了生产力的发展和社会的进步。</p><h2 id="社会主义基本制度的确立及其重大意义">社会主义基本制度的确立及其重大意义</h2><ul><li>极大的提高了工人阶级和广大劳动人民的积极性、创造性，极大的促进了我国社会生产力的发展；</li><li>社会主义基本制度的确立，使广大劳动人民真正成为国家的主人，这是中国几千年来阶级关系的最根本变革；</li><li>它进一步改变了世界政治经济格局，增强了社会主义的力量，为维护世界和平产生了积极影响；</li><li>他不仅再次证明了马克思列宁主义的真理性，而且以其独创性的理论原则和经验，总结丰富和发展了科学社会主义理论。</li></ul><hr><h1 id="社会主义建设道路初步探索的理论成果">社会主义建设道路初步探索的理论成果</h1><h2 id="调动一切积极因素为社会主义事业服务的思想">调动一切积极因素为社会主义事业服务的思想</h2><p>《论十大关系》初步总结了我国社会主义建设的经验，明确提出&quot;要以苏为鉴，独立自主的探索适合中国情况的社会主义建设道路&quot;，为社会主义建设服务。确立了一个基本方针，就是努力把党内党外，国内国外的一切积极的因素，直接的、间接的积极因素全部调动起来。其中前三条讲重工业和轻工业农业的关系。</p><p>调动一切积极因素为社会主义事业服务，必须坚持中国共产党的领导，必须发展社会主义民主政治，有一个如何认识社会主义发展阶段和社会主义建设规律的问题。</p><h2 id="正确认识和处理社会主义社会矛盾的思想">正确认识和处理社会主义社会矛盾的思想</h2><p>《关于正确处理人民内部矛盾的问题》系统论述了社会主义社会矛盾的理论。</p><p>在社会主义社会中，基本的矛盾仍然是生产关系和生产力之间的矛盾，上层建筑和经济基础之间的矛盾，是在人民根本利益一致基础上的矛盾。它可以经过社会主义制度本身不断地得到解决。社会主义社会基本矛盾运动具有&quot;又相适应又相矛盾&quot;的特点，一方面社会主义生产关系，已经建立起来，它是和生产力的发展相适应的，另一方面他还很不完善，这些不完善的方面和生产力的发展又是相矛盾的。</p><h2 id="走中国工业化道路的思想">走中国工业化道路的思想</h2><p>毛泽东提出了以农业为基础，以工业为主导，以农轻重为序发展国民经济的政策。</p><p>走中国工业化道路，必须明确<span class="bubble-content">战略目标</span><span class="bubble-notation"><span class="bubble-item" style="background-color:var(--asa-main);">毛泽东提出社会主义现代化的战略目标是要把中国建设成为一个具有现代农业，现代工业现代国防和现代科学技术的强国</span></span>和<span class="bubble-content">战略步骤</span><span class="bubble-notation"><span class="bubble-item" style="background-color:var(--asa-main);">三届全国人大一次会议提出两步走的发展战略，第一步建成一个独立的比较完整的工业体系和国民经济体系，第二步全面实现工业、农业、国防和科学技术现代化，使中国走在世界前列</span></span>，必须采取正确的<span class="bubble-content">经济建设方针</span><span class="bubble-notation"><span class="bubble-item" style="background-color:var(--asa-main);">党的八大提出了既反保守又反冒进，在综合平衡中稳步前进的方针</span></span>，必须发展科学技术和文化教育，必须重视知识分子工作，必须调整和完善所有制结构，必须积极探索适合我国情况的经济体制和运动机制和运行机制。</p><h2 id="初步探索的意义（理论、现实、背景）">初步探索的意义（理论、现实、背景）</h2><ol><li><p>巩固和发展了我国的社会主义制度</p><p>社会主义制度建立以后，如何巩固和发展这一制度是我们党必须认真研究和解决的一个重大课题。作为一种崭新的更高形态的社会制度，社会主义制度的建立极大地激发了广大人民群众的建设热情和积极性。但是，我国人口多、底子薄、经济文化比较落后，社会主义建设的任务艰巨繁重。国际上，以美国为首的西方国家对中国采取轻视政策，并进行封锁和遏制，企图颠覆社会主义制度。面对严峻服务的国内外形式，党带领全国人民，坚持独立自主、自力更生，开始了大规模的社会主义建设，在经济、政治、文化等各方面都取得了重大成就。这些成就的取得，体现了社会主义制度的优越性，增强了广大人民群众走社会主义道路的信心，社会主义制度也在实践中得到发展。</p></li><li><p>为开创中国特色社会主义提供了宝贵经验、理论准备、物质基础。</p><p>在全面建设社会主义时期，党对社会主义建设道路的探索历经艰辛，积累了丰富的经验，也留下了深刻的教训。无论是成功的经验还是失误的教训，正确的加以总结，都是党的宝贵财富，为改革开放新时期中国特色社会主义的开创和发展提供了重要的思想资源。在探索中形成的一些正确的和比较正确的思想观点，取得的独创性理论成果，尤其是关于社会主义建设的正确的理论原则和经验总结，丰富和发展了毛泽东思想，对我国社会主义建设发挥了重要指导作用，为开启新时期新道路奠定了重要的思想基础。在这一探索过程中，我国经济保持了较快的发展速度，经济实力显著增强；基本建立了独立的比较完整的工业体系和国民经历体系，从根本上解决了工业化&quot;从无到有&quot;的问题。改革开放以后我国来意进行现代化建设的物质技术基础，很大一部分是这一时期建设起来的；全国经济文化建设等方面的骨干力量和他们的工作经验，大部分也是在这一时期培养和积累起来的。这一时期的建设成就为开启新时期新道路奠定了重要的物质基础。</p></li><li><p>丰富了科学社会主义的理论和实践。</p></li></ol><hr><h1 id="邓小平理论">邓小平理论</h1><h2 id="邓小平理论形成的时代背景和历史根据">邓小平理论形成的时代背景和历史根据</h2><h3 id="时代背景">时代背景</h3><p><strong>和平与发展成为时代主题是邓小平理论形成的时代背景</strong>。20世纪70年代，西方资本主义遭遇严重的经济危机，战后美苏两极对抗的冷战格局，出现重大变化，两大阵营的力量对比更趋平衡，尽管局部战争仍有发生，但短时期内爆发世界大战的可能性越来越小，长期被冷战阴云笼罩的世界各国人民对和平的渴望更加强烈，新科技革命推动下的经济社会快速发展，使各国人民更加珍惜发展的机遇，求发展的愿望更加强烈，求和平谋发展，逐渐成为世界各国人民的普遍愿望，邓小平敏锐地把握了国际形势的重大变化，对时代主题的转换作出了科学判断。</p><h3 id="历史根据">历史根据</h3><p>**社会主义建设的经验教训是邓小平理论形成的历史根据。**新中国成立后，我们顺利的恢复了国民经济，走出了一条具有鲜明中国特色的社会主义改造道路，1956年随着苏共二十大的召开和波匈事件的发生，苏联模式的弊端逐步暴露出来，我们在第一个五年计划的实践中也察觉到这个模式的弊端，毛泽东随即提出要以苏为鉴，总结我们自己的经验，探索自己的建设社会主义的道路。在这个探索中形成的一些正确的和比较正确的理论观点方面，政策和实践经验，这些思想理论成果的产生是我们党和国家的一份珍贵的思想财富，对于邓小平理论的形成和发展具有重要意义。但这一时期我们也犯了不少错误，走了不少弯路，这主要是在成绩上急于求成，盲目求纯和急于过渡，在政治上坚持以阶级斗争为纲，造成这些失误的更深层的原因，一是偏离了党的实事求是的思想路线，对国际国内的形势，对我国社会主义时期的主要矛盾和中国现实的具体国情做出了错误的估量和判断，二是对什么是社会主义和如何建设社会主义的问题，没有完全搞清楚，因而也就不可能集中精力发展生产力，也不可能对社会主义的某些制度和体制进行有效的改革，我国社会主义建设经历的曲折和失误，特别是文化大革命给党国家和各族人民带来的严重灾难，促使中国共产党人和中国人民进行深刻的反思，十一届三中全会以后，以邓小平为主要代表的中国共产党人领导，全党和全国人民果断的纠正了这些错误，深刻的分析了他出现的原因，同时又坚决的维护和继承了过去，在理论上和实践上所取得的一切积极成果。</p><h2 id="邓小平理论的形成过程">邓小平理论的形成过程</h2><ul><li>1978年12月召开的党的十一届三中全会，重新确立了&quot;解放思想，实事求是&quot;的思想路线，停止使用以阶级斗争为纲的错误提法，确定把全党工作的着重点转移，到社会主义现代化建设上来，作出实行改革开放的重大决策，实现了党的历史上具有深远意义的伟大转折</li><li>1984年党的十二届三中全会作出了《关于教育体制改革的决定》，提出了社会主义经济是公有制基础上的有计划的商品经济</li><li>1987年召开的党的十三大，第一次比较系统地论述了我国社会主义初级阶段理论，明确概括和全面阐发了党的&quot;一个中心，两个基本点&quot;的基本路线，从马克思主义哲学、政治经济学和科学社会主义等方面，第一次对中国特色社会主义理论主要内容做了系统概括</li><li>1992年邓小平南方谈话针对人们思想中普遍存在的疑虑，重申了深化改革加速发展的重要性和必要性，并从中国实际出发，站在时代的高度深刻的总结了10多年改革开放的经验教训，在一系列重大的理论和实验问题上提出了一系列重要论断</li><li>1992年召开党的十四大，系统总结了改革开放以来14年取得的巨大成就</li><li>1997年召开的党的十五大正式提出&quot;邓小平理论&quot;这一概念，深刻阐述了邓小平理论的历史地位和指导意义，进一步论述了邓小平对这一理论的创立作出的独创性贡献</li></ul><h2 id="邓小平理论回答的基本问题">邓小平理论回答的基本问题</h2><p>基本问题：什么是社会主义？怎样建设社会主义？</p><ol><li>社会主义的本质是解放生产力发展生产力消灭剥削消除，两极分化，最终达到共同富裕</li><li>四项基本原则：坚持社会主义基本制度，坚持以公有制为基础，实行按劳分配原则的社会主义基本经济制度，坚持共产党领导实行人民民主专政的社会主义基本政治制度，坚持以马克思列宁主义、毛泽东思想为指导的社会主义意识形态</li></ol><h2 id="邓小平理论的主要内容">邓小平理论的主要内容</h2><ul><li>解放思想，实事求是的思想路线。有力地推动和保证了改革开放的进行，体现了辩证唯物主义和历史唯物主义的世界观，方法论体现了革命感略和科学精神的统一，是邓小平理论的活的灵魂，是邓小平理论的精髓</li><li>社会主义初级阶段理论。社会主义初级阶段的论断包括两层含义，第一，我国已经进入社会主义社会，必须坚持，而不能离开社会主义。第二，我国的社会主义社会还处在不发达的阶段，必须正视，而不能超越初级阶段。理论使我们对社会主义建设的长期性，复杂性，艰巨性，有了更加清醒的认识，是中国国情的准确把握，揭示了当代中国的历史方位是建设中国特色社会主义的总依据，是对马克思主义关于社会主义发展阶段理论的重大发展和重大突破</li><li>党的基本路线。党的十三大报告提出的党在社会主义初级阶段的基本路线：领导和团结全国各族人民以经济建设为中心，坚持4项基本原则，坚持改革开放，自力更生，艰苦创业，为把我国建设成为富强民主文明的社会主义现代化国家而奋斗</li><li>社会主义根本任务的理论。生产力是社会发展的最根本的决定因素，社会主义的根本任务是发展生产力，社会主义革命是为了解放生产力，发展生产力</li><li>三步走战略。第1步从1981年到1990年，实现国民生产总值比1980年翻一番，解决人民的温饱问题；第2步从1991年到20世纪末，使国民生产总值再翻一番，达到小康水平；第3步到21世纪中叶国民生产总值再翻两番，达到中等发达国家水平，基本实现现代化</li><li>改革开放理论，社会主义市场经济理论，两手抓两手都要硬一手，一手抓物质文明，一手抓精神文明；一手抓改革开放，一手抓惩治腐败；一手抓建设一手抓法治，一国两制，中国的问题关键在于党</li></ul><h2 id="邓小平理论的历史地位">邓小平理论的历史地位</h2><ul><li><strong>马克思列宁主义、毛泽东思想的继承和发展</strong>。邓小平理论坚持解放思想，实事求是在新的实践基础上继承前人又突破陈规，开拓了马克思主义的新境界</li><li><strong>中国特色社会主义理论体系的开篇之作</strong>。邓小平作为中国特色社会主义理论的创立者，紧紧抓住什么是社会主义，怎样建设社会主义这个基本问题响亮提出走自己的道路，建设有中国特色的社会主义的伟大号召，从此中国特色社会主义成为我们党全部理论和实践意义贯彻的主题</li><li><strong>改革开放和社会主义现代化建设的科学指南</strong>。邓小平理论使改革开放后的中国发生翻天覆地的变化，迎来了思想的解放，经济的发展，正确的昌明，教育的博兴，文艺的繁荣，科学的春天</li></ul><hr><h1 id="三个代表-重要思想">&quot;三个代表&quot;重要思想</h1><h2 id="三个代表-重要思想的核心观点">&quot;三个代表&quot;重要思想的核心观点</h2><p>始终代表中国先进生产力的发展要求，始终代表中国先进文化的前进方向，始终代表中国最广大人民的根本利益</p><h2 id="三个代表-重要思想的主要内容">&quot;三个代表&quot;重要思想的主要内容</h2><ul><li><strong>发展是党执政兴国的第一要务</strong>，江泽民强调无论国际国内形势如何，无论遇到什么样的困难，只要正确坚持和贯彻发展的思想，我们就能够从容应对挑战，克服困难不断前进</li><li><strong>建立社会主义市场经济体制</strong>，必须坚持和完善公有制为主体多种所有制经济共同发展的社会主义经济制度</li><li><strong>全面建设小康社会</strong>，江泽民提出21世纪头20年是全面建设小康社会的阶段，形成了两个100年的奋斗目标，全面建设小康社会是实现现代化建设第3步战略目标必经的承上启下的发展阶段，也是完善社会主义市场经济体制和扩大对外开放的关键阶段</li><li><strong>建设社会主义政治文明</strong>，建设社会主义政治文明最根本就是要坚持党的领导，人民当家作主和依法治国的有机统一</li><li><strong>推进党的建设新的伟大工程</strong>，坚持党的领导，核心是坚持党的先进性</li></ul><hr><h1 id="科学发展观">科学发展观</h1><h2 id="科学发展观的科学内涵（第一要义、核心立场、集中概括）">科学发展观的科学内涵（第一要义、核心立场、集中概括）</h2><p>科学发展观，第一要义是（推动经济社会）发展，核心立场是以人为本，基本要求是全面协调可持续，根本方法是统筹兼顾，这是对科学发展观的集中概括</p><ul><li>以人为本的根本含义就是坚持全心全意为人民服务，立党为公，执政为民，始终把最广大人民的根本利益作为党和国家工作的根本出发点和落脚点，坚持尊重社会发展规律与尊重人民历史主体地位的一致性，坚持为崇高理想奋斗未与为最广大人民谋利益的一致性，坚持完成党的各项工作与实现人民利益的一致性，坚持发展为了人民，发展依靠人民，发展成果由人民共享</li><li>坚持以人为本就要坚持发展为了人民始终把最广大人民的根本利益放在第一位；就要坚持发展依靠人民，从人民群众的伟大创造中汲取智慧和力量；就要坚持发展成果由人民共享，着力提高人民物质文化生活水平；最终是为了实现人的全面发展</li></ul><h2 id="科学发展观的历史地位（尤其是同邓小平理论、三个代表的关系）">科学发展观的历史地位（尤其是同邓小平理论、三个代表的关系）</h2><ul><li><strong>中国特色社会主义理论体系的继续发展</strong>。科学发展观同邓小平理论三个代表重要思想，面对着共同的时代课题，面临着共同的历史任务，都贯穿了中国特色，社会主义这个主题都坚持辩证唯物主义和历史唯物主义的世界观，方法论，都坚持党的最高纲领和最低纲领的统一，都坚持代表最广大人民的根本利益，在理论主题思想基础政治理想根本立场上，一以贯之科学发展观，在邓小平理论和三个代表重要思想的基础上，用一系列具有鲜明时代特点的新思想，新观点，新论断，进一步回答了什么是社会主义怎样建设社会主义和建设什么样的党，怎样建设党的问题，创造性的回答了新形势下实现什么样的发展，怎样发展，等重大问题形成了涵盖改革发展稳定，内政外交国防，治国治党。治军各方面的系统科学理论实现了我们党在指导思想上的又一次与时俱进，开辟了当代中国马克思主义发展新境界。科学发展观是对邓小平理论思想代表重要思想的创造性发展，把中国特色社会主义理论体系推进到新境界，赋予当代中国马克思主义勃勃生机</li><li>发展中国特色社会主义必须长期坚持的指导思想</li></ul>]]></content>
      
      
      <categories>
          
          <category> 刨根问底 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>单词忍者——简约优雅的背单词软件开发报告</title>
      <link href="/529b1168/"/>
      <url>/529b1168/</url>
      
        <content type="html"><![CDATA[<h1 id="需求分析">需求分析</h1><p>英语作为一门全球通用的语言，深受人们的重视，现在有很多地方从幼儿园就开始学习英语。对于很多人来说，学习英语是一个非常困难的事情，而背单词APP的开发可以让用户利用碎片化的时间随时随地学习英语单词，打破了传统学习对时间和场地的限制，可以更好的提高大家的学习效率。</p><p>同时个人喜简约流，所以打算开发一个简约但功能强大的背单词软件。</p><hr><h1 id="功能分析">功能分析</h1><p>刚拿到这个项目时我还是比较迷茫的，因为这是我第一次开发项目，而且还是独自一人，只能咬着牙关艰难前行。于是我首先分析了市场上主流的背单词软件的优缺点。</p><h2 id="百词斩">百词斩</h2><p>百词斩是我高中就被老师推荐使用了。这款软件在注册时会根据用户的自身情况来推荐词库，非常个性化。同时，他还有一个很有意思的功能。在背单词时会推出单词的一个例句，然后给用户四个图片，让用户选择符合单词汉意的图片，也就是所谓的图形记忆法。这个功能很有创新。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230110231528063.png" alt="百词斩优点"></p><p>但是，他也有缺点。首先广告非常讨厌，影响用户心情。他的图形记忆法同时也是缺点。他提供的图片单一，很难包括单词的所有含义，有一定的局限性。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230110231615899.png" alt="百词斩缺点"></p><h2 id="扇贝单词">扇贝单词</h2><p>扇贝单词的界面很清新，尤其是启动界面会展现一张美图和一句优美的英语句子，很有感觉。同时，他的学习数据非常明确，“新单词数”、“复习单词数”、“未学单词数”都清晰提示着用户。</p><p>令人遗憾的是，他的部分功能需要会员，往往会使像我这种不想氪金的用户望而却步。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230110231653403.png" alt="扇贝单词分析"></p><p>通过这一系列的分析，我对于软件功能有了大致了解。我总结出单词背诵有几种模式：</p><ul><li><p>背诵模式1：通过发音回想单词——听力时的需求</p></li><li><p>背诵模式2：只提供单词（记单词卡模式），通过单词回忆单词汉意——做阅读题时的需求</p></li><li><p>背诵模式3：只提供汉意，通过汉意回想单词——写作文时的需求</p></li><li><p>背诵模式4：单词部分字母缺失，补全单词——词汇量进阶</p></li><li><p>背诵模式5：通过图片记忆单词——增加趣味性</p></li></ul><p>除了背诵功能外，还应有多用户登录系统来满足不同用户的使用。</p><hr><h1 id="系统设计">系统设计</h1><p>我把这款软件取名为“单词忍者”。这个名字启发于“水果忍者”，我希望用户在使用我这款软件时，想玩水果忍者一样快刀斩乱麻，在苦涩的英语学习过程中也有些许快乐与轻松。</p><p>具体系统操作过程如下所示。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230110231730425.png" alt="image-20230110231730425"></p><hr><h1 id="功能实现">功能实现</h1><ul><li><p>界面显示是使用的EasyX的图形库头文件，界面图片需要用PS制作图片（共26张）。</p></li><li><p>接受用户的输入信息使用了InputBox和MessageBox函数。</p></li><li><p>用户信息的储存和词库的储存使用了ini文件，该文件可以通过“键-节”来便捷的访问“值”。</p></li><li><p>同时增加了两个结构体用来储存用户信息以及单词信息。</p></li><li><p>编码方式为Unicode，它是宽字符的一种，是EsayX所必须的，它有很好的可移植性，便于不同地区的学习。但它也有个缺点就是一般编码方式的函数不能正常使用，需要转换，不利于新手小白使用。</p></li></ul><hr><h1 id="软件截图">软件截图</h1><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/welcome.png" alt="welcome"></p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/first_interface.png" alt="first_interface"></p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/recitemenu.png" alt="recitemenu"></p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230110232700753.png" alt="image-20230110232700753"></p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/exit.png" alt="exit"></p><hr><h1 id="特色亮点">特色亮点</h1><p>这个项目在开发出来以后，我还是比较满意的，它有以下亮点：</p><ol><li>添加bgm，增强沉浸感</li><li>鼠标交互，方便快捷</li><li>美女真人发音，宅男福利</li><li>功能强大，三大背诵功能任你选</li><li>界面精美</li><li>纯净无广告</li></ol>]]></content>
      
      
      <categories>
          
          <category> 项目报告 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目开发 </tag>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>我宣布个事，利用概率密度函数奇偶性速求分布函数</title>
      <link href="/b599e018/"/>
      <url>/b599e018/</url>
      
        <content type="html"><![CDATA[<p><em>做到随机信号的一道题，发现有一个很意思的解法，就是使用PDF的一个性质</em></p><h2 id="PDF性质">PDF性质</h2><p>若概率密度函数是偶函数，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>F</mi><mo stretchy="false">(</mo><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">F(x)+F(-x) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>。</p><h2 id="证明">证明</h2><p>没有搜到性质的证明，所以我来自己证明下。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>∵</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext>为偶函数</mtext><mspace linebreak="newline"></mspace><mo>∴</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>F</mi><mo stretchy="false">(</mo><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi>x</mi></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi><mo>+</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mrow><mo>−</mo><mi>x</mi></mrow></msubsup><mi>f</mi><mo stretchy="false">(</mo><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mo stretchy="false">(</mo><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi>x</mi></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi><mo>+</mo><msubsup><mo>∫</mo><mi>x</mi><mi mathvariant="normal">∞</mi></msubsup><mi>f</mi><mo stretchy="false">(</mo><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\because f(x)为偶函数 \\\therefore f(x) = f(-x)\\\begin{split} F(x)+F(-x) &amp;= \int_{-\infty}^{x}f(x)dx+\int_{-\infty}^{-x}f(-x)d(-x)\\ &amp;= \int_{-\infty}^xf(x)dx+\int_x^{\infty}f(-x)dx\\ &amp;= \int_{-\infty}^{\infty}f(x)dx\\ &amp; = 1 \end{split}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6922em;"></span><span class="mrel amsrm">∵</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord cjk_fallback">为偶函数</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.6922em;"></span><span class="mrel amsrm">∴</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:9.6607em;vertical-align:-4.5803em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.0803em;"><span style="top:-7.0803em;"><span class="pstrut" style="height:3.5212em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-4.3958em;"><span class="pstrut" style="height:3.5212em;"></span><span class="mord"></span></span><span style="top:-1.7112em;"><span class="pstrut" style="height:3.5212em;"></span><span class="mord"></span></span><span style="top:0.3991em;"><span class="pstrut" style="height:3.5212em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.5803em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.0803em;"><span style="top:-7.0803em;"><span class="pstrut" style="height:3.5212em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5212em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-4.3958em;"><span class="pstrut" style="height:3.5212em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span><span style="top:-1.7112em;"><span class="pstrut" style="height:3.5212em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span><span style="top:0.3991em;"><span class="pstrut" style="height:3.5212em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.5803em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h2 id="应用">应用</h2><blockquote><p>设随机变量X的概率密度函数为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><mo fence="true">∣</mo><mi>x</mi><mo fence="true">∣</mo></mrow></mrow></msup></mrow><annotation encoding="application/x-tex">f(x) = e^{-\left | x \right | }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">∣</span></span><span class="mord mathnormal mtight">x</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">∣</span></span></span></span></span></span></span></span></span></span></span></span></span></span>，求其分布函数。</p></blockquote><p>答：当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x&lt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>时，</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi>x</mi></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi>x</mi></msubsup><msup><mi>e</mi><mi>x</mi></msup><mi>d</mi><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}F(x) &amp;= \int_{-\infty}^xf(x)dx\\&amp;= \int_{-\infty}^xe^xdx\\&amp;=e^x\end{split}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.8691em;vertical-align:-3.1846em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6846em;"><span style="top:-5.6846em;"><span class="pstrut" style="height:3.4143em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3.4143em;"></span><span class="mord"></span></span><span style="top:-0.8897em;"><span class="pstrut" style="height:3.4143em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1846em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6846em;"><span style="top:-5.6846em;"><span class="pstrut" style="height:3.4143em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3.4143em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span><span style="top:-0.8897em;"><span class="pstrut" style="height:3.4143em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1846em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>时，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>x</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">-x&lt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>，因为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext>为</mtext></mrow><annotation encoding="application/x-tex">f(x)为</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord cjk_fallback">为</span></span></span></span>偶函数，因此可得：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mi>F</mi><mo stretchy="false">(</mo><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}F(x) &amp;= 1-F(-x)\\&amp;= 1- e^{-x}\\\end{split}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>因为分布函数为右连续，因此得到：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mi>e</mi><mi>x</mi></msup><mo separator="true">,</mo><mi>x</mi><mo>&lt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup><mo separator="true">,</mo><mi>x</mi><mo>≥</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">f(x)=\left\{\begin{matrix}  &amp;e^x,x&lt;0\\  &amp;1-e^{-x},x\ge0\end{matrix}\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.45em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>]]></content>
      
      
      <categories>
          
          <category> 广开门路 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
            <tag> 数学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysql鉴权方式转换方法，auth_sockt方式与用户模式</title>
      <link href="/30d59510/"/>
      <url>/30d59510/</url>
      
        <content type="html"><![CDATA[<h2 id="使用auth-sockt插件">使用auth_sockt插件</h2><h3 id="转换方法">转换方法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> auth_socket;</span><br></pre></td></tr></table></figure><h3 id="检查更改">检查更改</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">user</span>,authentication_string,plugin,host <span class="keyword">FROM</span> mysql.user;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/asa-pic/pic_1/img/image-20221007235135599.png" alt="检查鉴权"></p><h3 id="auth-sockt方式说明">auth_sockt方式说明</h3><ul><li><p>这种验证方式不要求输入密码，只需要输入sudo mysql即可进入mysql服务</p></li><li><p>安全特点：</p><ul><li><p>只能用 UNIX 的 socket 方式登陆，这就保证了只能本地登陆，用户在使用这种登陆方式时已经通过了操作系统的安全验证</p></li><li><p>操作系统的用户和 MySQL 数据库的用户名必须一致，例如要登陆 MySQL 的 root 用户，必须用操作系统的 root 用户登陆</p></li></ul></li></ul><h2 id="使用用户密码登录">使用用户密码登录</h2><h3 id="转换方法-2">转换方法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;YOUR_PASS_WORD&#x27;</span>;</span><br></pre></td></tr></table></figure><p><code>YOUR_PASS_WORD</code> 处应该输入设置mysql时的root密码。</p><h3 id="检查更改-2">检查更改</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">user</span>,authentication_string,plugin,host <span class="keyword">FROM</span> mysql.user;</span><br></pre></td></tr></table></figure><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232247138.png" alt="检查鉴权"></p><h3 id="该方式说明">该方式说明</h3><ul><li>进入mysql时需输入<code>mysql -u root -p </code>，回车后，输入前面设置的<code>YOUR_PASS_WORD</code>即可</li><li>当我们在系统投产后，操作系统的 root 用户和 MySQL 的 root 用户就不能随便使用时可以改为这种方式</li></ul>]]></content>
      
      
      <categories>
          
          <category> 广开门路 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ubuntu </tag>
            
            <tag> 教程 </tag>
            
            <tag> 数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于CycleGAN的图像风格迁移模型设计与创业策划（下）</title>
      <link href="/66af7779/"/>
      <url>/66af7779/</url>
      
        <content type="html"><![CDATA[<h1 id="融资情况">融资情况</h1><h2 id="融资与资金应用">融资与资金应用</h2><p>在公司不同的发展阶段，采用不同的筹资方式：</p><table><thead><tr><th><strong>成长阶段</strong></th><th><strong>筹措方式</strong></th></tr></thead><tbody><tr><td><strong>初创期</strong></td><td>创业团队自筹资金，吸纳种子投资和天使投资</td></tr><tr><td><strong>成长期</strong></td><td>内部融资、吸引合作企业投资、吸收风险投资</td></tr><tr><td><strong>成熟期</strong></td><td>债务融资、IPO  上市进入资本市场融资</td></tr></tbody></table><p>公司拟在2021年年底成立，计划在天使轮融资达500万元。在公司成立初期，融资将用于市场宣传开拓、渠道对接会、新产品开发测试以及房屋租赁等方面。成长期和成熟期，公司的规模逐渐扩大，将加大研发力度。同时，公司的人力、办公设备等用于公司正常经营的资金也会逐渐增加。</p><h2 id="未来收益预测">未来收益预测</h2><p>破晓科技计划从 2021 年底开始正式推出产品，预计在五年内将基本覆盖全国市场。公司的主打产品为图像风格大师、个性化风格迁移定制服务。分别解决个体及团体的巨大需求。根据我们的预测，五年内累计营业收入超过 3320万元，净利润超过1694万元。公司未来五年销售产品服务的收入与各成本情况如下表（单位：万元）所示：</p><table><thead><tr><th><strong>项目</strong></th><th><strong>2021</strong></th><th><strong>2022</strong></th><th><strong>2023</strong></th><th><strong>2024</strong></th><th><strong>2025</strong></th></tr></thead><tbody><tr><td><strong>营业收入</strong></td><td>210.00</td><td>336.00</td><td>537.60</td><td>860.16</td><td>1376.26</td></tr><tr><td><strong>营业成本</strong></td><td>28.00</td><td>44.43</td><td>61.53</td><td>93.66</td><td>145.27</td></tr><tr><td><strong>税金及附加</strong></td><td>13.23</td><td>21.17</td><td>33.87</td><td>54.19</td><td>86.70</td></tr><tr><td><strong>销售费用</strong></td><td>18.90</td><td>36.96</td><td>48.92</td><td>67.09</td><td>122.49</td></tr><tr><td><strong>管理费用</strong></td><td>27.30</td><td>42.00</td><td>72.58</td><td>120.42</td><td>173.41</td></tr><tr><td><strong>财务费用</strong></td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td></tr><tr><td><strong>利润总额</strong></td><td>125.37</td><td>195.89</td><td>326.86</td><td>534.16</td><td>862.91</td></tr><tr><td><strong>所得税费用</strong></td><td>31.34</td><td>48.97</td><td>81.72</td><td>133.54</td><td>215.73</td></tr><tr><td><strong>税后净利润</strong></td><td>94.03</td><td>146.92</td><td>245.15</td><td>400.62</td><td>647.18</td></tr><tr><td><strong>净资产</strong></td><td>426.09</td><td>565.36</td><td>786.83</td><td>1148.09</td><td>1763.43</td></tr><tr><td><strong>净资产收益率</strong></td><td>22.07%</td><td>25.99%</td><td>31.16%</td><td>34.89%</td><td>36.70%</td></tr></tbody></table><p>在不同应用领域的预测收益（单位：万元）如下：</p><table><thead><tr><th><strong>应用领域</strong></th><th><strong>2020</strong></th><th><strong>2021</strong></th><th><strong>2022</strong></th><th><strong>2023</strong></th><th><strong>2024</strong></th></tr></thead><tbody><tr><td><strong>游戏制作</strong></td><td>94.50</td><td>201.60</td><td>252.67</td><td>412.88</td><td>633.08</td></tr><tr><td><strong>社交自媒体</strong></td><td>52.50</td><td>94.08</td><td>139.78</td><td>206.44</td><td>330.30</td></tr><tr><td><strong>社会安防</strong></td><td>31.50</td><td>50.40</td><td>75.26</td><td>129.02</td><td>233.96</td></tr><tr><td><strong>城市规划</strong></td><td>31.50</td><td>40.32</td><td>69.89</td><td>111.82</td><td>178.91</td></tr></tbody></table><h2 id="经营分析">经营分析</h2><h3 id="盈亏平衡分析">盈亏平衡分析</h3><p>通过对本项目固定成本和变动成本的计算进行盈亏平衡分析，可以确定出项目要求的最低销售水平。将公司的预测销售水平与项目要求的最低销售水平对比可以得出公司预测销售水平的可变动幅度，从而可知公司的安全性高低。</p><table><thead><tr><th><strong>年份</strong></th><th><strong>2021</strong></th><th><strong>2022</strong></th><th><strong>2023</strong></th><th><strong>2024</strong></th><th><strong>2025</strong></th></tr></thead><tbody><tr><td><strong>预计销售量（单位：万份）</strong></td><td>18.90</td><td>40.32</td><td>50.53</td><td>82.58</td><td>126.62</td></tr><tr><td><strong>预计销售额（单位：万元）</strong></td><td>94.50</td><td>201.60</td><td>252.67</td><td>412.88</td><td>633.08</td></tr><tr><td><strong>盈亏平衡点销售量（单位：万份）</strong></td><td>4.56</td><td>9.88</td><td>10.27</td><td>15.64</td><td>23.02</td></tr><tr><td><strong>盈亏平衡点销售额（单位：万元）</strong></td><td>22.79</td><td>49.38</td><td>51.37</td><td>78.19</td><td>115.11</td></tr></tbody></table><p>由上面盈亏平衡分析表可知，每一年的预计销售额远远高于盈亏平衡点销售额， 预计销售量也远远高于盈亏平衡点销售量，这表明公司经营的安全系数较高。随着公司业务和规模的扩大，存在成本边际递减效应，单位成本呈现下降的趋势。随着公司占据的市场份额的增加，可实现的利润空间也会越来越大。</p><p>社交自媒体、社会安防、城市规划领域的盈亏平衡如下：</p><table><thead><tr><th><strong>年份</strong></th><th><strong>2021</strong></th><th><strong>2022</strong></th><th><strong>2023</strong></th><th><strong>2024</strong></th><th><strong>2025</strong></th></tr></thead><tbody><tr><td><strong>社交自媒体预计销售额（单位：万元）</strong></td><td>52.50</td><td>94.08</td><td>139.78</td><td>206.44</td><td>330.30</td></tr><tr><td><strong>社交自媒体盈亏平衡点销售额（单位：万元）</strong></td><td>12.66</td><td>23.04</td><td>28.42</td><td>39.09</td><td>60.05</td></tr><tr><td><strong>社会安防预计销售额（单位：万元）</strong></td><td>31.50</td><td>50.40</td><td>75.26</td><td>129.02</td><td>233.96</td></tr><tr><td><strong>社会安防盈亏平衡点销售额（单位：万元）</strong></td><td>7.60</td><td>12.34</td><td>15.30</td><td>24.43</td><td>42.54</td></tr><tr><td><strong>城市规划预计销售额（单位：万元）</strong></td><td>31.50</td><td>40.32</td><td>69.89</td><td>111.82</td><td>178.91</td></tr><tr><td><strong>城市规划盈亏平衡点销售额（单位：万元）</strong></td><td>7.60</td><td>9.87</td><td>14.21</td><td>21.18</td><td>32.53</td></tr></tbody></table><h2 id="财务报表与财务分析">财务报表与财务分析</h2><h3 id="财务预算假设">财务预算假设</h3><p>（一）预算编制说明</p><p>本预算报告是公司本着谨慎性原则，结合市场需求和业务拓展计划，在公司的预算基础上，按合并报表的要求,依据2014-2020年国内主要游戏运营商运营计划、Vlog自媒体市场规模行情、国内视频监控存储市场以及中国城市规划建设行业市场业务进展情况进行编制。本预算报告的编制基础是:假设公司签订的供销合同、游戏运营计划、Vlog自媒体运营、城市安防监控升级业务、城市规划建设业务规划均能按时按计划履行。</p><p>本预算报告在总结分析2014-2020年经营形势的基础上结合公司发展战略,充分考虑了金融危机、疫情影响、市场开拓、销售价格、汇率、互联网等因素对预算期的影响。本预算报告包括母公司、下属全资子公司及下属控股子公司。</p><p>（二）基本假设</p><ol><li>公司所遵循的国家和地方的现行有关法律、法规和制度无重大变化;</li><li>公司主要经营所在地及业务涉及地区的社会经济环境无重大变化;</li><li>公司所处行业形势及市场行情无重大变化;</li><li>公司2021年度销售的产品涉及的市场无重大变动;</li><li>公司主要产品和原料的市场价格和供求关系不会有重大变化;</li><li>公司生产经营业务涉及的信贷利率、税收政策以及外汇市场汇价将在正常范围内波动;</li><li>公司现行的生产组织结构无重大变化,计划的投资项目能如期完成并投入生产;</li><li>无其他不可抗力及不可预见因素对本公司造成的重大不利影响。</li></ol><p>（三）预算编制依据</p><ol><li><p>公司2021年营业收入的主要目标：公司预计2021年度实现营业收入210万元。</p></li><li><p>根据《公司法》的相关规定计提法定盈余公积比例为 10%；</p></li><li><p>依据国家税法及其相关条例，公司上缴税费项目和比例为：</p><ul><li>增值税：税率为 13%；</li><li>城市维护建设税：税率 7%，以应缴增值税税额为计税依据；</li><li>教育费附加：税率 3%，以应缴增值税税额为计税依据；</li><li>地方教育附加：税率 2%，以应缴增值税税额为计税依据；</li><li>企业所得税：税率 25%。</li></ul></li><li><p>公司主要业务收入为图像风格大师个体会员制收费以及个性化风格迁移定制服务。公司预计将于2021年末成立并投入运营。</p></li></ol><h3 id="利润表">利润表</h3><table><thead><tr><th><strong>项目</strong></th><th><strong>2020</strong></th><th><strong>2021</strong></th><th><strong>2022</strong></th><th><strong>2023</strong></th><th><strong>2024</strong></th><th><strong>2025</strong></th></tr></thead><tbody><tr><td><strong>营业收入</strong></td><td>0.00</td><td>210.00</td><td>336.00</td><td>537.60</td><td>860.16</td><td>1376.26</td></tr><tr><td><strong>营业成本</strong></td><td>5.58</td><td>25.20</td><td>39.98</td><td>55.37</td><td>84.30</td><td>130.74</td></tr><tr><td><strong>税金及附加</strong></td><td>0.01</td><td>13.23</td><td>21.17</td><td>33.87</td><td>54.19</td><td>86.70</td></tr><tr><td><strong>销售费用</strong></td><td>3.49</td><td>18.90</td><td>36.96</td><td>48.92</td><td>67.09</td><td>122.49</td></tr><tr><td><strong>管理费用</strong></td><td>4.40</td><td>27.30</td><td>42.00</td><td>72.58</td><td>120.42</td><td>173.41</td></tr><tr><td><strong>财务费用</strong></td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td></tr><tr><td><strong>利润总额</strong></td><td>-13.48</td><td>125.37</td><td>195.89</td><td>326.86</td><td>534.16</td><td>862.92</td></tr><tr><td><strong>所得税费用</strong></td><td>0.00</td><td>31.34</td><td>48.97</td><td>81.72</td><td>133.54</td><td>215.73</td></tr><tr><td><strong>税后净利润</strong></td><td>-13.48</td><td>94.03</td><td>146.92</td><td>245.15</td><td>400.62</td><td>647.19</td></tr></tbody></table><h2 id="风险资金退出">风险资金退出</h2><p>参考其他公司的风险资本退出方式，公司在决策时考虑了公司运营是否良好、是否满足 IPO 条件、是否有上市公司愿意定向增发、未来投资报酬率会不会低于 预算值、是否找有股东满意的收购者等多个因素。</p><p>公司会以最负责的态度对待投资者，将会根据实际情况，选择最适合的风险资本退出方式。风险资金退出时我们遵循的原则是：一方面保障天使投资者的利益，使天使投资者在资金退出时能获取最大收益。另一方面要注重公司的稳定性， 选择能促进公司发展的风险资金退出方式。</p><p>一般来说，风险资本退出的方式有创业板上市、上市公司定向增发、向第三者转让、管理层收购、创业者回购股份及清算六种可能，下面结合公司不同时期经营情况分别进行说明。</p><h3 id="当公司运营良好时">当公司运营良好时</h3><p><strong>（1）创业板公开上市</strong></p><p>结合目前破晓科技公司的战略规划，公司计划在未来五六年间完成公开上市（IPO），这是最适合的风险资本退出方式，在帮助风险资本退出，保障风险投资商的利益的同时，也提升自身的知名度和融资水平，实现公司自身的发展。</p><p>当公司发展到一定规模时，我们将争取在中国股市的创业板上市（IPO）， 申请公开发行股票，以筹集更多的资金。届时风险投资公司可通过出售其掌握的股份而收回投资，风险投资实现成功退出。这种方式让风险投资者的投资收益最高， 华南脑控将获得大量现金流入，增强流动性，提高风险企业的知名度和公司形象， 还能激励拥有原始股权的员工，留住优秀人才。</p><p><strong>（2）上市公司定向增发</strong></p><p>由于破晓科技的产品市场前景广阔，需求量巨大，运用市场后将会获得较高的盈利水平，这必将引起国内外相关企业的关注。如果投资者把公司出售，市场上相关企业由于本公司与其竞争，对其构成威胁，他们出于自身利益的考虑，极有可能买下本公司。而由同行业上市公司对本公司进行定向增发，可以使得公司实现要素资本市场化，这是在公司不能进行 IPO 的情况下最好的选择。</p><p><strong>（3）向第三者转让</strong></p><p>在五年后的任何时间，如果有一个难得的出售股份的机遇，且价格水平符合风险投资公司的要求，风险投资公司也可利用这一机遇，在保证该价格水准的前提下，把所拥有的权益转卖第三方。</p><p><strong>（4）管理层收购</strong></p><p>如果五年后条件不成熟而未能上市， 投资机构有权利要求管理层收购（MBO）。管理层收购（MBO）具体来说，就是由企业管理层发动，组建一个外部投资人集团，通过投资银行、信托等金融机构的支持，收购原来公开上市或非上市的企业的股票和资产，使它转变为管理层控制的企业，保证最低收益。</p><p><strong>（5）创业者回购股份</strong></p><p>从 2020 年开始，如果投资者的年投资报酬率低于期望值，风险投资公司可以要求创业队或其它股东买回其全部股权。</p><h3 id="当公司运营不佳时">当公司运营不佳时</h3><p>当公司运营不良，被依法宣告破产时，按照有关法律规定，组织有关部门、中介机构人员成立破产管理人，对公司进行破产清算，这是风险投资不成功时减少损失的最佳退出方式。</p><hr><h1 id="公司架构">公司架构</h1><h2 id="公司组织架构">公司组织架构</h2><h3 id="公司发展第一阶段（1-5年）">公司发展第一阶段（1-5年）</h3><p>公司发展第一阶段，公司将采用创业型组织结构模式，企业的管理者对若干下属实施直接控制，并由其下属执行一系列的工作任务。此结构虽然较为简单，但是在创业初期能够实现较高的工作执行效率。随着公司的发展壮大，将逐步向职能制组织结构进行转变，公司进一步将职权和责任分派给专门单元进行管理。具体如下图所示。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103220640344.png" alt="公司发展第一阶段组织架构（1-5年）"></p><h3 id="公司发展第二阶段（5-10年）">公司发展第二阶段（5-10年）</h3><p>在公司的快速成长阶段，要实现向全国市场全面推开公司业务，要求市场部具有很强的市场推广、产品销售能力及良好的售后服务。因此，市场部进一步划分为市场部、销售部、客户部，各司其职。</p><p>市场部负责拟定市场开发计划和市场推广计划；调查并收集市场信息；市场分析与预测；制定营销、产品、形象等企划案，与销售部、客户部共同实施等。</p><p>销售部围绕公司下达的销售目标拟定营销方针和策略计划，负责产品的销售工作；组织产品的发送以及受理退货等。</p><p>客户部负责收集客户信息；整理客户问题，反馈到销售部、技术部等相关部门；建立客户信息数据库，形成客户资料的信息化管理等。</p><h3 id="部门职责">部门职责</h3><table><thead><tr><th><strong>部门</strong></th><th><strong>主要职责</strong></th></tr></thead><tbody><tr><td><strong>董事会</strong></td><td>决定公司的发展战略及基本政策；  决定公司高层管理人员的任命；  针对总经理做出的战略计划等，行使表决通过权。</td></tr><tr><td><strong>技术部</strong></td><td>协助总经理进行决策和处理日常事务  对IoT设备的软件、硬件研究开发  针对平台对接的研究开发  对平台的功能进行测试，排除平台存在的漏洞  为技术人员制定培训计划；  对客户提供相应的培训和技术支持</td></tr><tr><td><strong>产品市场部</strong></td><td>全力做好市场开发与市场调研工作，帮助实现公司销售目标。</td></tr><tr><td><strong>销售支持部</strong></td><td>全力负责公司销售工作，完成公司销售目标。</td></tr><tr><td><strong>市场宣传部</strong></td><td>建立与客户的良好合作关系，为公司销售目标的实现提供帮助。</td></tr><tr><td><strong>财务部</strong></td><td>进行财务预测、计划、控制、分析和检查；拟定并执行公司各项财务管理和会计核算制度；编制财务报表和年度财务报告；财务预算，成本控制。</td></tr><tr><td><strong>人力资源部</strong></td><td>负责制定公司人事劳动工作的规章制度并监督执行；  负责公司人员的招聘、培训、考核，并进行工资核算；  处理办公室事务，收集处理各种数据信息与收发文件；  统筹管理公司安全保卫、清洁卫生等后勤事物。</td></tr></tbody></table><h2 id="成员构成">成员构成</h2><h3 id="成员背景">成员背景</h3><p>本项目团队成员主要来自于电子科技大学信息与通信工程学院及电子科技大学计算机视觉与机器智能实验室。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103220735195.png" alt="电子科技大学计算机视觉与机器智能实验室"></p><p>计算机视觉与机器智能实验室依托于电子科技大学信息与通信工程学院，科研工作主要涉及智能识别与视觉感知的基础理论研究与应用技术开发，研究方向包括：图像处理与模式识别，视觉目标检测、跟踪与识别，计算机视觉，智能视频监控与场景理解，智能人机交互，三维场景信息分析与处理，视觉测量，多源遥感图像融合与信息挖掘，图像采集、压缩与传输，数字视频编解码和多媒体技术等。</p><p>2007年以来，实验室在信号与信息处理学科下，围绕图像处理、机器学习、计算机视觉与机器智能等热点研究方向，以国家973计划项目子课题、国家自然科学基金、四川省科技计划等二十余项科研项目以及多项企业横向项目为支持，在计算机视觉、流形学习、深度学习、人脸检测与识别、人体动作识别、人体行为分析、行人检测与跟踪及再识别、智能视频监控与场景理解、遥感图像智能分析与识别、信息融合、医学图像处理等相关方向进行了深入的探索。在IEEE Trans、ISPRS、Radar Conference等国际知名期刊、会议发表学术论文一百多篇。</p><p>实验室理念为持之以恒地追求一流学术，立足行业及领域需求实现应用技术开发并积极寻求由影响力的企业建立特定行业的产学研合作。目前实验室师资配置为教授2名，副教授1名，高级工程师1名。同时共有研究生37名(博士生7名，硕士生30名)。</p><h3 id="指导老师介绍">指导老师介绍</h3><table><thead><tr><th><strong>成员</strong></th><th><strong>职务</strong></th><th><strong>个人简介</strong></th><th><strong>职责</strong></th></tr></thead><tbody><tr><td><strong>程建</strong></td><td>高校  指导老师</td><td>电子科技大学信息与通信工程学院教授、博导，计算机视觉与机器智能实验室负责人。现主要研究方向为：图像处理与模式识别、计算机视觉、流形学习、深度学习、人脸检测与识别、人体动作识别、人体行为分析与活动识别、智能视频监控与场景理解、遥感图像智能分析与识别、信息融合、机器视觉及工业应用等。在国内外重要学术期刊和学术会议上发表学术论文100多篇，其中SCI收录30多篇，EI收录80多篇；申请国家发明专利40多项，其中获得国家发明专利授权10多项。主持承担国家973计划项目子课题1项、国家自然科学基金项目2项、中国博士后科学基金项目1项、中国博士后科学基金特别资助项目1项、四川省科技计划项目1项、教育部博士点基金项目1项、国家重点实验室开放基金2项、中央高校基本科研业务费项目2项、电子科技大学青年教师科技基金重点项目1项、企业横向合作项目6项；参与国家973计划项目子课题1项、国防863计划项目2项。</td><td>为公司战略规划、定位和管理提供建议和意见，</td></tr><tr><td><strong>刘欣刚</strong></td><td>高校  指导老师</td><td>电子科技大学电子工程学院教授、信息与通信工程学院教授，电子科技大学信号与信息处理专业博士生导师，国际化人才，2009年获韩国岭南大学情报通信学部博士学位。其研究领域多与多媒体信号处理及通信相关，主要包括复杂环境下人脸/人体行为识别，高性能视频编解码，视频错误掩盖，图像质量评估，模式判决等。近年来以第一作者/通信作者的身份在相关研究方向的国际杂志、学术会议上发表了近百篇SCI、EI 检索的学术文章。主持科技部重点研发、国家自然基金、四川省基础研究重点等20余项纵向、横向项目。作为大会主席、程序主席等参与了如IEEE CSE、IEEE CIT等二十余个IEEE 国际学会的主办工作。受邀担任多个如JWCN、MTAP 等具有国际影响力的学术杂志的特邀编辑。</td><td>监督项目的总体运行与推进，指导项目开发；协助监督项目一级编制，二级计划审批及执行监督、考核和管理。</td></tr></tbody></table><h2 id="人力资源管理">人力资源管理</h2><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103220822717.png" alt="人力资源规划图"></p><p>公司现处于十分关键的业务拓展阶段，且在移动互联网的动态环境中，必须要有大量人才来支撑整个扩张的事业版图。人力资源必须紧跟随公司的发展战略目标，明确公司的业务发展对人力资源的数量、质量和结构的需求。结合组织自身的优势和不足，及时给公司引进优秀的人才，并加以培训与激励，让他们能最大限度地发挥自己的潜能，实现自己的价值，与公司共同成长。</p><p>人力资源管理一般可从公司的战略目标出发，分为职位管理、招聘选拔和绩效考核三条主线，系统性地对人力资源进行管理和开发，为公司的健康可持续发展提供人员的有力支撑。</p><p>随着公司的发展，人员将会持续增长，公司的组织架构也会随之调整，各个部门不断扩大，在五年中期会将综合部拆分为财务部、人力资源部、行政部三个部门分工合作，使工作分配更加清晰，完成度更高。</p><h3 id="人员招聘">人员招聘</h3><p>公司根据企业的发展战略，人才供给与需求的情况等，制定企业的人员招聘计划并由人力资源部进行实施。每年年底，公司会根据下年的发展计划和经营目标、本年度员工的流动率，由人力资源部组织，其他部门协助，制定下一年全年的人员招聘计划。人员招聘将本着公平、公正的原则，杜绝出现任人唯亲的情况，公司目前的招聘渠道主要通过校园招聘、内部招聘和外部招聘。</p><h3 id="企业人力资源开发体系">企业人力资源开发体系</h3><p>破晓公司的人力资源开发体系主要面对企业的高层管理者，企业将会邀请名牌高校的管理学院的教授来企业进行指导和专业培训；委派参加各种商业活动，使其有机会与各种商业上的知名人士进行交流和学习；对于有潜力的年轻管理者，将公费给其到名牌高校或国外进行进修学习。</p><p>破晓公司的人力资源开发体系也面对公司内部管理者，委派他们去参加各类管理或者技术方面的讲座以及交流会；邀请知名管理人员或者资深的技术人员来企业为高层管理者做讲座；与高校合作建立科研基地，在与高校的合作下不断提高技术和产品。</p><h3 id="绩效管理">绩效管理</h3><p>破晓公司将根据工作性质的不同建立一个完整的体系，不仅考评员工行为结果，而且发挥战略的导向作用，使员工的个人行为与企业战略相契合，更好地促进战略目标的实现，使员工不仅关心自己的绩效结果，同时更关注组织战略的实施。</p><p>绩效目标体系从公司战略分析开始，到公司业务重点与体系，层层落实到岗位，从而建立起了基于公司战略的组织目标责任体系。基于战略的绩效目标体系要得以落实，公司需要建立完善的绩效管理制度，使员工评价具有公平性，合理性，保证部门与公司目标的达成。</p><h2 id="公司CIS设计">公司CIS设计</h2><p>CIS 是运用统一的视觉识别设计来传达企业特有的经营理念和活动，从而提升和突出同一化企业形象，使企业形成自己内在独特的个性，最终增强企业整体竞争力。其中包括，理念识别与Logo设计。</p><p>通过对这三方面的全面阐述，我们将华南脑控的经营理念与精神文化整体系统传达给企业内部与社会大众，并使其对企业产生一致的认同感。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103220937979.png" alt="公司Logo"></p><h3 id="理念识别">理念识别</h3><p>企业理念是指企业在长期生产经营过程中所形成的企业共同认可和遵守的价值准则和文化观念，以及由企业价值准则和文化观念决定的企业经营方向、经营思想和经营战略目标。</p><p>对于我们拟成立的破晓公司，我们希望能够将我们公司的经营理念与精神文化整体系统传达给企业用户与社会大众，并使其对企业产生一致的认同感。</p><p>公司使命：做世风格迁移的领导者与普及者。作为风格迁移应用智能多模态源技术及核心算法提供商，一直致力于用公司自主研发的AI技术来造福企业，为大众提供个性化服务。</p><h3 id="公司核心价值观">公司核心价值观</h3><p>科技创新：技术优势是破晓的支撑，而科技创新是破晓的根本。</p><p>创造价值：我们将始终坚持科学研究并致力于将“产学研”结合，为社会所用，创造更大的社会价值，为了人类生活的便利与进步不断前进。</p><p>以人为本：坚持以人为本，企业为员工筑造温暖的家，员工才会与企业“同呼吸，共命运”。</p><h3 id="企业Logo">企业Logo</h3><p>企业理念破晓的logo由“破晓”两个大字组成，为毛笔字所铸，笔锋强有力，代表的是我们公司的朝气，同时这也寓示着公司将团结一心为了未来不断奋斗。企业理念识别是 CIS 基本精神所在，是企业灵魂的核心，是企业识别系统和企业生存发展的原动力，企业信奉的价值观也由此而确立，经由这股内蕴的动力，影响企业的动态、活力制度、组织管理与教育，并扩及对社会公益活动，消费者的参与行为之规划，最后经由组织化、系统化、统一化视觉识别计划，传达企业经营的信息，塑造企业独特的形象，达到识别的目的。</p><hr><h1 id="风险识别与管理对策">风险识别与管理对策</h1><h2 id="风险识别">风险识别</h2><p>在当今这个新时代，尤其是处于后疫情时代的企业面临着许多不确定的风险因素，一个企业必须具备提前识别风险并制定管理对策的能力，方可在未来的市场竞争中获得先天性优势并立足于不败之地。本节将从战略风险、财务风险、市场风险、运营风险、法律风险五个方面对破晓公司在未来可能面对的风险进行分析，并为接下来管理对策的制定做好准备。</p><h3 id="风险分类">风险分类</h3><p>结合我公司的自身优势、战略定位、发展目标以及发展过程中可能遇到的风险，我们将风险因素做出以下分类。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103221002694.png" alt="风险项目"></p><h3 id="风险描述">风险描述</h3><p>战略风险、财务风险、市场风险、运营风险、法律风险的具体表现如下：</p><table><thead><tr><th>风险明细</th><th>风险描述</th></tr></thead><tbody><tr><td>国家政策风险</td><td>与本公司相关的国家宏观经济政策、国家产业政策、知识产权等方面的政策会极大地影响公司的运营，为我公司的企业融资、市场供需关系、人事招聘带来巨大的风险。</td></tr><tr><td>技术风险</td><td>在公司的建立初期和开拓市场的过程中出现技术上的重大问题，或者是同行业公司出现了更占优势的风格迁移技术。作为高新技术企业，我公司面临的最大风险就是技术风险。</td></tr><tr><td>产业风险</td><td>来自其他产业的纵向竞争，使得整个产业的发展态势受到严重影响。或是互补产业出现问题，比如游戏行业发展势态低迷，我公司自然会受到影响。</td></tr><tr><td>负债  风险</td><td>对我公司偿还债务的能力进行了错误的估计，使得负债过多，对我公司向上发展带来了巨大的压力。</td></tr><tr><td>资金周转风险</td><td>采用了错误的预测方法，或者是对数据处理的模型出现错误，使得决策应收账款、销售收入的比重以及资金周转率出现时出现失误，以至于资金难以周转。</td></tr><tr><td>竞争风险</td><td>来自同行业的技术上、人才储备上、供求资源等方面的激烈竞争。尤其是公司刚建立的初期，需要面对美图秀秀等大型公司的竞争，生存压力较大。</td></tr><tr><td>经济  风险</td><td>经济周期风险（尤其是当下疫情的冲击），各种汇率、利率的变动，为我公司贷款、企业融资带来巨大的不确定性。同时还有通货膨胀、通货紧缩，影响消费者的购买力，这些都对我公司产生不可估计的影响。</td></tr><tr><td>信用  风险</td><td>对主要客户和主要供应商的信用情况产生了错误的判断，导致我公司遭受巨大损失。</td></tr><tr><td>转型风险</td><td>在运营公司时，对我公司转型的方向、时间节点、转型速度的判断产生重大失误，导致转型失败，给我公司带来巨大打击。</td></tr><tr><td>管理  风险</td><td>企业组织效能低下、缺乏合适的评价和激励标准、管理层缺乏管理经验等管理风险都会让我公司在内部出现危机。</td></tr><tr><td>自然风险</td><td>包括但不限于疫情、火灾、台风、地震等天灾人祸，尤其是在后疫情时代，疫情防控形势严峻，为我公司带来了巨大的挑战。</td></tr><tr><td>知识产权  风险</td><td>专利产权风险、相关技术或权益被侵犯、公司产品被竞争对手模仿等等，这都是我公司可能面临的知识产权风险。</td></tr><tr><td>合同协议风险</td><td>与对接的游戏公司等互补企业签订的合同协议在边界上可能存在模糊或者合同内容本身存在歧义，会为两公司的业务对接甚至是我公司发展产生恶劣影响。</td></tr><tr><td>员工道德  风险</td><td>所任用的员工不能遵守法律法规或者是道德约束，将重要技术泄露给竞争公司，将会为我公司带来不可挽回的损失。</td></tr></tbody></table><p>对于以上风险，我们做出的风险评估如下：</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103221030239.png" alt="风险评估"></p><p>通过以上各类风险的评估我们可以知道，对我公司未来发展影响较大的风险因素有管理风险、产业风险、竞争风险、负债风险、技术风险、知识产权风险、转型风险。</p><h2 id="风险管理">风险管理</h2><h3 id="风险应对">风险应对</h3><p>为了有针对性地对各个风险进行分析，并找到解决方案，接下来我们根据风险大类对他们进行分析，找到应对方法。</p><p><strong>（一）战略风险</strong></p><p>（1）打好政府关系牌，避免由此带来的隐形风险</p><p>一个企业的发展离不开当地政府的大力支持，我公司将会通过赞助当地基础设施建设项目工程、开展联谊会议等方式和当地政府建立妥善的关系，减少由此带来的隐形损耗，建立标杆企业形象，从而在大方向上的政策上做到及时应对，进退有路。</p><p>（2）对科研队伍严把关，加大研发投入，提高团队开发能力。</p><p>作为高新技术企业，我公司对科研的重视程度绝对是最看重的。我公司依托电子科技大学计算机视觉与机器智能实验室，借助这个平台，我们会进行频繁的校企合作，打造校企合作标杆形象。同时，在国内外优秀高校高薪聘用优秀毕业生，加入我们的研发团队，创造一个优秀的开发队伍。同时，购买先进的科研设备，打造国内领先的计算机视觉实验室，为科技研发打造硬件平台。最后，还要对科研队伍进行再审造，进一步提高队伍的开发能力。</p><p>（3）用户至上，不断回应用户的需求，从而植根于市场。</p><p>尽可能地进行市场调研（包括但不限于问卷调查、手机用户体验反馈等等），深度挖掘用户的多样化需求，比如风格迁移的方向、场景建模的效果、软件上手的难易程度等等，始终致力于满足用户的个性化、多样化需求，从而在市场上能够取得一定的优势。</p><p><strong>（二）财务风险</strong></p><p>（1）建立健全财务风险预警系统</p><p>采用合适的数学模型对公司财务进行分析，并借助先进的财务状况评价标准，对我公司的财务情况有正确的认识。做到加强资金预算，有效安排资金，提高公司财务的流动性，保障公司财务的稳定性，防止现金流断裂，减轻财务压力。</p><p>（2）加强企业公关能力，提高企业的信誉，确保企业融资顺利进行</p><p>我公司在成立初期面临的生存压力十分巨大，能否走出这一困境很大程度上取决于资金是否充裕，因而保障企业融资顺利进行非常重要。我们会和当地的政府、新闻媒体进行密切交流和合作，打响企业的知名度，建立良好的社会关系网，为企业的生存和进一步发展提供了坚实的保障。</p><p><strong>（三）市场风险</strong></p><p>（1）加大研发力度，关注竞争对手</p><p>归根到底，企业的核心竞争力始终是产品的质量。唯有加大研发力度，不断开发出能够满足用户多样化、个性化需求的风格迁移工具，这才是我公司立足于市场的根本。同时，也应该不断关注自己的竞争对手，尤其是像美图秀秀这种大型公司，要及时分析他们的发展方向，做到知己知彼，方可百战不殆。</p><p>（2）借款前期限错位，降低贷款成本</p><p>利率浮动主要影响的是我公司的贷款成本，因此，我们可以采取借款前期限错位的方法来规避。当预测贷款利率上升时，公司借入长期贷款，减少短期贷款的数量；当预测利率下降时，公司增加短期贷款的数量。这样，可以通过调整贷款头寸来分散部分利率风险。</p><p>（3）及时更新客户和供应商的信用情况</p><p>只有不断更新用户和供应商的信用情况，才能对他们的信用情况进行正确的评估，对信用情况差的客户或者供应商在合作时应提高警惕。</p><p><strong>（四）运营风险</strong></p><p>（1）谨慎转型，走稳健路线</p><p>在我公司转型的关键节点，我们会通过开展内部会议来凝聚团队共识，同时更多了解外界（尤其是互补企业，比如游戏开发、社会安防相关领域的企业）对我们的意见和建议，兼听则明，以此来尽量避免过于莽撞的转型想法。</p><p>在具体的行动落实上，我们尽量争取走稳健路线，发展方向上朝着个性化服务、多样化服务的方向努力。同时，我们还会以市场为导向进行品牌化运作、建立有营销团队，主公大型客户取得示范化效应以达到体现企业形象的目的，从而凸显企业品牌，为转型成功打下坚实基础。</p><p>（2）积极营造公司融洽氛围，完善管理制度</p><p>可以通过外出团建、联谊会等形式推动公司内部交流，尽量消除员工之间的隔阂，从而提高公司的整体效率和组织效能。建立健全评价和激励标准，提高员工的工作积极性，让我公司由内而外的强大。</p><p>（3）公司重要文件及时做好备份，安置消防设施，做好疫情防控</p><p>作为高新技术企业，科技是我们的第一生产力。考虑到自然灾害的不确定性，因而我们要把公司重要的文件及时做好备份，同时消防设施也要在公司内部全面安置，这样才能做到有备无患。同时，在后疫情时代，我们也要有较高的疫情防控意识，要求员工佩戴口罩工作，同时分配人员分片分区工作，防止人员聚集，做好疫情防控。</p><p><strong>（五）法律风险</strong></p><p>（1）保护知识产权，理清合同协议</p><p>我们公司在计算机视觉领域的许多知识产权是我们赖以发展的根基，但是不排除被竞争公司模仿甚至是抄袭的可能。因此我们要提高维权意识，聘用相关领域的法律人士始终关注我们公司的知识产权，从而确保知识产权不被侵犯。同时，在和其他公司签订合同协议的时候，也要让法律专业人士对合同的框架进行全方面的解读，防止在细微之处出现漏洞，致使我们公司的合法权益被侵犯。</p><p>（2）打造企业文化，提高员工的企业文化认同感，从而避免技术外流</p><p>我们公司将通过打造具有特色的企业文化，增强整个团队的集体荣誉感，建立一个有凝聚感的研发队伍，尽可能地满足团队的各种需求，从根本上杜绝了技术外流的可能。</p><h3 id="风险预警机制">风险预警机制</h3><p>除了完善应对风险的技巧，我们还有具有提前识别风险的能力。接下来我们根据公司自身的商业模式、战略定位、组织特点等因素，分析出我们公司的风险预警机制。建立我公司的风险预警机制应注意以下几个方面：</p><ul><li><p>确保公司内部沟通渠道通畅</p><p>对于公司存在的风险只有身处一线的员工才能切身体会，但公司的决策往往由管理者来决定，这就要求我们要确保公司内部沟通渠道顺畅，下属可以及时将发现的潜藏的风险汇报给上级，管理者也应该及时做出相应的应对政策并迅速传达给下级。</p></li><li><p>明确风险管理岗位责任制和完善考核制度</p><p>风险管理岗位是对于风险管理岗位要做到责任落实，对于潜在的风险，瞒报、迟报、误报等失职行为要进行应有的责罚，对于及时上报等积极表现要给予适当的奖励。此外，还要定期对风险管理岗位员工进行考核，完善考核制度，确保员工的工作积极性。</p></li><li><p>完善企业财务风险预警机制</p><p>我们公司应明确自身财务体系的变化，不可一味地照搬其他公司的财务风险预警机制，要结合自身财务的特点，完善财务风险预警机制。方法包括但不限于增强对大数据的管理与利用程度，将财务风险进行数字化表示，同时增强财务风险管理岗位的高素质队伍建设，不断进行新的风险预警机制的探索。</p></li></ul><blockquote><p>鸣谢：子瀛子、怡龙子、顺强子、子力子、琪琪子、一凡子等</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 人工智能 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大学生竞赛 </tag>
            
            <tag> 项目开发 </tag>
            
            <tag> 机器视觉 </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于CycleGAN的图像风格迁移模型设计与创业策划（中）</title>
      <link href="/e3f6879b/"/>
      <url>/e3f6879b/</url>
      
        <content type="html"><![CDATA[<h1 id="解决方案">解决方案</h1><h2 id="项目计算框架">项目计算框架</h2><p>本项目采用华为提出的MindeSpore科学计算框架。</p><h3 id="昇腾AI全栈">昇腾AI全栈</h3><p>MindSpore科学技术框架隶属于华为昇腾AI全栈。昇腾计算，是基于昇腾系列处理器构建的全栈AI计算基础设施及应用，包括昇腾Ascend系列芯片、Atlas系列硬件、CANN芯片使能、MindSpore AI框架、ModelArts、MindX应用使能等。华为Atlas人工智能计算解决方案，是基于昇腾系列AI处理器，通过模块、板卡、小站、服务器、集群等丰富的产品形态，打造面向“端、边、云”的全场景AI基础设施方案，涵盖数据中心解决方案、智能边缘解决方案，覆盖深度学习领域推理和训练全流程。昇腾AI全栈如下图所示：</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231016240.png" alt="昇腾AI全栈"></p><h3 id="MindSpore科学计算框架">MindSpore科学计算框架</h3><p>MindSpore是一个全场景深度学习框架，旨在实现易开发、高效执行、全场景覆盖三大目标，其中易开发表现为API友好、调试难度低，高效执行包括计算效率、数据预处理效率和分布式训练效率，全场景则指框架同时支持云、边缘以及端侧场景。</p><p>MindSpore总体架构如下图所示，下面介绍主要的扩展层（MindSpore Extend）、前端表达层（MindExpression，ME）、编译优化层（MindCompiler）和全场景运行时（MindRT）四个部分。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231029887.png" alt="MindSpore科学计算框架"></p><p>MindSpore具有以下设计理念：</p><ul><li>MindSpore源于全产业的最佳实践，向数据科学家和算法工程师提供了统一的模型训练、推理和导出等接口，支持端、边、云等不同场景下的灵活部署，推动深度学习和科学计算等领域繁荣发展。</li><li>MindSpore提供了Python编程范式，用户使用Python原生控制逻辑即可构建复杂的神经网络模型，AI编程变得简单。</li><li>目前主流的深度学习框架的执行模式有两种，分别为静态图模式(TensorFlow)和动态图(Pytorch)模式。静态图模式拥有较高的训练性能，但难以调试。动态图模式相较于静态图模式虽然易于调试，但难以高效执行。</li><li>MindSpore提供了动态图和静态图统一的编码方式，大大增加了静态图和动态图的可兼容性，用户无需开发多套代码，仅变更一行代码便可切换动态图/静态图模式，神经网络模型通常基于梯度下降算法进行训练，但手动求导过程复杂，结果容易出错。MindSpore的基于源码转换（Source Code Transformation，SCT）的自动微分（Automatic Differentiation）机制采用函数式可微分编程架构，在接口层提供Python编程接口，包括控制流的表达。用户可聚焦于模型算法的数学原生表达，无需手动进行求导。</li><li>随着神经网络模型和数据集的规模不断增加，分布式并行训练成为了神经网络训练的常见做法，但分布式并行训练的策略选择和编写十分复杂，这严重制约着深度学习模型的训练效率，阻碍深度学习的发展。MindSpore统一了单机和分布式训练的编码方式，开发者无需编写复杂的分布式策略，在单机代码中添加少量代码即可实现分布式训练。</li></ul><p>MindeSpore具有以下层次结构：</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231046249.png" alt="MindeSpore API层次图"></p><p>MindSpore向用户提供了3个不同层次的API，支撑用户进行网络构建、整图执行、子图执行以及单算子执行，从低到高分别为Low-Level Python API、Medium-Level Python API以及High-Level Python API。</p><ul><li>High-Level Python API</li></ul><p>第一层为高阶API，其在中阶API的基础上又提供了训练推理的管理、混合精度训练、调试调优等高级接口，方便用户控制整网的执行流程和实现神经网络的训练推理及调优。例如用户使用Model接口，指定要训练的神经网络模型和相关的训练设置，对神经网络模型进行训练，通过Profiler接口调试神经网络性能。</p><ul><li>Medium-Level Python API</li></ul><p>第二层为中阶API，其封装了低阶API，提供网络层、优化器、损失函数等模块，用户可通过中阶API灵活构建神经网络和控制执行流程，快速实现模型算法逻辑。例如用户可调用Cell接口构建神经网络模型和计算逻辑，通过使用loss模块和Optimizer接口为神经网络模型添加损失函数和优化方式，利用dataset模块对数据进行处理以供模型的训练和推导使用。</p><ul><li>Low-Level Python API</li></ul><p>第三层为低阶API，主要包括张量定义、基础算子、自动微分等模块，用户可使用低阶API轻松实现张量定义和求导计算。例如用户可通过Tensor接口自定义张量，使用ops.composite模块下的GradOperation算子计算函数在指定处的导数。</p><h3 id="TinyMS">TinyMS</h3><p>TinyMS是一款面向的主要用户群体为深度学习初学者、研究领域涉及深度学习结合的科研人员、以及深度学习相关业务应用开发的企业开发人员，用PyThon语言编写的开源深度学习开发工具包，基于以MindSpore为代表的新型开源深度学习框架，提供面向从数据准备到模型部署全流程的极简易用的高阶API封装，并通过易于扩展的模块化设计，提供覆盖多种业务场景的能力。</p><p>TinyMS主要由data, model, serving等模块组成，分场景分领域提供transform数据预处理算子，复用MindSpore原生数据集提供常用数据集，如：cifar-10等。data提供部分自定义数据集和常用的数据下载和解压等常用工具集，model提供常用的预置模型，并提供模型构建，模型编译，模型训练、验证与推理。serving通过搭建服务器来提供AI模型应用服务，为新手提供快速推理的体验。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231138478.png" alt="TinyMS设计框架"></p><p>TinyMS相较于Keras等传统API复杂度更低并提供了大量MindSpore常用预置数据集以及快速部署推理模块。使用MindSpore科学计算框架以及TinyMS程序包进行项目开发在开发难度、速度上都具有显在优势。</p><h2 id="项目数据">项目数据</h2><h3 id="Cityscapes">Cityscapes</h3><p>本项目使用Cityscapes数据集作为城市风格数据集。</p><p>Cityscapes数据集是由包含戴姆勒在内的三家德国单位联合提供，包含50多个城市的立体视觉数据的城市街道场景的语义分割图片数据集。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231158676.png" alt="Cityscapes数据集原始图像(左)与标注图像(右)"></p><p>Cityscapes数据集拥有5000张在城市环境驾驶场景高质量像素级标注图像以及20000张粗标注图像。其中高质量标注图像中对数据集进行了划分，分别为训练集2975张，验证集500张和测试集1525张共19个类别。本项目使用原始图像作为城市风格数据，标注后分割图像作为迁移风格数据进行风格迁移。</p><h3 id="艺术风格数据集">艺术风格数据集</h3><p>本项目在以上基础上，额外使用Cezanne、Monet和Vangogh三位艺术家以及日本Ukiyoe共4种艺术风格数据对原始城市图像进行艺术风格迁移。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231212024.png" alt="艺术风格图像，从左到右为Cezanne、Monet、Vangogh、Ukiyoe"></p><p>通过在Wikiart.org对艺术家画作进行收集，通过删除黑白图像并将其余图像Resize至256×256分辨率，最终得到Cezanne艺术图像525张、Monet艺术图像1072张、Vangogh艺术图像400张以及Ukiyoe艺术图像562张。</p><h2 id="项目算法模型">项目算法模型</h2><h3 id="CycleGAN">CycleGAN</h3><p>本项目使用CycleGAN作为风格迁移网络模型来完成对城市风格图片的风格迁移。CycleGAN是Zhu Yan-Jun等人于2017 ICCV上提出的一种基于生成对抗网络解决图像生成领域中风格迁移问题的算法模型。目前学术界中风格迁移网络模型要求提供图像对，即同一图片的不同风格。在现实中，这样的要求往往是昂贵且不实际的。针对这一问题提出的CycleGAN网络不要求提供图像对，可在没有任何成对训练数据的情况下，通过对图像集特定特征进行描述并将该图像集特征转换为另一图像集特征，完成非成对数据下的图像风格迁移。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231309261.png" alt="成对风格数据(左)与非成对风格数据(右)"></p><h3 id="网络结构">网络结构</h3><p>CycleGAN网络结构为一个环形结构，如图5所示。设图像风格域为X域和Y域，图中X表示X域中图像，Y表示Y域中图像。该网络包含G、F两个风格迁移生成器分别完成X域到Y域以及Y域到X域的循环风格迁移，即使用X域图像通过生成器G生成Y域图像，再通过生成器F重构X域输入的原图像。使用Y域图像通过生成器F生成X域图像，再通过生成器G重构Y域输入的原图像。同时设计DX、DY两个图像生成判别器完成对生成图像的风格域判别。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231322287.png" alt="CycleGAN"></p><h3 id="生成器">生成器</h3><p>CycleGAN网络结构中生成器结构为编码器(Encoder)+转换器(Transformer)+解码器(Decoder)。即整个图像生成过程由编码、转换与解码三步完成。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231337217.png" alt="Cycle生成器"></p><p><strong>编码器</strong>由3个卷积块构成。3个卷积块对输入图像提取特征，将图像压缩成256个64*64的特征向量。其卷积块结构分别为：卷积核大小7×7，步长为1，卷积核数量64卷积层-实例归一化层-修正线性单元层；卷积核大小3×3，步长为2，卷积核数量128卷积层-实例归一化层-修正线性单元层；卷积核大小3×3，步长为2，卷积核数量256卷积层-实例归一化层-修正线性单元层。</p><p><strong>转换器</strong>由6个残差块构成。通过组合图像的不相近特征，将图像在X域的特征向量转换为Y域的特征向量。生成器中转换器使用了6个相同的残差块，每一个残差块包含两个3×3的卷积层。能够达到在转换时同时保留原始图像特征的目标。</p><p><strong>解码器</strong>由2个反卷积块，1个卷积块构成。利用反卷积层（decovolution）完成从特征向量中还原出低级特征的工作，最后得到生成图像。其中2个反卷积块为：卷积核大小3×3，步长为1/2，卷积核数量128的卷积层-实例归一化层-修正线性单元层；卷积核大小3×3，步长为1/2，卷积核数量64的卷积层-实例归一化层-修正线性单元层；卷积块为：卷积核大小7×7，步长为1，卷积核数量3的卷积层-实例归一化层-修正线性单元层。</p><h3 id="判别器">判别器</h3><p>CycleGAN网络判别器使用70×70PatchGAN网络结构。原始GAN的判别器的设计仅输出单一评价值（True or False），该值是对生成器生成的整幅图像的一个评价。而PatchGAN的设计不同，PatchGAN设计成全卷积的形式，图像经过各种卷积层后，并不会输入到全连接层或者激活函数中，而是使用卷积将输入映射为N*N矩阵，该矩阵等同于原始GAN中的最后的评价值用以评价生成器的生成图像。通过这种方式可以增大感受野以关注图像中更多区域，使得PatchGAN相较于传统判别器更有优势。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231351263.png" alt="CycleGAN判别器"></p><p>CycleGAN中PatchGAN使用4个卷积块，分别为：卷积核大小4×4，步长为2，卷积核数量64的卷积层-实例归一化层-带泄露修正线性单元；卷积核大小4×4，步长为2，卷积核数量128的卷积层-实例归一化层-带泄露修正线性单元；卷积核大小4×4，步长为2，卷积核数量256的卷积层-实例归一化层-带泄露修正线性单元；卷积核大小4×4，步长为2，卷积核数量512的卷积层-实例归一化层-带泄露修正线性单元；最后通过一个卷积层将输出映射至1维。</p><h3 id="损失函数">损失函数</h3><p>CycleGAN利用式(1)对抗损失实现网络生成对抗训练。</p><p>为了解决非成对数据训练因模型容量过大导致不同生成器生成图像都能满足与目标域图像分布匹配问题，CylceGAN利用式(2)所示循环一致性损失减少映射函数空间域以获得更优生成质量。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231404566.png" alt="损失函数"></p><h2 id="项目系统架构">项目系统架构</h2><p>本次项目采用MindSpore高阶工具TinyMS对CycleGAN网络进行复现完成城市风格迁移。本项目系统由数据处理模块(训练/推理)、网络训练模块、网络推理以及模型部署模块<br>四部分共同组成风格迁移系统。其系统架构图如下图所示。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231414984.png" alt="系统架构图"></p><h3 id="数据处理模块">数据处理模块</h3><p>本系统数据处理模块分为训练数据处理模块和推理数据处理模块两部分。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231427748.png" alt="数据处理模块"></p><p>训练数据处理模块：该模块对训练数据进行划分为后续网络训练做准备。该模块对输入数据集按风格分为A、B集后，分别对A、B集按一定比例进行随机划分，得到训练集A、B以及测试集A、B。</p><p>推理数据处理模块：该模块对推理数据做预处理使其对后续推理网络输入适配。该模块针对图像和视频两种输入模式基于OpenCV采用两种处理方式。对于视频数据，为保证风格迁移后的视频观赏效果，首先对其进行逐帧抽取，然后将图像帧Resize至256×256分辨率。对于图像数据则直接Resize至256×256分辨率，以便后续推理。</p><h3 id="网络训练模块">网络训练模块</h3><p>本系统网络训练模块基于输入数据集完成风格迁移模型的训练工作。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231444739.png" alt="网络训练模块"></p><p>该模块首先通过高阶程序包TinyMS完成CycleGAN模型的搭建，并基于Adam优化算法创建网络优化器对网络参数进行优化。对于不同的训练需求，可选择是否载入以及载入时选择不同的预训练模型参数以实现CycleGAN网络模型的训练或者迁移训练，为后续网络推理模块提供推理模型支持。</p><h3 id="网络推理模块">网络推理模块</h3><p>本系统网络推理模块基于已训练模型完成对输入数据的风格迁移推理。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231458789.png" alt="网络推理模块"></p><p>该模块与网络训练模块相同，首先基于TinyMS完成CycleGAN模型的搭建。基于对不同风格迁移的需求，对CycleGAN网络模型载入不同风格的模型参数。最后对基于载入参数后模型对输入数据进行推理输出，完成对输入数据的风格迁移。</p><h3 id="服务部署模块">服务部署模块</h3><p>本系统服务部署模块基于Flask构建服务端与客户端完成CycleGAN网络模型的部署，实现对输入数据的推理输出。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231509751.png" alt="服务部署模块"></p><p>该模块基于轻量网页服务器Flask构建服务端(Server)与客户端(Client)作为模型部署通讯架构。首先创建服务端和客户端，在收到待推理数据后客户端将向服务端请求推理，服务端在后端调用网络推理模块完成数据推理后将推理结果传回客户端，最后由客户端完成对风格推理结果的显示输出。</p><hr><h1 id="核心产品">核心产品</h1><p>本团队根据客户群体以及需求差异，估计市场环境以及需求，拟推出两款基于图像风格迁移技术的核心产品。其中面对个体用户的社交日常需求，本团队推出图像风格大师社交多端软件平台。面对群体用户的多行业多领域个性化需求，本团队推出个性化风格迁移定制服务。</p><h2 id="图像风格大师社交多端软件平台">图像风格大师社交多端软件平台</h2><p>图像风格大师社交多端软件平台是为个人用户提供日常社交中的图像风格迁移服务。该平台以风格迁移技术为核心，基于华为昇腾AI生态栈开发，为用户提供丰富多样的社交风格迁移服务。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231523992.png" alt="图像风格大师社交多端软件平台"></p><p>本产品服务方式为：用户根据自身社交需求与期望服务环境，选择对应图像风格大师客户端软件。用户首先将需要风格迁移对象进行输入，通过网络将数据上传至图像风格大师服务器/本地GPU，通过使用风格迁移模型对输入数据进行推理实现对输入数据的风格迁移，最后通过将迁移结果返回输出。</p><h2 id="个性化风格迁移定制服务">个性化风格迁移定制服务</h2><p>个性化风格迁移定制服务是为团体用户提供在其行业领域中所需的个性化图像风格迁移服务。该服务聚焦于华为昇腾AI生态栈下图像风格迁移技术，通过针对各异化需求进行定制开发为用户提供风格迁移服务。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231538533.png" alt="个性化风格迁移定制服务"></p><p>本产品服务方式为：用户通过与公司相关部门沟通，根据用户实际需求落实风格迁移服务实际风格迁移类型、服务端类型(如桌面端、边缘计算端)与相关技术指标。公司技术部门根据需求类型搜集相关训练数据对风格迁移模型在个性化数据上进行迁移训练，同时针对客户所需服务端类型进行技术移植与模型部署，最后根据技术指标进行总体调整实现个性化风格迁移服务。</p><hr><h1 id="商业模式-2">商业模式</h1><h2 id="产品特性">产品特性</h2><p>破晓科技作为风格迁移商业化开发应用先行者，依托华为昇腾AI生态研发的风格迁移模型面向多用户群体，设计两大核心产品，图像风格大师和个性化风格迁移定制服务，从而实现多方向盈利。图像风格大师主要面向个体用户，针对社交多样化需求，多平台提供风格迁移服务；风格迁移定制服务面向团体用户，针对个性化需求，快速将我们的技术迁移开发从而提供针对性解决方案。</p><h2 id="产品形式及盈利模式">产品形式及盈利模式</h2><p>本产品从客户的实际需求出发，结合实际市场需求与技术实现形式，团队设计产品商业模式如下图所示。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231555954.png" alt="产品商业模式图"></p><h3 id="图像风格大师">图像风格大师</h3><p>基于个人用户的日常社交需求，我们设计一款面向在线个人服务的服务端产品模式。该产品分为网页端和APP两种类型。网页端通过用户提交图片发起服务请求，通过云端计算实现对用户所需图片的风格迁移结果。APP则是通过与其他软件开发商合作提供算法或者自行开发具备风格迁移功能的社交APP对个人移动端用户提供算法服务。</p><p>此种方式按会员制、计时收费、计次收费等模式获得盈利，只有初期平台建立以及平台维护的成本，预估毛利润较高，可达80%~90%。</p><h3 id="个性化风格迁移定制服务-2">个性化风格迁移定制服务</h3><p>对于政府、公司等团体用户需求，我们设计了面向团体离线服务的定制端产品模式。对于游戏开发、建筑设计等设计公司团体，我们将针对用户实际问题需求，对算法模型进行针对性调整，开发个性化的基于解决方案的离线软件应用程序对游戏开发者以及建筑设计师提供辅助设计服务。同时对于社会安防相关的政府、监控设备提供商等用户群体，我们将算法在昇腾AI生态环境下实现边缘设备的应用移植，通过边云协同机制实现智慧监控能力的提升需求。</p><p>定制端产品聚焦于团体用户个性化需求，拟采用买断制的收费模式，同时针对老用户的新需求提供有偿算法更新迭代服务以实现产品的盈利。</p><hr><h1 id="目标市场">目标市场</h1><h2 id="潜在市场">潜在市场</h2><h3 id="游戏制作-2">游戏制作</h3><p>经团队调研，中国游戏行业市场实际收入逐年增加，截止2021年市场规模已达3000亿元，市场潜力不容忽视。而游戏动画中场景的布置设计往往是整个游戏故事作品的核心和灵魂，游戏的场景内容是游戏主题的重要呈现，场景设计编排的优劣决定了游戏镜头的画面感和效果，也会影响游戏的鉴赏和点评。好的作品往往会通过优质的画面和跌宕起伏的情感吸引人们的眼球，场景设计就是制造画面的最重要环节。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231610311.png" alt="中国近年游戏行业市场变化情况"></p><p>对于我们团队所做的基于CycleGAN的城市风格迁移模型便可应用其中——一个场景设计的重要内容，场景的风格。一款游戏的场景风格一定是要贴合游戏内容的，大体可以分为梦幻风格、现实风格、装饰风格、综合风格。而通过CycleGAN模型可以做到当游戏公司在确定一款游戏的风格以后，先生成一个demo，然后使用城市风格迁移模型来做到对整个游戏场景进行风格迁移变化，快速简单地体验场景视觉效果，从而大大减少游戏制作的初期成本；因此，我们可以与游戏公司合作，将我们的产品运用其中从而获得经济效益。</p><p>另一方面，游戏开发公司通过风格迁移功能，可以开发出不同风格的测试场景并进行玩家调查，判断出哪种风格更受玩家欢迎，从而制定游戏下一步研发的方向，减少产品失败的风险。而对于游戏玩家来说，对于游戏内容的侧重点各不相同，对于游戏的风格、玩法、剧情都有其目标用户。通过风格迁移，可由玩家自行选择喜欢的场景风格，实现写实场景风格、写意场景风格与动画场景风格的自行转换，在满足玩家风格需求的同时，也能让玩家也能体会到参与游戏制作的感觉。对于普通的玩家来说，要去改变一款游戏的玩法与游戏内核难度过大，但通过仅改变游戏场景风格而不用影响整个游戏的内核，即可在保证游戏自身稳定性的同时，满足玩家对于一款游戏的参与感需求，也有很好的交互性。</p><p>我们可以将该项功能设计为需要玩家支付一定金额来获取的服务，或者可以设计为会员服务，从而获得收入。</p><h3 id="社交互动-2">社交互动</h3><p>经过团队调研，近年来，vlog逐渐地在全球范围内风靡。因为vlog的兴起，不论在国内还是国外都出现了大量vlogger。从2018年开始，在网络上席卷了一股拍原创视频记录生活的热潮，因为vlog而走红的博主也在逐渐地增多。对于全球范围内的95后甚至00后来说，vlog已经逐渐成为了他们记录生活，表达个性最为主要的方式。但并非每一个人都能像一些专业vlogger一样，拍摄出一个好的vlog，其中重要的一点就是他们对于场景风格的把握并没有做到很好。因此，我们能将我们的风格迁移运用其中，以高质量vlog作为训练模板，从而达到Vlog的场景风格迁移，达到更好的呈现效果。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231626432.png" alt="中国vlog用户规模变化及趋势预测"></p><p>同样现在兴起许多短视频软件，而大多数短视频软件都具有特效功能，但其大多是注重对人物自身的特效，而忽视了场景的特效，这就导致很多特效缺乏氛围感，假使我们能够对场景进行风格迁移的话，用户就能选择不同的风格来对背景中的城市场景进行渲染，从而增加其趣味性和观看性。</p><p>因此，本项目获益可以来自于两个方面，一是直接与这样的视频软件商合作，将该技术运用其中并从中收取一定费用；二是自行打造一个新型的具有风格迁移的软件通过自行培养用户群并提供服务来获得收入。</p><h3 id="社会保障-2">社会保障</h3><p>经过团队调研，社会对于视频监控的需求逐年提升，特别是在5G物联网大背景下，视频监控能力是智慧城市的核心要素。但当摄像头拍摄出现模糊的状况，且正好遇到事故发生，从而没能拍摄清楚时间发生状况，就会产生极大危害。而CycleGAN的风格迁移算法在图像去噪任务上有着不错的表现，利用城市风格迁移模型，将低分辨率的城市监控图像转换成高分辨率图像、将带噪声风格的城市监控图像转换为低噪声甚至无噪声图像，从而满足安防监控工作需求，提升智慧安防能力。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231641627.png" alt="视频监控市场导向"></p><p>这一方面可以通过寻求与各个地区政府部门的合作，或者直接与一些大型的摄像头出品商合作，提供算法支持从而获得经济效益。</p><h3 id="建筑规划-2">建筑规划</h3><p>城市景观是城市形象的一个重要组成部分，是城市的外部表达的性格、背景、模式和历史、文化和社会发展水平的综合反映，是自然资源和人文景观环境体现在城市文化和社会生活的特征。而其中显现的城市风格则是一个城市独有的气质，它明显区别于其他城市的个性，是该城市的市民创造的物质和精神成就的外在表现。城市景观特征不仅是建筑技术和学术流派，而且是关系到城市核心竞争力的大问题，塑造城市景观特色具有经济社会发展的现实意义和文脉传承的历史意义。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231727869.png" alt="城市规划行业市场规模变化表"></p><p>目前中国的未来城市规划几乎都是修建高层的商业大楼、酒店和公寓楼，不同城市的建筑外观风格较为单一，失去了这座城市的独有的风格气质。为了避免这种情况，我们可以利用我们的城市风格迁移模型来进行预规划，通过收集一些符合某城市形象的照片，训练出可以让模型生成符合城市风格的图像，进行建筑物外观的预设计，这既能节省成本，还能使得城市风格能与城市内涵更加贴切。</p><p>我们可以通过建筑公司了解各城市的具体需求，然后将符合该城市风格图像或视频经过风格迁移处理后的结果出售建筑公司，从而获得利益。</p><h2 id="就业推动">就业推动</h2><p>本项目从产品核心技术特点与产品市场定位出发，通过对风格迁移技术进行更新迭代，深度挖掘该技术在各个行业领域的潜在商业价值，大力推动AI行业就业发展质量，预计10年内扩大AI行业就业人数10000余人。产品团队发展计划如下：</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231742107.png" alt="产品团队发展规划"></p><p>本团队于2021年项目立项，通过技术开发与基本需求定位对产品实现初步建立。在明确基本产品需求后，于2022年扩大团队规模至100人，完成对产品的进一步开发与市场推广。针对产品实际盈利方向与市场变化，团队将于2023年进行团队定位调整，进一步明确产品更新方向，计划于2026年提供2000余就业岗位。同时进一步扩大产品需求，对各行业领域进行针对性产品更新，实现产品的全方位推广，最终实现10000余就业岗位的提供。</p>]]></content>
      
      
      <categories>
          
          <category> 人工智能 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大学生竞赛 </tag>
            
            <tag> 项目开发 </tag>
            
            <tag> 机器视觉 </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于CycleGAN的图像风格迁移模型设计与创业策划（上）</title>
      <link href="/de13101c/"/>
      <url>/de13101c/</url>
      
        <content type="html"><![CDATA[<h1 id="概述">概述</h1><h2 id="项目概述">项目概述</h2><p>本项目要求通过MindSpore中高阶工具TinyMS支持的CycleGAN网络实现风格迁移。并提出以下目标要求：</p><ul><li>使用TinyMS搭建的CycleGAN网络</li><li>使用自己的数据做迁移学习，可基于TinyMs提供的预训练模型进行训练，也可以自行训练</li><li>有明确的应用场景和实际意义</li></ul><h2 id="项目背景">项目背景</h2><p>图像风格迁移主要指将A图像的内容特征和B图像的风格特征二者融合，最终生成一张既保留A图像内容又含有B图像目标风格的C图像的一类任务，其中可用于迁移的风格是多种多样的，例如：艺术家风格、漫画风格等。在图像风格迁移任务中会遇到这样的问题：艺术风格并没有一个标准的统一的定义，品类繁杂，比如印象派、后印象派、中国风等，所以无法用确切的数学函数模型去描述。但是有研究发现，在艺术风格较为强烈的图像中，其纹理表述和艺术风格表述近似相等，因此可以通过提取纹理特征来近似提取图像中的风格特征。但是在深度学习出现以前，需要人工去分析图像的风格，并依靠手动建立数学或者统计模型来表述图像的纹理特征。然而图像风格一旦发生变化就需要重新建模，耗时耗力，这极大地限制了这些传统图像风格迁移模型的适用范围。</p><p>随着深度学习的发展，深度神经网络能以最优的方式自动地提取图像中有效特征的表达，在图像特征提取任务上展现了出色的能力。并且采取深度学习的方式可以避免手工建模的耗时耗力。得益于此，图像风格迁移在近年来获得了极大的发展，目前在社交软件、电影制作、游戏美术设计等各个领域都得到了一定程度的应用。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231820211.png" alt="风格迁移效果演示"></p><p>另一方面，AI技术近年来迅速发展，华为技术有限公司也是提出自主研发的新一代全场景AI计算框架MindSpore。该框架具有易开发、高效执行、全场景覆盖三大特点，是源于全产业的最佳实践，为AI算法工程师以及数据工程师提供了强大的模型训练推理能力和在多场景下灵活部署能力，对数据科学和人工智能领域发展具有巨大的推动作用。此外，基于开源深度学习框架MindSpore开发的深度学习开发工具TinyMS为用户提供了从数据准备到模型部署的全流程的极简易用的高阶API封装，并通过易于扩展的模块化设计提供了覆盖多种业务场景的能力，为深度学习初学者、科研人员以及深度学习企业开发人员提供了便捷高效的开发工具包。</p><p>在本次命题中，我们便使用了TinyMS开发包中提供的CycleGAN网络模型，快速提供了风格迁移任务解决方案。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231835506.png" alt="Mindspore与TinyMS"></p><p>基于以上背景，我们本次命题期望实现的最终功能是，使用TinyMS搭建的CycleGAN网络，并基于开源图像数据训练一个城市风格迁移模型，模型接收用户输入的一张城市图像（一段城市视频），然后按照用户选择的风格来生成风格迁移后的富有特色的城市图像（视频）。</p><h2 id="产品介绍">产品介绍</h2><p>目前项目团队面向个体用户的社交需求，拟推出图像风格大师网页端、图像风格大师移动端与图像风格大师桌面端等多类型客户端社交应用软件。满足个体用户在社交中图像艺术风格滤镜、直播视频艺术背景替换等功能。</p><p>面向团体用户的多方面个性化需求，本项目目前根据产品市场需求进行定位开发，拟推出游戏场景自动化风格建模软件平台、边缘端图像去雾算法平台以及建筑风格辅助设计平台，提供多学科多场景风格迁移定制解决方案。</p><h2 id="商业模式">商业模式</h2><p>本团队作为风格迁移商业化开发应用的先行者，依托电子科技大学计算机视觉与机器智能实验室与华为昇腾AI全栈平台，基于生成对抗网络实现风格迁移技术，针对个体与团体用户的多学科多行业应用需求，根据需求技术指标进行技术迁移开发生成软件服务平台，由销售运营团队实现对客户的持续对接，实现长期运营。</p><p>主要业务分为两部分。一部分是图像风格大师社交多端软件平台。为个体用户提供社交风格迁移服务。该业务通过团队公司运营与出租代理商服务，对用户采用会员制收费、计次收费与计时收费结合方式实现盈利。第二部分是个性化风格迁移定制服务。该部分通过针对团体用户个性化差异公司团队实现定制化软件开发，并以收取定制开发费以及有偿更新迭代服务实现盈利。</p><h2 id="项目效益">项目效益</h2><h3 id="带动就业">带动就业</h3><p>破晓科技成立公司伊始，直接提供行政管理、科技研发等各类就业岗位30多个。预计五年内新增岗位200多个。公司产业应用范围较广，初定有四个不同的应用领域，因此对于各领域产业的就业人数都有极大的间接带动作用，预计在五年内带动本地及相关合作就业人数2000以上。我们以AI助力产学研发展，不断带动就业增长。</p><h3 id="引领教育">引领教育</h3><p>本项目团队培养了一批优秀的硕士、本科生。其中指导老师团队经验丰富，有过多项专利作为项目的技术支撑，核心团队中两名研究生在校成绩优异，通过该项目对自身科研能力、技术能力以及；多名本科生在校成绩优异，有着参与科研项目的经历，获得优秀奖学金等荣誉。对于本次项目，本团队拟申请多项专利及软件著作权。</p><p>项目团队注重产学研一体化。在校期间就积极鼓励学生参与各种竞赛，综合素质得到极大提升。本项目团队由两名研究生和六名本科生组成，通过该项目，既提升了研究生的领导力和专业能力，也使得本科生有了更好的机会接触到高新技术。团队做到了多学科交叉融合创新，“A+双一流学科”+“多领域产品创新”极大提升了团队整体的创新创业思维能力。本次创业大赛做到了“赛”“创”结合，对接相关企业，利用行业资源，实现高质量高效率孵化创新，持续推动实际AI产品落地，促进社会健康发展。</p><p>通过积极参与此次创业大赛，培养和提升了团队成员创新精神、创业意识和创新创业能力，充分体现了团队成员所学专业知识和技能在项目和相关创新创业活动中的转化与应用。</p><hr><h1 id="项目需求">项目需求</h1><h2 id="市场环境分析">市场环境分析</h2><p>当前，应用市场中已经存在诸如Prisma等应用图像风格迁移技术的APP，用户可以上传图像到这些APP来生成特定艺术风格滤镜的图像，然后进一步在社交平台上分享。但是这些软件都需要开通会员才能随意使用这些风格模板，并且风格迁移之后的图像除了用于社交分享目前还难以有其他的用途。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231848639.png" alt="Prisma风格迁移效果"></p><p>但是总体来说，图像风格迁移在其他的艺术创作和社会生产等市场的应用并不充分。因此，利用城市风格迁移模型生成不同风格的城市图像，在社交平台、艺术创作和社会生产等市场具有很大的应用潜力去挖掘。</p><h2 id="市场需求分析">市场需求分析</h2><h3 id="游戏制作">游戏制作</h3><p>在一款游戏的开发中，场景美术资源的设计与制作是重要且繁琐的，特别是城市场景的设计。如果将我们的城市风格迁移模型应用到游戏中的城市场景设计工作中，一定可以节约美术成本，节省开发周期。比如：在某款游戏的城市场景设计中，制作组希望城市总体呈现一个类似真实生活场景的风格，那么在原画设计中就可以利用我们的城市风格迁移模型，并让模型在真实城市场景数据集和游戏城市场景数据集上进行训练。那么制作组就可以很轻松地得到具有真实场景风格的游戏城市场景设计图，并用于后续的场景贴图或者场景3D建模。</p><p>此外，如果玩家在游玩过程中不喜欢某款游戏的城市风格，还可以启用内置在游戏中的城市风格迁移模型，在游戏中对城市场景的风格进行切换，比如中世界风格、漫画风格等等。总之，我们的城市风格迁移模型在游戏场景的设计中具有很大潜在市场。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231923138.png" alt="利用风格迁移技术，将绝地求生的场景风格迁移到堡垒之夜的场景中"></p><h2 id="社交互动">社交互动</h2><p>利用在真实城市场景和古风、卡通、艺术家等不同风格图像上训练的城市风格迁移模型，用户可以很轻松的获取带有不同风格的城市图像，然后在社交平台上分享。此外，当用户在城市中拍摄视频或者开直播时，配合高精度的人体检测技术，用户可以选择不同的风格来对背景中的城市场景进行单独迁移，增加其直播的趣味性和观看性。考虑到当下抖音等短视频直播平台的火爆，我们的城市风格迁移模型的潜在市场是很大的。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231944797.png" alt="直播背景风格迁移效果图"></p><h3 id="社会保障">社会保障</h3><p>基于CycleGAN的风格迁移算法在图像去噪上有着不错的表现，这当然也可以应用到城市场景中。当前各大城市的街道上遍布摄像头，但是这些摄像头的分辨率有高有低，甚至部分位置的摄像头受到损坏导致监控图像中噪音很多，还可能受到雨雾天气的影响而导致监控图像模糊不清。那么这个时候就可以利用我们的城市风格迁移模型，将低分辨率的城市监控图像转换成高分辨率的、将带噪音风格的城市监控图像转换为噪音少甚至不带噪音的，这可以为保障城市治安做出巨大贡献。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103231959094.png" alt="通过图像风格迁移对场景去雾的效果图"></p><h3 id="建筑规划">建筑规划</h3><p>CycleGAN在从草图生成含有丰富细节的对应真实图像的任务上具有不错的表现，因此我们希望可以将其扩展到建筑物设计草图的转换上。在城市建筑规划设计中，从设计图纸到真实的建筑物是一个漫长的过程。施工方可以利用我们的城市风格迁移模型，在图纸照片和已经建好建筑物图像数据集上进行训练，那么就可以把图纸上的建筑物草图转换成具有真实场景风格的城市建筑物，可以更好地指导建设的进行，这在城市的建设中具有很重要的意义。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232014685.png" alt="利用风格迁移技术将草图转换成真实风格图像"></p><h2 id="政策分析">政策分析</h2><p>我国高度重视人工智能技术进步与行业发展，人工智能已上升为国家战略。当前，新一代人工智能正在全球范围内蓬勃兴起，它既是推进经济发展的新型引擎，又是引领未来社会的战略产业。为了在新一轮国际科技竞争中掌握主导权，我国加快人工智能行业布局与规划，先后出台了《新一代人工智能发展规划》《促进新一代人工智能产业发展三年行动计划（2018-2020年）》《关于促进人工智能和实体经济深度融合的指导意见》《关于“双一流”建设高校促进学科融合加快人工智能领域研究生培养的若干意见》等重要文件，进一步促进我国人工智能行业发展。</p><p>为加强人工智能领域标准化顶层设计，推动人工智能技术研发和标准制定，促进产业健康可持续发展，国家标准化管理委员会、中央网信办、国家发展改革委、科技部、工业和信息化部五部门已于2020年8月印发《国家新一代人工智能标准体系建设指南》，指南提出国家新一代人工智能标准体系总体要求、建设思路、建设内容等。人工智能标准体系结构主要包括“A基础共性”“B支撑技术与产品”“C基础软硬件平台”“D关键通用技术”“E关键领域技术”“F产品与服务”“G行业应用”“H安全/伦理”等八个部分。《国家新一代人工智能标准体系建设指南》指出：2021年，明确人工智能标准化顶层设计，研究标准体系建设和标准研制的总体规则，明确标准之间的关系，指导人工智能标准化工作的有序开展，完成关键通用技术、关键领域技术、伦理等20项以上重点标准的预研工作。标准化工作对人工智能及其产业发展具有基础性、支撑性、引领性的作用，既是推动人工智能行业创新发展的关键抓手，也是产业竞争的制高点。当前，我国出台了诸多人工智能相关的国家标准和行业标准，涵盖了云计算、人脸识别、指纹识别、智能语音、工业机器人等领域。</p><p>在如此需求背景下，使用MindSpore中TinyMS完成CycleGAN网络的训练实现风格迁移不仅具有实际价值，更具有积极意义。</p>]]></content>
      
      
      <categories>
          
          <category> 人工智能 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大学生竞赛 </tag>
            
            <tag> 项目开发 </tag>
            
            <tag> 机器视觉 </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>智航——解决老年人出行难问题的智慧助行产品设计开发报告</title>
      <link href="/87ce7af/"/>
      <url>/87ce7af/</url>
      
        <content type="html"><![CDATA[<h1 id="摘要-2">摘要</h1><p>人口老龄化是许多国家普遍存在的社会现象，中国也不例外，一系列与之相关的老年问题也接踵而至。其中，对于老年人这一群体的生活出行问题就亟待改善。</p><p>本报告就老年人出行难问题提出优化方案——智慧导航卡套，其核心功能是语音识别、智慧导航和一键呼救功能等。我们放弃打字输入，是因为老年人大多数对打字系统不熟悉，打字输入使用会有困难；我们的导航形式包括语音导航和可视化屏幕，这样的设计是为了满足不同老年人的需求，有的老年人可能听力不太好，那么就可以通过看屏幕来明确要去的方向。</p><p>通过对当前老人产品市场的分析与创新，期望助力改善老人群体对于科技产品的使用体验，希望本产品可以有效解决老年人出行难问题，促进智慧城市、智慧养老体系的统筹构建。</p><h1 id="前期设计">前期设计</h1><h2 id="问题背景">问题背景</h2><p>地铁或公交车站离最后的目的地往往还有一些距离，初来此地的人们可能需要一些协助才能到达他们最终的目的地。能够熟练或较为熟练使用智能手机的中年人和年轻人可以依靠导航软件轻松得到帮助，但对于不太会用智能手机的老年人，这最后一公里可能成为他们出门的阻碍。</p><p>由于老龄群体规模不断扩大，为改善老年人出行体验，该问题亟待改善。</p><h2 id="设计目标">设计目标</h2><p>我们想要设计一款产品，来帮助不能熟练使用智能手机、不会使用手机上的导航产品、不太能看懂路标和读地图有困难的老人设计一款具有导航功能的助行产品。产品能够通过简单的操作理解用户的指令（比如了解用户想去哪），给出能被用户轻松理解的反馈，并能准确、安全地将用户带到目的地。</p><p>设计约束：便携性：产品应该便于携带，产品尺寸以不大于8cm*12cm为宜；考虑到老人群体的消费习惯，产品的硬件成本以600元为底线。</p><p>最终的设计目标参考如下：</p><ul><li>指令精确程度：95%指令正确；</li><li>指令识别精准度：准确识别准确度不低于80%；</li><li>定位精准度：10米以内；</li><li>最大反馈延迟：3秒；</li><li>稳定性：单次稳定工作时长下限为6小时；</li><li>规格：重量不大于1千克，尺寸不大于8cm*12cm。</li></ul><h2 id="设计过程">设计过程</h2><p>为了能让设计顺利完成并且满足大多数用户的需求，我们对于用户群体以及产品的使用场景的假设并不极端。我们假设的用户群体是不能熟练使用智能手机、不会使用手机上的导航产品、不太能看懂路标和读地图有困难的老人们，但同时他们也拥有着愿意去学习、去理解一个新产品的使用并解决自己的出行问题的主观意愿。</p><p>而于此同时我们假设的应用场景是在地面较为平坦而且GPS信号稳定的区域。这样的环境能保证我们产品功能正常发挥其功能。</p><p>我们设计的这款产品，系统上有以下功能：</p><ul><li>利用语音给用户播报导航内容；</li><li>将导航内容转换为图像的形式供用户查看；</li><li>利用GPS确定用户当前位置和行进方向；</li><li>提供按键让用户可以“一键呼救”；</li><li>提供超声波测距功能，当周围有用户没能注意到的障碍物时进行提示；</li><li>提供语音交互功能让用户能简单地告诉产品自己的目的地</li></ul><p>由于本产品以卡套为外部造型设计，所以在成本上的花销主要集中在核心部件的实现上。按键相关的交互内容会有很高的准确性，而语音交互内容的识别准确度或许会稍欠一筹，但产品会向用户再次确认语音输入的内容是否转换正确，以保证指令的识别准确度能够符合工程规范。</p><p>卡套的外部材质方面，我们设计为皮质，力求质感和耐用性能同时在产品上得到体现。核心部件通过主板、扬声器等组成，均选用可回收型材料，利用铝合金和卡套外部进行结合。电池方面我们选择了锂电池，它是当今最为普遍的电池种类，能保证成本在一定范围内。</p><p>DFX分析结果如下表。</p><table><thead><tr><th style="text-align:center">序号</th><th style="text-align:center">特征</th><th>评估结果</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">可制造性（DFM）</td><td>高。因为产品设计中并没有选择较为新颖的、量产较为困难的材料或者部件，所以产品的各个部件应该都是可以被量产化的。</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">可装配性（DFA）</td><td>中等。除了将系统主体部分组装完成外，生产产品时还需要将主体和外部卡套紧密结合在一起，基本保证外部只有按键可进行交互，而使用过程中不需要在意主体系统是否会遗失。这导致了产品的装配过程会较为复杂。</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">可测试性（DFT）</td><td>中等。产品的各种功能都能有很多方式去进行测试，但是由于组装过程中已经将卡套整体封装完毕，所以如果产品出现问题会较难去探查出问题的原因。</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">可靠性（DFT）</td><td>高。产品的每个功能都正常运行时有高可靠性。</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">面向环保的设计（DFE）</td><td>高。产品所使用的材料除电池外都能较好地被回收，对环境没有影响。</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">可服务性（DFS）</td><td>中等。产品能和用户进行多种类型的交互来进行服务，但如果产品提供的所有交互方式都不能让用户满意，那么产品将无法提供更多的服务。</td></tr></tbody></table><h1 id="产品测试与分析">产品测试与分析</h1><h2 id="测试计划和结果">测试计划和结果</h2><p>1、测试计划：</p><ul><li>测试语音模块，即喇叭是否正常工作；</li><li>测试oled屏幕是否正常工作；</li><li>测试报警模块，即蜂鸣器和红色小灯是否正常工作；</li><li>测试短信收发功能是否正常工作；</li><li>整合语音模块和oled屏幕，并测试其是否正常工作；</li><li>整合报警模块和短信收发功能，并测试其是否正常工作。</li></ul><p>2、测试结果：</p><ul><li>语音模块能够清晰地发出指引信息以及路段情况；</li><li>oled屏幕能将图片清晰可见地显示出来；</li><li>报警模块能正常工作；</li><li>短信收发功能正常工作；</li><li>整合后，语音模块和oled屏幕能很好地配合在一起，即当语音说向左转时，图片会显示左转提示。<img src="https://cdn.jsdelivr.net/gh/asa-pic/pic_1/img/image-20220831232356292.png" alt="语音与可视化模块展示"></li><li>报警模块与短信收发功能能很好地配合<img src="https://cdn.jsdelivr.net/gh/asa-pic/pic_1/img/image-20220831233652247.png" alt="通信模块展示"></li></ul><h2 id="材料清单BOM">材料清单BOM</h2><p>零部件费用只包括最后设计中所包含的物品。详细的材料清单包括(可能的话)制造厂商、零件编号、零件描述、供应商、数量和成本。</p><p>本产品所需美科套件如表2.1。</p><table><thead><tr><th>零件</th><th>描述</th><th style="text-align:center">数量</th><th>零件编号</th></tr></thead><tbody><tr><td>MCookie-Core+板子</td><td>128KB的Flash，16KB的SRAM，可方便、灵活的与其他符合 Microduino/mCookie 接口规范的模块、传感器进行快速的连接和扩展；</td><td style="text-align:center">2</td><td>ATmega644PA/1284P</td></tr><tr><td>mCookie-OLED屏幕</td><td>mCookie-OLED 显示模块，屏幕0.96 吋大小，分辨率128*64像素点。采用IIC驱动，可以直接叠加在mCookie的大多数模块上，或接到mCookie-Hub/zh的IIC接口与核心连接通讯</td><td style="text-align:center">1</td><td>MCBS11</td></tr><tr><td>mCookie-BLEUPLOAD蓝牙模块</td><td>BLEUPLOAD是一种蓝牙透传模块，固定了串口与波特率</td><td style="text-align:center">1</td><td>MCBS11</td></tr><tr><td>MCookie-Module  AudioPro音频模块</td><td>mCookie-AudioPro是以VS1053为解码器，集成2.2W立体声功放，并且支持2.5mm立体声耳机接口的多功能音频模块，支持MIDI功能</td><td style="text-align:center">1</td><td>xxxxxx   （真是这个，没骗你）</td></tr><tr><td>MCookie-GPS模块</td><td>核心采用UBLOX NEO-6M模组，高灵敏度，更新速率最高可达5Hz，采用IPEX接口的迷你陶瓷天线，自带可充电后备电池</td><td style="text-align:center">1</td><td>xxxxxx</td></tr><tr><td>6.mCookie-Hub接线板</td><td>mCookie-Hub是为了配合Microduino 传感器系列制作的,可以扩展大量数字/模拟接口的传感器扩展板</td><td style="text-align:center">1</td><td>MCBH11</td></tr><tr><td>Sensor-Crash开关</td><td>Sensor-Crash是一种碰撞传感器，用来检测是否发生碰撞，也可称为碰撞信号传感器，可做按键开关、限位开关用</td><td style="text-align:center">1</td><td>MSDS11</td></tr><tr><td>喇叭</td><td>可与音频模块相连的喇叭</td><td style="text-align:center">1</td><td></td></tr><tr><td>Sensor-LED</td><td>Sensor-LED 直接控制的LED灯，有红、绿、黄三种型号</td><td style="text-align:center">1</td><td>MSLT63</td></tr><tr><td>10.Sensor-Buzzer蜂鸣器</td><td>Sensor-Buzzer是无源蜂鸣器，和电磁扬声器一样，需要高低变化不同频率的电压才能发声。频率越高则音调越高。</td><td style="text-align:center">1</td><td>MSDO11</td></tr><tr><td>Sensor-IO DuPont</td><td>杜邦线，接引脚用</td><td style="text-align:center">5个以上</td><td></td></tr><tr><td>乐高拼板</td><td>用以设计产品外壳，封装用</td><td style="text-align:center">1</td><td></td></tr></tbody></table><p>总成本：七千多（消息来源：徐sir）</p><h2 id="甘特图">甘特图</h2><p><img src="https://cdn.jsdelivr.net/gh/asa-pic/pic_1/img/image-20220831234122039.png" alt="甘特图"></p><h2 id="道德伦理方面的考虑">道德伦理方面的考虑</h2><ol><li>善待并尊重老年人：不能主观地按照年轻人地思维习惯去解释，而要考虑到老年人的习惯、是否适应等方面。因此在产品介绍和说明，以及产品的功能上都要与老年人所遇到的问题相贴切。</li><li>平等：平等是老年伦理必须遵循的基本原则。对待老年人，不分年龄、性别、民族、贫富、高矮,都要—视同仁。而我们设计的产品为卡套，价格、大小、便携等都符合了我们对有效服务老年人的期待。</li><li>以老年人为主体：一切以为老年人服务为准，在选择产品材料、实现产品功能、产品实用验证等方面都以老年人为主体，全方位考虑。为产品的工程特性设定要实现的目标，使其满足用户需求。</li></ol><h2 id="安全性">安全性</h2><ol><li>本智能设备内含高灵敏度电子元器件，跌落、焚烧、穿刺或碾压均会造成本设备损坏。塑料制成的本设备外壳在跌落或受力冲击时可能会破碎或破裂。请勿使用已损坏的本设备，如屏幕或外壳碎裂、明显渗液，因为可能导致受伤。请勿打开本设备内部和尝试自行维修本设备。拆卸本设备可能会造成损坏、导致其不再抗水并可能导致您受伤。</li><li>请勿尝试自行更换本设备电池，您可能会损坏电池，从而导致过热和人身伤害。电池必须单独回收或处理，不可混于生活垃圾。请勿焚烧电池。</li><li>某些情形下使用本设备会分散您的注意力，有可能造成危险（例如，避免横过马路时查看前进方向）。请遵守禁止或限制使用智能设备的规定。</li><li>地图、路线以及基于位置的功能均依赖数据服务。这些数据服务会随时变更，而且并非所有区域都可用，因此这些服务所提供的地图、路线或者基于位置的信息可能会不可用、不准确或不完整。某些“地图”功能要求使用“定位服务”。请将本设备上提供的信息与周围的环境比较并遵守路标，以解决任何偏差。使用本设备时，请始终遵守路标，遵守所在地区的法律和法规并运用常识。</li><li>本设备使用USB-A转USB-C连接线和快速充电器充电，请使用符合USB 2.或后续标准且符合适用的国家/地区法规及国际和地区安全性标准的电源适配器及连接线。其他适配器和连接线可能不满足适用的安全标准，而使用这样的适配器及连接线充电可能会有死亡或者受伤风险。</li><li>使用损坏的线缆或充电器，或者在潮湿环境下充电会导致火灾、电击、受伤或损坏本设备或其他财物。</li><li>长时间接触高温本设备可能会导致设备损坏或起火。</li><li>用高音量听信息会损坏听力。背景噪音和持续暴露在高音量下，会让声音听起来比实际音量小。</li><li>本智能设备使用正常的移动网络通信模块，正常使用符合射频暴露限制。为了减少射频暴露，可适当增加使用者和产品的距离，在较长时间段不适用的情况下建议不要随身携带。</li></ol><h1 id="结论">结论</h1><p>简言之，我们设计的产品致力于以一种老年人容易接受的方式帮助老年人更好能完成到达目的地最后可能需要的几百米步行。借助卡包这种外在形式让老年人更快地接受我们的产品。设计过程充分了解了老年人可能的障碍和主要诉求针对性的采用简单无感的语音交互方式，产品的功能也更加适用于老年人步行导航的特点，增加了超声波避障提醒功能和一键呼救模块。在具体的原型制作中也逐步发现问题解决问题，最终制作的原型较好地体现了我们的设计理念以及完成了设计要求。</p><blockquote><p>鸣谢：立鑫子、佳佳子、琦琦子、鑫康子、棋棋子</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 项目报告 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vercel部署twikoo的访问问题，vercel的默认域名时不时被墙</title>
      <link href="/5f3bb65c/"/>
      <url>/5f3bb65c/</url>
      
        <content type="html"><![CDATA[<h2 id="BUG">BUG</h2><p>腾讯云开发弃坑后转为vercel + MongoDB部署twikoo。部署好后原以为万事大吉，没想到今天有朋友访问本站的时候说无法评论。不应该啊在我的电脑上可以评论啊，怎么到他那就不行了呢？于是我用ipad试了下也不行，加载很长时间也无法显示。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230117104.png" alt="ipad端访问截图"></p><h2 id="分析">分析</h2><p>我首先想到了IP问题，难道我在MongoDB中限制了访问IP连接？检查是正确的（0.0.0.0就表示支持所有IP连接）。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230128036.png" alt="MongoDB连接性设置"></p><p>后来我突然想起来难道是代理的原因？于是我在电脑上关掉代理后发现确实访问不了了，而挂上代理就可以。于是我把MongoDB的节点换到了香港区（开始为美国东一区），然而，还是不行…</p><h2 id="解决方法">解决方法</h2><p>请教大佬后，原来vercel的默认域名（*.vercel.app）在大陆出现了些问题，解决方法是再找个域名绑定。</p><p>由于我已经有一个域名&quot;<a href="http://asa-world.cn">asa-world.cn</a>&quot;，只要再配置个二级域名解析过去就可以了。</p><details class="folding-tag" cyan open><summary> 腾讯云添加二级域名 </summary>              <div class='content'>              <ol><li>进入<a href="https://console.dnspod.cn/dns">腾讯云域名控制台</a>，点击<strong>添加记录</strong></li><li>配置相应的记录（左下角也会有相应的提示），记录类型选择CNAME，<a href="http://xn--cname-dq1h016a5a088f752a9q1ctv8b.vercel-dns.com">要指向的域名为cname.vercel-dns.com</a>，点击<strong>确定</strong><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230139545.png" alt="配置示例"></li><li>二级域名添加成功，你也可以加个监控</li></ol>              </div>            </details><details class="folding-tag" green open><summary> vercel绑定域名 </summary>              <div class='content'>              <ol><li>在vercel中打开你的twikoo项目</li><li>依次点击 <strong>Settings</strong> -&gt; <strong>Domains</strong></li><li>在输入框中输入刚才你设置的二级域名，点击 <strong>ADD</strong><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230155709.png" alt="vercel绑定二级域名"></li><li>等待其自动连接即可</li><li>最后别忘了在博客主题配置文件中将twikoo配置中的环境ID改为你的二级域名</li></ol>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> 问题修复 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客搭建 </tag>
            
            <tag> 教程 </tag>
            
            <tag> bug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【搞笑】博客中js音乐播放问题，直链你最好有事</title>
      <link href="/fe476b11/"/>
      <url>/fe476b11/</url>
      
        <content type="html"><![CDATA[<h2 id="BUG-3">BUG</h2><p>在本地主机上可以使用Web <em>Audio</em> API中的 .play 播放音乐直链的音频，但在安全域名上则不行，控制台显示410错误。</p><p><img src="https://cdn.jsdelivr.net/gh/asa-pic/pic_1/img/image-20220824182637591.png" alt="控制台报错"></p><h2 id="分析-2">分析</h2><p>因为在本地主机上可以访问直链，首先排除直链的问题。然后我怀疑是音频加载和dom节点的加载有时间差，导致无法播放，使用 setTimeout 延迟播放后还是不行。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123; xxx; &#125;, <span class="number">5000</span>);  <span class="comment">//5秒后将会调用执行xxx函数</span></span><br></pre></td></tr></table></figure><p>我们先分析下410和404。</p><p>404代码表示请求的资源当前不可用，但它可能在未来的请求中可用。相反，410代码是一个明确的指示，表明所请求的资源曾经存在，但它已被永久删除并且不会将来可用。因此，404响应代码表示用户代理（浏览器）可以重复对同一资源的请求URI，而 410告诉用户代理不要重复对同一资源的请求。</p><p>难道资源真的没了？于是我直接打开了那个音频的直链，结果真的是410，笑死我了，原来直链真的崩了，我猜测直链是有生命周期的，每隔一段时间就会更新。但是奇怪的是在本地主机上访问直链可以，就很离谱，咱也不懂，咱也不敢问。</p><h2 id="解决方法-3">解决方法</h2><p>打算换个直链，我找了半天酷我的api，找了半天没找到，就找到一个跨域的，直接用js不行，先贴上网站以后备用吧。<a href="https://www.homedt.net/25515.html">https://www.homedt.net/25515.html</a></p><p>后来我发现一个<a href="https://www.codeleading.com/article/60082581961/">教程</a>，听说网易云的直链很好扒，于是就换成了网易云的直链了，真的可以了（不过还是只能解析非会员的。</p>]]></content>
      
      
      <categories>
          
          <category> 问题修复 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客搭建 </tag>
            
            <tag> bug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用SDN网络架构的Ford-Fulkerson算法实践</title>
      <link href="/5c5a2704/"/>
      <url>/5c5a2704/</url>
      
        <content type="html"><![CDATA[<h1 id="项目要求">项目要求</h1><ol><li>利用网络中有限的流表测量网络中所有流的大小；</li><li>使用最大匹配算法求解测量方案；</li><li>将测量到的流大小在可视化平台上进行展示。</li></ol><h1 id="Ford-Fulkerson-算法">Ford-Fulkerson 算法</h1><h2 id="基本思想">基本思想</h2><p>最大流问题，一种组合最优化问题，就是要讨论如何充分利用装置的能力， 使得运输的流量最大，以取得最好的效果。而对于所有边的权重都非负的图来说，最大流问题需要解决的就是在每个边都对流量有所限制的前提下，最多能将多少流从起点输送到终点。</p><p>在图中有以下规则：除了源和终点以外，其他每个点的流入等于流出；所有边的流量都不超过运载值。</p><p>求出最大流的方法有很多。其中，Ford-Fulkerson 方法，即增广路方法， 简称 FF 方法是一种基础的求最大流方法。它的精髓就是加了一条反向边，加速了寻找最优路径的过程。哪怕一开始我们选择的路径是错误的，我们也可以通过后悔边不断去修正这个错误，以此达到最后正确的结果（把所有错误的情况修正了，就是正确的结果之一）。</p><p>其核心思路是：每次找出一条从源到汇的能够增加流的路径，调整流值和残留网络，不断调整直到没有增广路为止。简单来说就是，通过 DFS 或者 BFS 増广，直到不能増广为止。FF 方法的基础是：增广路定理——网络达到最大流， 当且仅当残留网络中没有增广路。</p><h2 id="基本步骤">基本步骤</h2><ol><li>给每条有向边初始化一条容量为 0 的反向边。并且初始化设置起点为已经访问过</li><li>开始从起点进行 DFS，对和顶点相连的边进行检查，如果下个顶点未被访问并且此条边仍有流量就走这条边，记录此边容量并与之前的记录进行比较（没有比较就直接记录），取其中容量最小值，并以此顶点为起点进行下一轮 DFS，即进入（1）。</li><li>当 DFS 进行不下去，也就是到达终点时，对沿路的所有边容量，全部减去（2）中记录的容量最小值，并且给每条边的反向边容量增加同样大小的容量，并且将（2）中记录的容量最小值进行累加。</li><li>当整个循环过程完成，说明以源为起点无法继续找到可行的能到达终点的增广路径，则算法结束。（3）中累加所得的最终值即为最大流的量。</li></ol><h2 id="示例">示例</h2><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225704846.png" alt="示例拓扑图"></p><p>对上图，设置 1 和 5 分别为源点和终点，进行 FF 算法。</p><ol><li>以 sum 记录最大流的量，初始化 sum=0。以 flow 记录单次 DFS 中发现的最小容量，flow=0；</li><li>从 1 进行 DFS,先寻找到 1-&gt;2-&gt;3-&gt;5 这条路，flow=min(4,2,4),即 flow=2，让 sum 值加上 2，并且将 1-&gt;2 修改为 2，2-&gt;3 修改为 0，3-&gt;5 修改为 2，并且对应地增加反向边容量。</li><li>继续，接下来发现 1-&gt;2-&gt;4-&gt;5 这条路，flow=2,sum=4,同样减少正向边容量，增加反向边容量。</li><li>继续，接下来发现 1-&gt;3-&gt;5 这条路，flow=2，sum=6，同样减少正向边容量，增加反向边容量。</li><li>继续，接下来发现 1-&gt;3-&gt;2-&gt;4-&gt;5 这条路（这里走了反向边 3-&gt;2， 容量为 2），flow=1，sum=7，同样减少正向边容量，增加反向边容量。</li><li>此时图变为如下图，可以看出，此时没有正向路径能让 1 推送流到 5， 则算法结束，最大流大小为 7。</li></ol><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225719323.png" alt="剩余网络图"></p><h1 id="算法实现">算法实现</h1><h2 id="实现思路">实现思路</h2><p>EK 算法作为 FF 算法的一个特例，是在 FF 方法基础上，通过 dijkstra 选择跳数最短路来作为优先选择的遍历路径，以此来降低发现最大流所需的时间。故而主要的代码包括 dijkstra 跳数最短路的选取和 FF 的调用两部分，除此之外，要实现要求的功能，还需要计算最大流中流量最大的路径以及最大流的流量，以及当反向边上发生“反悔”事件时，还需要记录抵消的路径和打印真实路径。</p><h2 id="代码实现">代码实现</h2><h3 id="dijkstra-发现跳数最短路">dijkstra 发现跳数最短路</h3><p>（1）节点信息的初始化</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dijkstra</span>(<span class="params">self, src_mac, dst_mac, rest</span>): <span class="number">2.</span> <span class="number">3.</span> run = dst_mac <span class="comment">#从宿点开始找</span></span><br><span class="line">nodeinfo = &#123;&#125;</span><br><span class="line">    nodeinfo.setdefault(src_mac, &#123;&#125;)</span><br><span class="line">    nodeinfo.setdefault(dst_mac, &#123;&#125;)</span><br><span class="line">    <span class="comment">#此处的源点和宿点均指相对于所要找的路径</span></span><br><span class="line">    nodeinfo[src_mac].setdefault(<span class="string">&#x27;height&#x27;</span>, <span class="number">99999999</span>) <span class="comment">#源点距宿点的跳数设为无穷大</span></span><br><span class="line">    nodeinfo[src_mac].setdefault(<span class="string">&#x27;unchecked&#x27;</span>, <span class="number">1</span>) <span class="comment">#源点初始化为未标记</span></span><br><span class="line">    nodeinfo[src_mac].setdefault(<span class="string">&#x27;father&#x27;</span>, -<span class="number">1</span>) <span class="comment">#父节点为空</span></span><br><span class="line">    nodeinfo[dst_mac].setdefault(<span class="string">&#x27;height&#x27;</span>, <span class="number">0</span>) <span class="comment">#宿点离自己的跳数为 0</span></span><br><span class="line">    nodeinfo[dst_mac].setdefault(<span class="string">&#x27;unchecked&#x27;</span>, <span class="number">0</span>) <span class="comment">#宿点初始化为已标记</span></span><br><span class="line">    nodeinfo[dst_mac].setdefault(<span class="string">&#x27;father&#x27;</span>, -<span class="number">1</span>)<span class="comment">#宿点父节点为空</span></span><br></pre></td></tr></table></figure><p>（2）发现最短路</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> run != src_mac: </span><br><span class="line">    <span class="keyword">for</span> neighbor <span class="keyword">in</span> self.adjacent[run]:</span><br><span class="line">        nodeinfo.setdefault(neighbor, &#123;&#125;)</span><br><span class="line">        nodeinfo[neighbor].setdefault(<span class="string">&#x27;height&#x27;</span>, <span class="number">9999999</span>)</span><br><span class="line">        nodeinfo[neighbor].setdefault(<span class="string">&#x27;unchecked&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">        nodeinfo[neighbor].setdefault(<span class="string">&#x27;father&#x27;</span>, -<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> link <span class="keyword">in</span> self.links: </span><br><span class="line">            <span class="keyword">if</span> link[<span class="string">&#x27;src_dpid&#x27;</span>] == run <span class="keyword">and</span> link[<span class="string">&#x27;dst_dpid&#x27;</span>] == neighbor: </span><br><span class="line">                <span class="keyword">if</span> nodeinfo[neighbor][<span class="string">&#x27;height&#x27;</span>] &gt; nodeinfo[run][<span class="string">&#x27;height&#x27;</span>]+<span class="number">1</span> <span class="keyword">and</span> rest[link[<span class="string">&#x27;dst_dpid&#x27;</span>]][link[<span class="string">&#x27;src_dpid&#x27;</span>]] &gt; <span class="number">0</span>:<span class="comment">#防止成环，以及发现路径</span></span><br><span class="line">                    nodeinfo[neighbor][<span class="string">&#x27;height&#x27;</span>] = nodeinfo[run][<span class="string">&#x27;height&#x27;</span>]+<span class="number">1</span><span class="comment">#跳数加一</span></span><br><span class="line">                    nodeinfo[neighbor][<span class="string">&#x27;father&#x27;</span>] = run<span class="comment">#更新父节点</span></span><br><span class="line">                <span class="keyword">break</span> <span class="comment">#update 操作</span></span><br><span class="line">                <span class="comment">#寻找最短跳数</span></span><br><span class="line">        min_height = <span class="number">99999</span></span><br><span class="line">        <span class="keyword">for</span> new_run <span class="keyword">in</span> nodeinfo.keys(): </span><br><span class="line">            <span class="keyword">if</span> nodeinfo[new_run][<span class="string">&#x27;unchecked&#x27;</span>] <span class="keyword">and</span> nodeinfo[new_run][<span class="string">&#x27;height&#x27;</span>] &lt; min_height: </span><br><span class="line">                min_height = nodeinfo[new_run][<span class="string">&#x27;height&#x27;</span>]</span><br><span class="line">                run = new_run </span><br><span class="line">        <span class="keyword">if</span> nodeinfo[run][<span class="string">&#x27;unchecked&#x27;</span>]: </span><br><span class="line">            nodeinfo[run][<span class="string">&#x27;unchecked&#x27;</span>] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>: </span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>（3）跳数最短路重建，并返回跳数最短路和该路径上的流量</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> nodeinfo[src_mac][<span class="string">&#x27;unchecked&#x27;</span>]: <span class="comment">#到最后 src_mac 也没有被检查到，则说明已经没有增广路径了，返回值为空</span></span><br><span class="line">    <span class="keyword">return</span> [], <span class="number">0</span></span><br><span class="line"><span class="keyword">else</span>: <span class="comment">#有增广路径则按正序重建路径，并返回路径和路径上的流量</span></span><br><span class="line">    father = src_mac </span><br><span class="line">    path = []</span><br><span class="line">    <span class="keyword">while</span> father != dst_mac: </span><br><span class="line">        path.append(father)</span><br><span class="line">        father = nodeinfo[father][<span class="string">&#x27;father&#x27;</span>]</span><br><span class="line">    path.append(dst_mac)</span><br><span class="line">    path_bw = self.min_bw(path, rest) <span class="comment">#调用函数，求路径上的流量</span></span><br><span class="line">    <span class="keyword">return</span> path, path_bw</span><br></pre></td></tr></table></figure><h3 id="FF-算法">FF 算法</h3><p>（1）初始化</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ford_fulkerson</span>(<span class="params">self, src_mac, dst_mac</span>): </span><br><span class="line">    flow = &#123;&#125;</span><br><span class="line">    rest = &#123;&#125;</span><br><span class="line">    cur_path = []</span><br><span class="line">    bw = <span class="number">0</span></span><br><span class="line">    wid_path = []</span><br><span class="line">    wid_bw = <span class="number">0</span></span><br><span class="line">    max_bw = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    rest = self.update_network([], <span class="number">0</span>, flow)</span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> self.links: <span class="comment">#建立剩余网络的框架</span></span><br><span class="line">        flow.setdefault(link[<span class="string">&#x27;src_dpid&#x27;</span>], &#123;&#125;)</span><br><span class="line">        flow[link[<span class="string">&#x27;src_dpid&#x27;</span>]].setdefault(link[<span class="string">&#x27;dst_dpid&#x27;</span>], <span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>（2） 循环增加流量，直到无法找到从源点到宿点的增广路径</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    cur_path, bw = self.dijkstra(src_mac, dst_mac, rest)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(cur_path) == <span class="number">0</span>: </span><br><span class="line">        Break</span><br><span class="line">    <span class="comment">#无法找到从源点到宿点的增广路径时 cur_path 获取到的返回值为空，退出循环</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;available path:&#123;&#125; bw:&#123;&#125;Mbps&quot;</span>.<span class="built_in">format</span>(cur_path, bw)) <span class="comment">#打印参与到最大流的路径，注意，此时可能会发生 cancel，即反向推送</span></span><br><span class="line">    max_bw += bw <span class="comment">#求最大流</span></span><br><span class="line">    rest = self.update_network(cur_path, bw, flow)<span class="comment">#剩余网络更新</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> self.cancel_flag == <span class="number">0</span> <span class="keyword">and</span> wid_bw &lt; bw:<span class="comment">#如果全程没有发生反向推送，则此时的路径与现实情境下会发生的实际情况相同</span></span><br><span class="line">        wid_path = cur_path</span><br><span class="line">        wid_bw = bw </span><br><span class="line">        </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;max flow after detection:&#123;&#125;Mbps.&quot;</span>.<span class="built_in">format</span>(max_bw))<span class="comment">#打印最大流的流量</span></span><br></pre></td></tr></table></figure><p>（3）考虑到现实情境下，“反悔”现象不会发生，因此产生了路径抵消时需要 在总的路径上做一些修改，以得到最后的真实路径</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> self.cancel_flag == <span class="number">1</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Cancellations happened!&quot;</span>)</span><br><span class="line">    cur_path, bw = self.dijkstra(src_mac, dst_mac, flow)<span class="comment">#在最终的流量网络上重新运行 dijkstra 算法，找最短路来进行路径增广</span></span><br><span class="line">    wid_path = cur_path</span><br><span class="line">    wid_bw = bw</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(cur_path) != <span class="number">0</span>: </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Real-path:&#123;&#125; &#123;&#125;Mbps&quot;</span>.<span class="built_in">format</span>(cur_path, bw))</span><br><span class="line">            <span class="keyword">if</span> bw &gt; wid_bw:</span><br><span class="line">                wid_path = cur_path</span><br><span class="line">                wid_bw = bw</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(cur_path)-<span class="number">1</span>): </span><br><span class="line">                flow[cur_path[i]][cur_path[i+<span class="number">1</span>]] -= bw <span class="comment">#更新流量网络</span></span><br><span class="line">                cur_path, bw = self.dijkstra(src_mac, dst_mac, flow) <span class="comment">#在更新后的流量网络上运行 dijkstra 寻找增广路径</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">self.cancel_flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">return</span> wid_path, wid_bw</span><br></pre></td></tr></table></figure><h3 id="剩余网络更新">剩余网络更新</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">update_network</span>(<span class="params">self, cur_path, cur_bw, flow</span>): </span><br><span class="line">    p = cur_path</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(p)-<span class="number">1</span>): </span><br><span class="line">        <span class="keyword">if</span> flow[p[i]][p[i+<span class="number">1</span>]] == <span class="number">0</span> <span class="keyword">and</span> flow[p[i+<span class="number">1</span>]][p[i]] == <span class="number">0</span>:<span class="comment">#尚未开始增加流量</span></span><br><span class="line">            flow[p[i]][p[i+<span class="number">1</span>]] = cur_bw<span class="comment">#将所选择的路径流量加入流网络</span></span><br><span class="line">        <span class="keyword">elif</span> flow[p[i+<span class="number">1</span>]][p[i]] &gt; <span class="number">0</span> <span class="keyword">and</span> flow[p[i]][p[i+<span class="number">1</span>]] == <span class="number">0</span>:<span class="comment">#边上正向的流量为0，有反向的流量</span></span><br><span class="line">            flow[p[i+<span class="number">1</span>]][p[i]] -= cur_bw<span class="comment">#发生流量抵消</span></span><br><span class="line">            self.cancel_flag = <span class="number">1</span><span class="comment">#流量抵消的标记位</span></span><br><span class="line">        <span class="keyword">else</span>: </span><br><span class="line">            flow[p[i]][p[i+<span class="number">1</span>]] += cur_bw<span class="comment">#将所选择的路径上流量加入流网络</span></span><br><span class="line">    rest = deepcopy(flow)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> self.links:<span class="comment">#构建剩余网络</span></span><br><span class="line">        <span class="keyword">if</span> flow[link[<span class="string">&#x27;src_dpid&#x27;</span>]][link[<span class="string">&#x27;dst_dpid&#x27;</span>]] == <span class="number">0</span> <span class="keyword">and</span> flow[link[<span class="string">&#x27;dst_dpid&#x27;</span>]][link[<span class="string">&#x27;src_dpid&#x27;</span>]] == <span class="number">0</span>:<span class="comment">#边上没有流量，剩余容量即为边的带宽</span></span><br><span class="line">            rest[link[<span class="string">&#x27;src_dpid&#x27;</span>]][link[<span class="string">&#x27;dst_dpid&#x27;</span>]] = link[<span class="string">&#x27;bw&#x27;</span>]</span><br><span class="line">            rest[link[<span class="string">&#x27;dst_dpid&#x27;</span>]][link[<span class="string">&#x27;src_dpid&#x27;</span>]] = link[<span class="string">&#x27;bw&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> flow[link[<span class="string">&#x27;dst_dpid&#x27;</span>]][link[<span class="string">&#x27;src_dpid&#x27;</span>]] &gt; <span class="number">0</span> <span class="keyword">and</span> flow[link[<span class="string">&#x27;src_dpid&#x27;</span>]][link[<span class="string">&#x27;dst_dpid&#x27;</span>]] == <span class="number">0</span>:<span class="comment">#边上反向有流量、正向没有流量</span></span><br><span class="line">            rest[link[<span class="string">&#x27;src_dpid&#x27;</span>]][link[<span class="string">&#x27;dst_dpid&#x27;</span>]] = flow[link[<span class="string">&#x27;dst_dpid&#x27;</span>]][link[<span class="string">&#x27;src_dpid&#x27;</span>]]<span class="comment">#添加反向边</span></span><br><span class="line">            rest[link[<span class="string">&#x27;dst_dpid&#x27;</span>]][link[<span class="string">&#x27;src_dpid&#x27;</span>]] = link[<span class="string">&#x27;bw&#x27;</span>] - flow[link[<span class="string">&#x27;dst_dpid&#x27;</span>]][link[<span class="string">&#x27;src_dpid&#x27;</span>]]<span class="comment">#边上反向的剩余容量为边的容量减去流量</span></span><br><span class="line">    <span class="keyword">return</span> rest</span><br></pre></td></tr></table></figure><h3 id="读取邻接点">读取邻接点</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_adjacent</span>(<span class="params">self, links</span>):</span><br><span class="line">    adjacent = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> links:</span><br><span class="line">        adjacent.setdefault(link[<span class="string">&#x27;src_dpid&#x27;</span>], [])</span><br><span class="line">        adjacent[link[<span class="string">&#x27;src_dpid&#x27;</span>]].append(link[<span class="string">&#x27;dst_dpid&#x27;</span>])</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> adjacent</span><br></pre></td></tr></table></figure><h3 id="找到路径上链路容量的最小值，即能够容纳的最大流量">找到路径上链路容量的最小值，即能够容纳的最大流量</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">min_bw</span>(<span class="params">self, path, rest</span>): </span><br><span class="line">    bw = <span class="number">999999</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(path)-<span class="number">1</span>): </span><br><span class="line">        <span class="keyword">if</span> rest[path[i]][path[i+<span class="number">1</span>]] &lt; bw: </span><br><span class="line">            bw = rest[path[i]][path[i+<span class="number">1</span>]]</span><br><span class="line">    <span class="keyword">return</span> bw</span><br></pre></td></tr></table></figure><h3 id="对-packet-in-模块的修改">对 packet_in 模块的修改</h3><p>（1）将主机和交换机之间的链路加入拓扑网络</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> src <span class="keyword">not</span> <span class="keyword">in</span> self.hosts:</span><br><span class="line">    self.hosts.append(src)</span><br><span class="line">    fd = <span class="built_in">open</span>(<span class="string">&#x27;./topo24.json&#x27;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    topoinfo = json.load(fd)</span><br><span class="line">    host_id = <span class="built_in">int</span>(src.split(<span class="string">&#x27;:&#x27;</span>)[-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">for</span> edge <span class="keyword">in</span> topoinfo[<span class="string">&#x27;links&#x27;</span>]: </span><br><span class="line">        <span class="keyword">if</span> ([<span class="string">&#x27;h&#x27;</span>+<span class="built_in">str</span>(host_id), <span class="string">&#x27;s&#x27;</span>+<span class="built_in">str</span>(dpid)] == edge[<span class="string">&#x27;vertexs&#x27;</span>] <span class="keyword">or</span> [<span class="string">&#x27;s&#x27;</span>+<span class="built_in">str</span>(dpid), <span class="string">&#x27;h&#x27;</span>+<span class="built_in">str</span>(host_id)] == edge[<span class="string">&#x27;vertexs&#x27;</span>]):</span><br><span class="line">            self.links.append(&#123;<span class="string">&#x27;src_dpid&#x27;</span>:src, <span class="string">&#x27;dst_dpid&#x27;</span>:dpid, <span class="string">&#x27;dst_port_no&#x27;</span>:</span><br><span class="line">in_port, <span class="string">&#x27;delay&#x27;</span>:edge[<span class="string">&#x27;delay&#x27;</span>], <span class="string">&#x27;bw&#x27;</span>:edge[<span class="string">&#x27;bw&#x27;</span>]&#125;)</span><br><span class="line"></span><br><span class="line">            self.links.append(&#123;<span class="string">&#x27;src_dpid&#x27;</span>:dpid, <span class="string">&#x27;dst_dpid&#x27;</span>:src, <span class="string">&#x27;src_port_no&#x27;</span>:</span><br><span class="line">in_port, <span class="string">&#x27;delay&#x27;</span>:edge[<span class="string">&#x27;delay&#x27;</span>], <span class="string">&#x27;bw&#x27;</span>:edge[<span class="string">&#x27;bw&#x27;</span>]&#125;)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="配置流量最大的路径">配置流量最大的路径</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> dst <span class="keyword">in</span> self.host_mac_to: </span><br><span class="line">    self.pathes.setdefault(src, &#123;&#125;)</span><br><span class="line">    self.pathes[src].setdefault(dst, [])</span><br><span class="line">    self.pathes.setdefault(dst, &#123;&#125;)</span><br><span class="line">    self.pathes[dst].setdefault(src, [])<span class="comment">#路径初始化</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(self.pathes[src][dst]) == <span class="number">0</span>: </span><br><span class="line">        self.pathes[src][dst], max_bw = self.ford_fulkerson(src, dst)</span><br><span class="line">        self.pathes[dst][src] = self.pathes[src][dst][::-<span class="number">1</span>]</span><br><span class="line">        <span class="comment">#调用 ford_fulkerson 得到返回值作为流量最大的路径</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Widest path:&#123;&#125; &#123;&#125;Mbps&quot;</span>.<span class="built_in">format</span>(self.pathes[src][dst], max_bw))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;================================================================&quot;</span>)</span><br><span class="line">        <span class="comment">#读取正向和反向的端口信息，用于下发流表</span></span><br><span class="line">    next_dpid = self.pathes[src][dst][self.pathes[src][dst].index(dpid)+<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> self.links:</span><br><span class="line">        <span class="keyword">if</span> link[<span class="string">&#x27;src_dpid&#x27;</span>] == dpid <span class="keyword">and</span> link[<span class="string">&#x27;dst_dpid&#x27;</span>] == next_dpid:</span><br><span class="line">            out_port = link[<span class="string">&#x27;src_port_no&#x27;</span>]</span><br><span class="line">            Break</span><br><span class="line">     <span class="comment">#流表配置</span></span><br><span class="line">    actions = [ofp_parser.OFPActionOutput(out_port)]</span><br><span class="line">    <span class="keyword">match</span> = ofp_parser.OFPMatch(in_port=in_port, eth_dst=dst, eth_src=src)</span><br><span class="line">    self.add_flow(datapath, <span class="number">1</span>,<span class="keyword">match</span>, actions)</span><br></pre></td></tr></table></figure><h1 id="成果展示">成果展示</h1><h2 id="拓扑的构建">拓扑的构建</h2><p>（1）mininet侧</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225738246.png" alt="mininet侧拓扑构建"></p><p>（2）RYU 侧</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225804296.png" alt="RYU侧拓扑连接"></p><p>（3）二十四节点网络拓扑可视化</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225833446.png" alt="拓扑可视化"></p><h2 id="Ford-Fulkerson-算法实现">Ford-Fulkerson 算法实现</h2><p>（1）mininet 侧：连通性良好</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225922775.png" alt="mininet侧连通性"></p><p>（2）最大流路径展示（以 h1 ping h8 为例）</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225945953.png" alt="mininet侧带宽信息"></p><p>（3）ryu 侧</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230004883.png" alt="RYU侧最大流路径配置"></p><p>（4）最大流路径可视化</p><p>（黄色路径为最大流路径，黑色路径为未经过路径）</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230044990.png" alt="最大流路径可视化"></p>]]></content>
      
      
      <categories>
          
          <category> 网络算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SDN </tag>
            
            <tag> Ubuntu </tag>
            
            <tag> 项目开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Buttterfly主题暗夜模式魔改</title>
      <link href="/5280f76d/"/>
      <url>/5280f76d/</url>
      
        <content type="html"><![CDATA[<div class="tip warning"><p>适用hexo主题: Butterfly</p></div><p>Butterfly主题转换为暗夜模式全局色调会下降，可通过修改<em>博客根目录/themes/butterfly/source/css/mode/darkmode.styl</em>文件中的background-color的参数来调整暗调的程度。数字越大越暗，数字越小越明亮。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">   <span class="selector-id">#web_bg</span><span class="selector-pseudo">:before</span>,</span><br><span class="line">    <span class="selector-id">#footer</span><span class="selector-pseudo">:before</span>,</span><br><span class="line">    <span class="selector-id">#page-header</span><span class="selector-pseudo">:before</span></span><br><span class="line">      <span class="attribute">position</span>: absolute</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">100%</span></span><br><span class="line">-     <span class="attribute">background-color</span>: <span class="built_in">alpha</span>(<span class="variable">$dark</span>-black, .<span class="number">7</span>)</span><br><span class="line">+     <span class="attribute">background-color</span>: <span class="built_in">alpha</span>(<span class="variable">$dark</span>-black, .<span class="number">3</span>)</span><br><span class="line">      <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客搭建 </tag>
            
            <tag> 教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>困扰久已的微软商店无法使用的问题解决</title>
      <link href="/74810b/"/>
      <url>/74810b/</url>
      
        <content type="html"><![CDATA[<h2 id="BUG-2">BUG</h2><p>微软商店进不去</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225027376.png" alt="微软商店截图"></p><p>登录账户显示如下</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225041685.png" alt="微软商店账户无法登录"></p><h2 id="解决方法-2">解决方法</h2><p>网上一些方法都不行</p><blockquote><ol><li><p>在控制面板或者IE浏览器中打开Internet选项，删除Cookie信息。</p></li><li><p>在Internet选项-“高级”菜单中，点击重置，重置网络设置。</p></li><li><p>重启电脑。</p></li><li><p>win+R输入services.msc打开服务，找到Microsoft Account Sign-in Assistant，若没有启动，手动启动该服务。</p></li><li><p>重新尝试登录。</p></li></ol></blockquote><p>后来才发现，原来是我的clash的问题，虽然我用的是规则访问，可能还是有点问题，把他设置成直连也还是不行，把他退出就行了。<s>咱也不懂，咱也不敢问</s></p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225101217.png" alt="clash图标"></p>]]></content>
      
      
      <categories>
          
          <category> 问题修复 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>智能垃圾桶开发（二）——分类网模型训练</title>
      <link href="/36f24770/"/>
      <url>/36f24770/</url>
      
        <content type="html"><![CDATA[<p>分类网模型的实现主要是依靠Taurus(Hi3516DV300)套件实现。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103224013062.png" alt="Taurus(Hi3516DV300)套件"></p><h2 id="数据集收集">数据集收集</h2><p>本项目使用的<a href="https://aistudio.baidu.com/aistudio/datasetdetail/77996?qq-pf-to=pcqq.c2c">数据集</a>图片属性为（720，540，3），适用于有关垃圾分类相关场景的使用，覆盖了日常生活中绝大多数的垃圾类型，包含可回收垃圾、有害垃圾、厨余垃圾、其他垃圾四大垃圾。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103224043297.png" alt="数据集"></p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103224100044.png" alt="可回收垃圾-线示意图"></p><h2 id="环境搭建">环境搭建</h2><p>（一）安装Anaconda</p><p>在 linux 命令端输入</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://repo.anaconda.com/archive/Anaconda3-5.2.0-Linux-x86_64.sh </span><br></pre></td></tr></table></figure><p>以及</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash Anaconda3-5.2.0-Linux-x86_64.sh</span><br></pre></td></tr></table></figure><p>（二）配置环境</p><p>修改bashrc文件，路径进行替换，随后创建 conda 虚拟环境，并激活，conda create -n open-mmlab python=3.6，同样修改bashrc，linux开启自动激活。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103224123316.png" alt="配置环境"></p><p>（三）安装torch 和 torchversion<br>先查看CUDA 版本，随后通过 pip命令下载torch 和 torchversion。</p><p>（四）下载代码并安装对应的库<br>进入<a href="https://github.com/open-mmlab/mmclassification/releases/tag/v0.11.0">github仓库</a>下载代码，放到对应位置后，下载库pip install -e</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103224138471.png" alt="源代码下载"></p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103224153874.png" alt="安装库"></p><h2 id="模型训练">模型训练</h2><p>选用resnet18，分16类，训练参数如下。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#model settings</span></span><br><span class="line">model = <span class="built_in">dict</span>(</span><br><span class="line">    <span class="built_in">type</span>=<span class="string">&#x27;ImageClassifier&#x27;</span>,</span><br><span class="line">    backbone=<span class="built_in">dict</span>(</span><br><span class="line">        <span class="built_in">type</span>=<span class="string">&#x27;ResNet&#x27;</span>,</span><br><span class="line">        depth=<span class="number">18</span>,</span><br><span class="line">        num_stages=<span class="number">4</span>,</span><br><span class="line">        out_indices=(<span class="number">3</span>,)</span><br><span class="line">        style=<span class="string">&#x27;pytorch&#x27;</span>),</span><br><span class="line">    neck=<span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;GlobalAveragePooling&#x27;</span>),</span><br><span class="line">    head=<span class="built_in">dict</span>(</span><br><span class="line">        <span class="built_in">type</span>=<span class="string">&#x27;LinearClsHead&#x27;</span>,</span><br><span class="line">        num_classes=<span class="number">16</span>,</span><br><span class="line">        in_channels=<span class="number">512</span>,        </span><br><span class="line">        loss=<span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;CrossEntropyLoss&#x27;</span>,loss_weight=<span class="number">1.0</span>),</span><br><span class="line">        topk=(<span class="number">1</span>,<span class="number">5</span>),</span><br><span class="line">    ))</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#optimizer</span></span><br><span class="line">optimizer = <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;SGD&#x27;</span>,Ir=<span class="number">0.01</span>,momentum=<span class="number">0.9</span>,weight_decay=<span class="number">0.001</span>)</span><br><span class="line">optimizer_config = <span class="built_in">dict</span>(grad_clip=<span class="literal">None</span>)</span><br><span class="line"><span class="comment">#learning policy</span></span><br><span class="line">Ir_config = <span class="built_in">dict</span>(policy=<span class="string">&#x27;step&#x27;</span>,step=[<span class="number">25</span>,<span class="number">35</span>,<span class="number">45</span>])</span><br><span class="line">runner = <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;EpochBasedRunner,max_epochs=50)</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#dataset settings</span></span><br><span class="line">dataset_type =<span class="string">&#x27;ImageNet&#x27;</span></span><br><span class="line">img_norm_cfg = <span class="built_in">dict</span>(</span><br><span class="line">    mean=[<span class="number">127.5</span>,<span class="number">127.5</span>,<span class="number">127.51</span>,std=[<span class="number">127.5</span>,<span class="number">127.5</span>,<span class="number">127.51</span>,to rgb=<span class="literal">True</span>)</span><br><span class="line">train_pipeline = [</span><br><span class="line">    <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;LoadlmageFromFile&#x27;</span>),</span><br><span class="line">    <span class="comment">#dict(type=&#x27;RandomResizedCrop&#x27;,size=224),</span></span><br><span class="line">    <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;Resize&#x27;</span>,size=(<span class="number">256</span>,<span class="number">256</span>)),</span><br><span class="line">    <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;RandomFlip&#x27;</span>,flip_prob=<span class="number">0.5</span>,direction=<span class="string">&#x27;horizontal&#x27;</span>),</span><br><span class="line">    <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;Normalize&#x27;</span>,**img_norm_cfg),</span><br><span class="line">    <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;ImageToTensor&#x27;</span>,keys=[<span class="string">&#x27;img&#x27;</span>]),</span><br><span class="line">    <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;ToTensor&#x27;</span>,keys=[<span class="string">&#x27;gt_label&#x27;</span>]),</span><br><span class="line">    <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;Collect&#x27;</span>,keys=[<span class="string">&#x27;img&#x27;</span>,<span class="string">&#x27;gt_label&#x27;</span>]) </span><br><span class="line">]</span><br><span class="line">                                  </span><br><span class="line">test_pipeline = [</span><br><span class="line">    <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;LoadlmageFromFile&#x27;</span>),</span><br><span class="line">    <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;Resize&#x27;</span>,size=(<span class="number">256</span>,<span class="number">256</span>)),</span><br><span class="line">    <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;CenterCrop&#x27;</span>,crop_size=<span class="number">224</span>),</span><br><span class="line">    <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;Normalize&#x27;</span>,**img_norm_cfg),</span><br><span class="line">    <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;ImageToTensor&#x27;</span>,keys=[<span class="string">&#x27;img&#x27;</span>]),</span><br><span class="line">    <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;Collect&#x27;</span>,keys=[<span class="string">&#x27;img&#x27;</span>])</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">dict</span>(</span><br><span class="line">    samples_per_gpu=<span class="number">32</span>,</span><br><span class="line">    workers_per_gpu=<span class="number">1</span>,</span><br><span class="line">    train=<span class="built_in">dict</span>(</span><br><span class="line">        <span class="built_in">type</span>=dataset_type,</span><br><span class="line">        data_prefix=<span class="string">&#x27;/home/ubuntu/classify_dataset&#x27;</span>,</span><br><span class="line">        pipeline=train_pipeline),</span><br><span class="line">    val=<span class="built_in">dict</span>(</span><br><span class="line">        <span class="built_in">type</span>=dataset_type,</span><br></pre></td></tr></table></figure><p>调用以下语句使用1个GPU进行训练</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python ./tools/dist_train.sh configs/resnet/resnet18_b32x8_imagenet.py --work-dir ./ckpt3</span><br></pre></td></tr></table></figure><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103224208621.png" alt="模型训练"></p><h2 id="网络模型转化">网络模型转化</h2><p>修改resnet_pytorch_2_caffe.py文件，并转换生成resnet18.caffemodel 和 resnet18.prototxt。修改.prototx 网络文件，并得到我们的网络模型。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.insert(<span class="number">0</span>,<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch.autograd <span class="keyword">import</span> Variable</span><br><span class="line"><span class="keyword">from</span> torchvision.models <span class="keyword">import</span> resnet</span><br><span class="line"><span class="keyword">import</span> pytorch to caffe</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> name==<span class="string">&#x27;_main_&#x27;</span>:</span><br><span class="line">    name=<span class="string">&#x27;resnet18&#x27;</span></span><br><span class="line">    resnet18=resnet.resnet18(num classes=<span class="number">16</span>)</span><br><span class="line">    checkpoint = torch.load(<span class="string">&quot;/home/ubuntu/mmclassification/ckpt3/latest.pth&quot;</span>)</span><br><span class="line">    new_sd = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> k,v <span class="keyword">in</span> checkpoint[<span class="string">&#x27;state dict&#x27;</span>].items（）:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> k.endswith(<span class="string">&#x27;num batches tracked&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> k.startswith(backbone):</span><br><span class="line">                k_new = k.split(<span class="string">&#x27;backbone.&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> k.startswith(<span class="string">&#x27;head.&#x27;</span>):</span><br><span class="line">                k_new = k.split(<span class="string">&#x27;head.&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">            new_sd[k new]=v</span><br><span class="line">    resnet18.load_state_dict(new_sd)</span><br><span class="line">    resnet18.<span class="built_in">eval</span>()</span><br><span class="line">    <span class="built_in">input</span>=torch.ones([<span class="number">1</span>,<span class="number">3</span>,<span class="number">224</span>,<span class="number">224</span>])</span><br><span class="line">    <span class="comment">#input=torch.ones([1,3,224,224])</span></span><br><span class="line">    pytorch_to_caffe.trans_net(resnet18,<span class="built_in">input</span>,name)</span><br><span class="line">    pytorch_to_caffe.save_prototxt(<span class="string">&#x27;&#123;&#125;.prototxt&#x27;</span>.<span class="built_in">format</span>(name))</span><br><span class="line">    pytorch_to_caffe.save_caffemodel(<span class="string">&#x27;&#123;&#125;.caffemodel&#x27;</span>.<span class="built_in">format</span>(name))</span><br></pre></td></tr></table></figure><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103224224687.png" alt="网络模型可视化"></p><h2 id="模型量化">模型量化</h2><p>利用RuyiStudio生成wk文件：</p><ol><li>mean.txt 制作</li><li>imagelist.txt 制作</li><li>配置 Input_Setting</li><li>Mapper Setting 配置</li><li>Dynamic Parameters 配置</li></ol><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103224245296.png" alt="模型量化"></p><p>之后在板子上运行会出现下面错误：</p><div class="tip error"><p>[Level]:Error,[Func]:SAMPLE_COMM_SVP_NNIE_LoadModel [Line]:560</p><p>[Info]:Error,HI_MPI_SVP_NNIE_LoadModel failed!</p><p>[Level]:Error,[Func]:SAMPLE_SVP_NNIE_Yolov3 [Line]:3110</p></div><p>出现这个问题是因为仿真环境和板子上运行的环境不一样</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103224301324.png" alt="设置环境版本"></p><h2 id="识别控制">识别控制</h2><p>修改cnn_trash_classify.c文件，并且加入训练好的垃圾分类的wk文件</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(score &lt; THRESH_MIN)&#123;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SAMPLE_PRT(<span class="string">&quot;---trash item flag---num:%d,score:%d\n&quot;</span>,item-&gt;num,score);</span><br><span class="line"><span class="keyword">switch</span> (item-&gt;num)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0u</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1u</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2u</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3u</span>:   </span><br><span class="line">        trashName =<span class="string">&quot;Kitchen Waste&quot;</span>;</span><br><span class="line">        SAMPLE_PRT(<span class="string">&quot;---trash name---:%s\n&quot;</span>,trashName);</span><br><span class="line">        <span class="keyword">break</span>;    </span><br><span class="line">    <span class="keyword">case</span> <span class="number">4u</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5u</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6u</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">7u</span>:</span><br><span class="line">        trashName =<span class="string">&quot;Hazardous Waste&quot;</span>;</span><br><span class="line">        SAMPLE_PRT(<span class="string">&quot;---trash name---:%s\n&quot;</span>,trashName);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">8u</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">9u</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">10u</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">11u</span>:</span><br><span class="line">        trashName =<span class="string">&quot;Recyclable Waste&quot;</span>;</span><br><span class="line">        SAMPLE_PRT(<span class="string">&quot;---trash name---:%s\n&quot;</span>,trashName);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">12u</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">13u</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">14u</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">15u</span>:</span><br><span class="line">        trashName =<span class="string">&quot;Other Waste&quot;</span>;</span><br><span class="line">        SAMPLE_PRT(<span class="string">&quot;---trash name---:%s\n&quot;</span>,trashName);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        trashName =<span class="string">&quot;Unkown Waste&quot;</span>;</span><br><span class="line">        SAMPLE_PRT(<span class="string">&quot;---trash name---:%s\n&quot;</span>,trashName);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">UartTestSample(item-&gt;num);</span><br><span class="line"><span class="keyword">return</span> HI_SUCCESS:</span><br></pre></td></tr></table></figure><h2 id="板端部署与调试">板端部署与调试</h2><ol><li>执行 make clean &amp;&amp; make，对 hispark_taurus_nnie_sample 进行编译；</li><li>将 sample_nnie_main 这个可执行文件，拷贝到/home/hispark/code/HiSpark_Hi3516DV300_SDK_SPC021/osdrv/pub/rootfs_glibc/rot/目录下；</li><li>接下来需要制作文件系统，命令为cd /home/ubuntu/code/HiSpark_Hi3516DV300_SDK_SPC021./build.sh ext4</li><li>使用 HiTool 工具进行烧录</li></ol><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103224319272.png" alt="HiTool烧录"></p><h2 id="模型验证">模型验证</h2><p>分类效果良好。</p><div class="video"><video controls preload><source src='https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/video/%E5%9E%83%E5%9C%BE%E5%88%86%E7%B1%BB_x264.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><hr><blockquote><p>鸣谢：廉廉子、城城子、杰杰子、皓皓子</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 人工智能 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目开发 </tag>
            
            <tag> 机器视觉 </tag>
            
            <tag> 人工智能 </tag>
            
            <tag> Unbutu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>智能垃圾桶开发（一）——外设控制</title>
      <link href="/4dd1a6f1/"/>
      <url>/4dd1a6f1/</url>
      
        <content type="html"><![CDATA[<p>在人工智能课上拿到了Taurus &amp; Pegasus AI计算机视觉基础开发套件，我们将用它实现可以智能识别垃圾类别的垃圾桶吗，核心板Hi3516DV300主要用于垃圾识别并分类，Hi3861主要用于基础外设的控制。</p><hr><h1 id="Hi3861板子的开发">Hi3861板子的开发</h1><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103224348490.png" alt="Hi3861实物图"></p><details class="folding-tag" yellow><summary> OpenHarmony轻量系统开发入门资料 </summary>              <div class='content'>              <ul><li><a href="https://ost.51cto.com/posts/10086">源代码和环境搭建</a></li><li><a href="https://ost.51cto.com/posts/10087">代码编译和烧录</a></li><li><a href="https://ost.51cto.com/posts/944">程序编写示例</a></li></ul>              </div>            </details><h2 id="舵机驱动">舵机驱动</h2><h3 id="基本原理-2">基本原理</h3><p>微处理器产生的 <span class="bubble-content">PWM信号</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#FFB6C1;">脉冲宽度调制信号，可调节信号的占空比</span></span> 通过信号线进入舵机产生直流偏置电压，与舵机内部的基准电压作比较，电压差的正负输出到电机驱动芯片上，从而决定正反转。</p><p>高电平在一个周期（20ms）的持续时间对应的舵机角度可参考如下（以实际调节值为准）</p><table><thead><tr><th style="text-align:center">t / ms</th><th style="text-align:center">对应角度 / <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mo lspace="0em" rspace="0em">∘</mo></msup></mrow><annotation encoding="application/x-tex">^{\circ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6741em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6741em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∘</span></span></span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td style="text-align:center">0.5</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">1.0</td><td style="text-align:center">45</td></tr><tr><td style="text-align:center">5.0</td><td style="text-align:center">90</td></tr><tr><td style="text-align:center">2.0</td><td style="text-align:center">135</td></tr><tr><td style="text-align:center">2.5</td><td style="text-align:center">180</td></tr></tbody></table><h3 id="注意点">注意点</h3><p>注意引脚的功能复用，由于引脚数量有限，往往有多个功能复用一个引脚，在使用引脚时要选择引脚的初始化。套件中舵机的型号为SG90，虽然板子自带有pwm的功能，但在测试过程中该功能无法使舵机工作。</p><p>我们可以根据pwm的逻辑直接使用引脚的GPIO功能来完成pwm信号的实现。实现逻辑就是先设置20ms的周期，然后根据所需角度调节GPIO输出高电平的时间，周期其余时间输出低电平即可。</p><p>另外还需要注意根据板子结构图选择合适的GPIO引脚。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103224409397.png" alt="Hi3861结构图"></p><p>根据上图还可以控制相应的LED灯的点亮。</p><h2 id="OLED屏幕显示">OLED屏幕显示</h2><p>套件中还提供了一块OLED屏，通过<a href="https://ost.51cto.com/posts/1145">基础教程</a>可以很容易的复现出来。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103224508147.png" alt="oled演示"></p><h2 id="成果展示-5">成果展示</h2><div class="video"><video controls preload><source src='https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/video/%E8%88%B5%E6%9C%BA%E6%8E%A7%E5%88%B6%E6%BC%94%E7%A4%BA_x264.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><h2 id="源代码">源代码</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;hi_types_base.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;hi_gpio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;hi_io.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;hi_time.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iot_gpio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ohos_init.h&quot;</span>  <span class="comment">//在//utils/native/lite/include&quot;里，负责系统任务，如SYS_RUN</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;cmsis_os2.h&quot;</span>  <span class="comment">//在//kernel/liteos_m/kal/cmsis&quot;里，负责线程，如osThreadAttr_t</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iot_i2c.h&quot;</span>    <span class="comment">//在 &quot;//base/iot_hardware/peripheral/interfaces/kits&quot;里，负责各种接口，如IoTGpioSetOutputVal</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iot_gpio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iot_errno.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iot_uart.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;oled_ssd1306.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> AHT20_BAUDRATE (400 * 1000)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> AHT20_I2C_IDX 13</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*舵机线程*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> *<span class="title function_">Servo_Task</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *arg)</span></span><br><span class="line">&#123;    </span><br><span class="line">(<span class="type">void</span>)arg;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Enter Servo_Task\n&quot;</span>);</span><br><span class="line"><span class="type">int</span> gpio_id[] = &#123;<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>&#125;;</span><br><span class="line"><span class="type">int</span> led_id[] = &#123;<span class="number">2</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">12</span>&#125;;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;1\n&quot;</span>);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">0</span>],HI_GPIO_VALUE1);</span><br><span class="line">set_angle(<span class="number">1800</span>,gpio_id[<span class="number">0</span>]);</span><br><span class="line">hi_udelay(<span class="number">1000000</span>);</span><br><span class="line">set_angle(<span class="number">2477</span>,gpio_id[<span class="number">0</span>]);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">0</span>],HI_GPIO_VALUE0);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;2\n&quot;</span>);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">1</span>],HI_GPIO_VALUE1);</span><br><span class="line">set_angle(<span class="number">1700</span>,gpio_id[<span class="number">1</span>]);</span><br><span class="line">hi_udelay(<span class="number">1000000</span>);</span><br><span class="line">set_angle(<span class="number">2460</span>,gpio_id[<span class="number">1</span>]);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">1</span>],HI_GPIO_VALUE0);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;3\n&quot;</span>);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">2</span>],HI_GPIO_VALUE1);</span><br><span class="line">set_angle(<span class="number">1500</span>,gpio_id[<span class="number">2</span>]);</span><br><span class="line">hi_udelay(<span class="number">1000000</span>);</span><br><span class="line">set_angle(<span class="number">2477</span>,gpio_id[<span class="number">2</span>]);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">2</span>],HI_GPIO_VALUE0);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;4\n&quot;</span>);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">3</span>],HI_GPIO_VALUE1);</span><br><span class="line">set_angle(<span class="number">1850</span>,gpio_id[<span class="number">3</span>]);</span><br><span class="line">hi_udelay(<span class="number">1000000</span>);</span><br><span class="line">set_angle(<span class="number">2477</span>,gpio_id[<span class="number">3</span>]);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">3</span>],HI_GPIO_VALUE0);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//惊喜</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">0</span>],HI_GPIO_VALUE1);</span><br><span class="line">set_angle(<span class="number">1800</span>,gpio_id[<span class="number">0</span>]);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">1</span>],HI_GPIO_VALUE1);</span><br><span class="line">set_angle(<span class="number">1850</span>,gpio_id[<span class="number">1</span>]);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">2</span>],HI_GPIO_VALUE1);</span><br><span class="line">set_angle(<span class="number">1500</span>,gpio_id[<span class="number">2</span>]);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">3</span>],HI_GPIO_VALUE1);</span><br><span class="line">set_angle(<span class="number">1850</span>,gpio_id[<span class="number">3</span>]);</span><br><span class="line">hi_udelay(<span class="number">100000</span>);</span><br><span class="line">set_angle(<span class="number">2477</span>,gpio_id[<span class="number">0</span>]);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">0</span>],HI_GPIO_VALUE0);</span><br><span class="line">set_angle(<span class="number">2460</span>,gpio_id[<span class="number">1</span>]);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">1</span>],HI_GPIO_VALUE0);</span><br><span class="line">set_angle(<span class="number">2477</span>,gpio_id[<span class="number">2</span>]);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">2</span>],HI_GPIO_VALUE0);</span><br><span class="line">set_angle(<span class="number">2477</span>,gpio_id[<span class="number">3</span>]);</span><br><span class="line">IoTGpioSetOutputVal(led_id[<span class="number">3</span>],HI_GPIO_VALUE0);</span><br><span class="line">hi_udelay(<span class="number">100000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*设置旋转角度*/</span></span><br><span class="line">hi_void <span class="title function_">set_angle</span><span class="params">(hi_u32 utime, <span class="type">char</span> gpio_id)</span></span><br><span class="line">&#123;</span><br><span class="line">IoTGpioSetOutputVal(gpio_id,HI_GPIO_VALUE1);</span><br><span class="line">    hi_udelay(utime);  <span class="comment">//单位为微秒</span></span><br><span class="line"></span><br><span class="line">IoTGpioSetOutputVal(gpio_id,HI_GPIO_VALUE0);</span><br><span class="line">    hi_udelay(<span class="number">20000</span>-utime);  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*oled显示线程*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">Oled_Task</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *arg)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Enter Oled_Task\n&quot;</span>);</span><br><span class="line">    (<span class="type">void</span>)arg;</span><br><span class="line">    OledInit();</span><br><span class="line">    OledFillScreen(<span class="number">0</span>);</span><br><span class="line">    IoTI2cInit(AHT20_I2C_IDX, AHT20_BAUDRATE);</span><br><span class="line">OledShowString(<span class="number">0</span>, <span class="number">2</span>, <span class="string">&quot;Pursue G-fashion&quot;</span>, <span class="number">1</span>);<span class="comment">/* 屏幕第0列2行显示1行 */</span></span><br><span class="line">OledShowString(<span class="number">5</span>, <span class="number">4</span>, <span class="string">&quot;Embrace G-life&quot;</span>, <span class="number">1</span>); </span><br><span class="line"><span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*UART线程</span></span><br><span class="line"><span class="comment">static void* Uart_Task(const char* arg)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    unsigned int len = 0;</span></span><br><span class="line"><span class="comment">//unsigned char uartWriteBuff[] = &quot;hello uart!&quot;;</span></span><br><span class="line"><span class="comment">//unsigned int uartReadBuff = 0;</span></span><br><span class="line"><span class="comment">int Identification = 0;</span></span><br><span class="line"><span class="comment">    (void)arg;</span></span><br><span class="line"><span class="comment">    printf(&quot;Enter Uart_Task\n&quot;);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment">    IoTGpioInit(1); // 使用GPIO，都需要调用该接口</span></span><br><span class="line"><span class="comment">// 初始化UART配置，115200，数据bit为8,停止位1，奇偶校验为NONE，流控为NONE</span></span><br><span class="line"><span class="comment">    IotUartAttribute g_uart_cfg = &#123;115200, 8, 1, IOT_UART_PARITY_NONE, 0,0&#125;;</span></span><br><span class="line"><span class="comment">hi_io_set_func(1,HI_IO_FUNC_GPIO_1_UART1_RXD);</span></span><br><span class="line"><span class="comment">    IoTUartInit(1, &amp;g_uart_cfg);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    //UartWrite(WIFI_IOT_UART_IDX_2, (unsigned char *)uartWriteBuff, sizeof(uartWriteBuff));</span></span><br><span class="line"><span class="comment">printf(&quot;Uart reading...\n&quot;);</span></span><br><span class="line"><span class="comment">    while (1) &#123;</span></span><br><span class="line"><span class="comment">        IoTUartRead(1, Identification, sizeof(Identification));</span></span><br><span class="line"><span class="comment">        if (Identification != 0) &#123;</span></span><br><span class="line"><span class="comment">printf(&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n&quot;);</span></span><br><span class="line"><span class="comment">            printf(&quot;Uart read data:%d\n&quot;, Identification);</span></span><br><span class="line"><span class="comment">printf(&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n&quot;);</span></span><br><span class="line"><span class="comment">hi_udelay(1200000);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        else&#123;</span></span><br><span class="line"><span class="comment">usleep(100000);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    return NULL;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*入口函数*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">duojiEntry</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">/*GPIO初始化*/</span></span><br><span class="line"><span class="type">int</span> GPIO[] = &#123;<span class="number">2</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>&#125;;</span><br><span class="line"><span class="type">char</span> *GPIO_func[] = &#123;<span class="string">&quot;HI_IO_FUNC_GPIO_2_GPIO&quot;</span>,<span class="string">&quot;HI_IO_FUNC_GPIO_6_GPIO&quot;</span>,\</span><br><span class="line"><span class="string">&quot;HI_IO_FUNC_GPIO_7_GPIO&quot;</span>,<span class="string">&quot;HI_IO_FUNC_GPIO_8_GPIO&quot;</span>,<span class="string">&quot;HI_IO_FUNC_GPIO_9_GPIO&quot;</span>,\</span><br><span class="line"><span class="string">&quot;HI_IO_FUNC_GPIO_10_GPIO&quot;</span>,<span class="string">&quot;HI_IO_FUNC_GPIO_11_GPIO&quot;</span>,<span class="string">&quot;HI_IO_FUNC_GPIO_12_GPIO&quot;</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">IoTGpioInit(GPIO[i]);</span><br><span class="line">hi_io_set_func(GPIO[i],GPIO_func[i]);</span><br><span class="line">IoTGpioSetDir(GPIO[i], HI_GPIO_DIR_OUT);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">osThreadAttr_t servo_attr; <span class="comment">//定义舵机线程</span></span><br><span class="line">    servo_attr.name = <span class="string">&quot;Servo_Task&quot;</span>;</span><br><span class="line">    servo_attr.attr_bits = <span class="number">0U</span>;</span><br><span class="line">    servo_attr.cb_mem = <span class="literal">NULL</span>;</span><br><span class="line">    servo_attr.cb_size = <span class="number">0U</span>;</span><br><span class="line">    servo_attr.stack_mem = <span class="literal">NULL</span>;</span><br><span class="line">    servo_attr.stack_size = <span class="number">1024</span>;</span><br><span class="line">    servo_attr.priority = osPriorityNormal;</span><br><span class="line"><span class="comment">//创建舵机线程并判断是否创建成功</span></span><br><span class="line"><span class="keyword">if</span> (osThreadNew((osThreadFunc_t)Servo_Task, <span class="literal">NULL</span>, &amp;servo_attr) != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\nSucceed to create Servo_Task!\n&quot;</span>);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">osThreadAttr_t Oled_attr; <span class="comment">//定义oled显示线程</span></span><br><span class="line">    Oled_attr.name = <span class="string">&quot;Oled_Task&quot;</span>;</span><br><span class="line">    Oled_attr.attr_bits = <span class="number">0U</span>;</span><br><span class="line">    Oled_attr.cb_mem = <span class="literal">NULL</span>;</span><br><span class="line">    Oled_attr.cb_size = <span class="number">0U</span>;</span><br><span class="line">    Oled_attr.stack_mem = <span class="literal">NULL</span>;</span><br><span class="line">    Oled_attr.stack_size = <span class="number">4096</span>; <span class="comment">/* 任务大小4096 */</span></span><br><span class="line">    Oled_attr.priority = osPriorityNormal;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建oled显示线程并判断是否创建成功</span></span><br><span class="line">    <span class="keyword">if</span> (osThreadNew((osThreadFunc_t)Oled_Task, <span class="literal">NULL</span>, &amp;Oled_attr) != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Succeed to create Oled_Task!\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">osThreadAttr_t Uart_attr; //定义UART线程</span></span><br><span class="line"><span class="comment">    Uart_attr.name = &quot;Uart_Task&quot;;</span></span><br><span class="line"><span class="comment">    Uart_attr.attr_bits = 0U;</span></span><br><span class="line"><span class="comment">    Uart_attr.cb_mem = NULL;</span></span><br><span class="line"><span class="comment">    Uart_attr.cb_size = 0U;</span></span><br><span class="line"><span class="comment">    Uart_attr.stack_mem = NULL;</span></span><br><span class="line"><span class="comment">    Uart_attr.stack_size = 4096; // 堆栈大小</span></span><br><span class="line"><span class="comment">    Uart_attr.priority = osPriorityNormal; // 优先级</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment">//创建UART线程并判断是否创建成功</span></span><br><span class="line"><span class="comment">    if (osThreadNew((osThreadFunc_t)Uart_Task, NULL, &amp;Uart_attr) != NULL) &#123;</span></span><br><span class="line"><span class="comment">        printf(&quot;Succeed to create Uart_Task!\n&quot;);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">&#125;</span><br><span class="line">SYS_RUN(duojiEntry);</span><br></pre></td></tr></table></figure><p>BUILD.gn文件设置如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">static_library(&quot;duoji&quot;) &#123;</span><br><span class="line">    sources = [</span><br><span class="line">        &quot;hal_iot_gpio_ex.c&quot;,</span><br><span class="line">        &quot;duoji.c&quot;,</span><br><span class="line">        &quot;oled_ssd1306.c&quot;,</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    include_dirs = [</span><br><span class="line">        &quot;//utils/native/lite/include&quot;,</span><br><span class="line">        &quot;//kernel/liteos_m/kal/cmsis&quot;,</span><br><span class="line">        &quot;//base/iot_hardware/peripheral/interfaces/kits&quot;,</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>辅助代码如下，与上面的文件放在同一个文件夹即可。</p><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">hal_iot_gpio_ex.c</button></li><li class="tab"><button type="button" data-href="#-2">oled_ssd1306.c</button></li><li class="tab"><button type="button" data-href="#-3">iot_gpio_ex.h</button></li><li class="tab"><button type="button" data-href="#-4">oled_fonts.h</button></li><li class="tab"><button type="button" data-href="#-5">oled_ssd1306.h</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iot_errno.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iot_gpio_ex.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;hi_gpio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;hi_io.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;hi_task.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;hi_types_base.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">IoSetPull</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> id, IotIoPull val)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (id &gt;= HI_GPIO_IDX_MAX) &#123;</span><br><span class="line">        <span class="keyword">return</span> IOT_FAILURE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hi_io_set_pull((hi_io_name)id, (hi_io_pull)val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">IoSetFunc</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> id, <span class="type">unsigned</span> <span class="type">char</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (id &gt;= HI_GPIO_IDX_MAX) &#123;</span><br><span class="line">        <span class="keyword">return</span> IOT_FAILURE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hi_io_set_func((hi_io_name)id, val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">TaskMsleep</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> ms)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (ms &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> IOT_FAILURE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hi_sleep((hi_u32)ms);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stddef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ohos_types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iot_errno.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iot_gpio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iot_i2c.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iot_gpio_ex.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;oled_fonts.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;oled_ssd1306.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OLED_I2C_IDX 0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OLED_WIDTH    (128)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OLED_I2C_ADDR 0x78 <span class="comment">// 默认地址为 0x78</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OLED_I2C_CMD 0x00 <span class="comment">// 0000 0000       写命令</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OLED_I2C_DATA 0x40 <span class="comment">// 0100 0000(0x40) 写数据</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OLED_I2C_BAUDRATE (400 * 1000) <span class="comment">// 400k</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELAY_100_MS (100 * 1000)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="comment">/** Pointer to the buffer storing data to send */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *sendBuf;</span><br><span class="line">    <span class="comment">/** Length of data to send */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span>  sendLen;</span><br><span class="line">    <span class="comment">/** Pointer to the buffer for storing data to receive */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *receiveBuf;</span><br><span class="line">    <span class="comment">/** Length of data received */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span>  receiveLen;</span><br><span class="line">&#125; IotI2cData;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> <span class="title function_">I2cWiteByte</span><span class="params">(<span class="type">uint8_t</span> regAddr, <span class="type">uint8_t</span> byte)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> id = OLED_I2C_IDX;</span><br><span class="line">    <span class="type">uint8_t</span> buffer[] = &#123;regAddr, byte&#125;;</span><br><span class="line">    IotI2cData i2cData = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    i2cData.sendBuf = buffer;</span><br><span class="line">    i2cData.sendLen = <span class="keyword">sizeof</span>(buffer) / <span class="keyword">sizeof</span>(buffer[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> IoTI2cWrite(id, OLED_I2C_ADDR, i2cData.sendBuf, i2cData.sendLen);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief Write a command byte to OLED device.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param cmd the commnad byte to be writen.</span></span><br><span class="line"><span class="comment"> * @return Returns &#123;@link IOT_SUCCESS&#125; if the operation is successful;</span></span><br><span class="line"><span class="comment"> * returns an error code defined in &#123;@link wifiiot_errno.h&#125; otherwise.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> <span class="title function_">WriteCmd</span><span class="params">(<span class="type">uint8_t</span> cmd)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> I2cWiteByte(OLED_I2C_CMD, cmd);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief Write a data byte to OLED device.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param cmd the data byte to be writen.</span></span><br><span class="line"><span class="comment"> * @return Returns &#123;@link IOT_SUCCESS&#125; if the operation is successful;</span></span><br><span class="line"><span class="comment"> * returns an error code defined in &#123;@link wifiiot_errno.h&#125; otherwise.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> <span class="title function_">WriteData</span><span class="params">(<span class="type">uint8_t</span> data)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> I2cWiteByte(OLED_I2C_DATA, data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief ssd1306 OLED Initialize.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">OledInit</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">uint8_t</span> initCmds[] = &#123;</span><br><span class="line">        <span class="number">0xAE</span>, <span class="comment">// --display off</span></span><br><span class="line">        <span class="number">0x00</span>, <span class="comment">// ---set low column address</span></span><br><span class="line">        <span class="number">0x10</span>, <span class="comment">// ---set high column address</span></span><br><span class="line">        <span class="number">0x40</span>, <span class="comment">// --set start line address</span></span><br><span class="line">        <span class="number">0xB0</span>, <span class="comment">// --set page address</span></span><br><span class="line">        <span class="number">0x81</span>, <span class="comment">// contract control</span></span><br><span class="line">        <span class="number">0xFF</span>, <span class="comment">// --128</span></span><br><span class="line">        <span class="number">0xA1</span>, <span class="comment">// set segment remap</span></span><br><span class="line">        <span class="number">0xA6</span>, <span class="comment">// --normal / reverse</span></span><br><span class="line">        <span class="number">0xA8</span>, <span class="comment">// --set multiplex ratio(1 to 64)</span></span><br><span class="line">        <span class="number">0x3F</span>, <span class="comment">// --1/32 duty</span></span><br><span class="line">        <span class="number">0xC8</span>, <span class="comment">// Com scan direction</span></span><br><span class="line">        <span class="number">0xD3</span>, <span class="comment">// -set display offset</span></span><br><span class="line">        <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0xD5</span>, <span class="comment">// set osc division</span></span><br><span class="line">        <span class="number">0x80</span>,</span><br><span class="line">        <span class="number">0xD8</span>, <span class="comment">// set area color mode off</span></span><br><span class="line">        <span class="number">0x05</span>,</span><br><span class="line">        <span class="number">0xD9</span>, <span class="comment">// Set Pre-Charge Period</span></span><br><span class="line">        <span class="number">0xF1</span>,</span><br><span class="line">        <span class="number">0xDA</span>, <span class="comment">// set com pin configuartion</span></span><br><span class="line">        <span class="number">0x12</span>,</span><br><span class="line">        <span class="number">0xDB</span>, <span class="comment">// set Vcomh</span></span><br><span class="line">        <span class="number">0x30</span>,</span><br><span class="line">        <span class="number">0x8D</span>, <span class="comment">// set charge pump enable</span></span><br><span class="line">        <span class="number">0x14</span>,</span><br><span class="line">        <span class="number">0xAF</span>, <span class="comment">// --turn on oled panel</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    IoTGpioInit(<span class="number">13</span>); <span class="comment">/* 初始化gpio13 */</span></span><br><span class="line">    IoSetFunc(<span class="number">13</span>, <span class="number">6</span>); <span class="comment">/* gpio13使用6功能 */</span></span><br><span class="line">    IoTGpioInit(<span class="number">14</span>); <span class="comment">/* 初始化gpio14 */</span></span><br><span class="line">    IoSetFunc(<span class="number">14</span>, <span class="number">6</span>); <span class="comment">/* gpio14使用6功能 */</span></span><br><span class="line"></span><br><span class="line">    IoTI2cInit(<span class="number">0</span>, OLED_I2C_BAUDRATE);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; ARRAY_SIZE(initCmds); i++) &#123;</span><br><span class="line">        <span class="type">uint32_t</span> status = WriteCmd(initCmds[i]);</span><br><span class="line">        <span class="keyword">if</span> (status != IOT_SUCCESS) &#123;</span><br><span class="line">            <span class="keyword">return</span> status;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> IOT_SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">OledSetPosition</span><span class="params">(<span class="type">uint8_t</span> x, <span class="type">uint8_t</span> y)</span></span><br><span class="line">&#123;</span><br><span class="line">    WriteCmd(<span class="number">0xb0</span> + y);</span><br><span class="line">    WriteCmd(((x &amp; <span class="number">0xf0</span>) &gt;&gt; <span class="number">4</span>) | <span class="number">0x10</span>); <span class="comment">/* 在0xf0右移4位，与0x10或，实现了写数据 */</span></span><br><span class="line">    WriteCmd(x &amp; <span class="number">0x0f</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 全屏填充 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">OledFillScreen</span><span class="params">(<span class="type">uint8_t</span> fillData)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint8_t</span> m = <span class="number">0</span>; m &lt; <span class="number">8</span>; m++) &#123; <span class="comment">/* 循环8次实现横屏填充 */</span></span><br><span class="line">        WriteCmd(<span class="number">0xb0</span> + m);</span><br><span class="line">        WriteCmd(<span class="number">0x00</span>);</span><br><span class="line">        WriteCmd(<span class="number">0x10</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">uint8_t</span> n = <span class="number">0</span>; n &lt; <span class="number">128</span>; n++) &#123; <span class="comment">/* 循环128次实现竖屏填充 */</span></span><br><span class="line">            WriteData(fillData);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief 8*16 typeface</span></span><br><span class="line"><span class="comment"> * @param x: write positon start from x axis</span></span><br><span class="line"><span class="comment"> * @param y: write positon start from y axis</span></span><br><span class="line"><span class="comment"> * @param ch: write data</span></span><br><span class="line"><span class="comment"> * @param font: selected font</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">OledShowChar</span><span class="params">(<span class="type">uint8_t</span> x, <span class="type">uint8_t</span> y, <span class="type">uint8_t</span> ch, Font font)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint8_t</span> c = ch - <span class="string">&#x27; &#x27;</span>; <span class="comment">// 得到偏移后的值</span></span><br><span class="line">    <span class="type">uint8_t</span> b = x;</span><br><span class="line">    <span class="type">uint8_t</span> d = y;</span><br><span class="line">    <span class="keyword">if</span> (b &gt; OLED_WIDTH - <span class="number">1</span>) &#123;</span><br><span class="line">        b = <span class="number">0</span>;</span><br><span class="line">        d = d + <span class="number">2</span>; <span class="comment">/* 得到偏移后的值2 */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (font == FONT8_X16) &#123;</span><br><span class="line">        OledSetPosition(b, d);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">uint8_t</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123; <span class="comment">/* 循环8次实现横屏填充 */</span></span><br><span class="line">            WriteData(g_f8X16[c * <span class="number">16</span> + i]); <span class="comment">/* 循环16次实现横屏填充 */</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        OledSetPosition(b, d + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">uint8_t</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123; <span class="comment">/* 循环8次实现横屏填充 */</span></span><br><span class="line">            WriteData(g_f8X16[c * <span class="number">16</span> + i + <span class="number">8</span>]); <span class="comment">/* 循环16次实现横屏填充8列 */</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        OledSetPosition(b, d);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">uint8_t</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123; <span class="comment">/* 循环6次实现横屏填充 */</span></span><br><span class="line">            WriteData(g_f6X8[c][i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">OledShowString</span><span class="params">(<span class="type">uint8_t</span> x, <span class="type">uint8_t</span> y, <span class="type">const</span> <span class="type">char</span>* str, Font font)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint8_t</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> b = x;</span><br><span class="line">    <span class="type">uint8_t</span> d = y;</span><br><span class="line">    <span class="keyword">if</span> (str == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;param is NULL,Please check!!!\r\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (str[j]) &#123;</span><br><span class="line">        OledShowChar(b, d, str[j], font);</span><br><span class="line">        b += <span class="number">8</span>; <span class="comment">/* 循环8次实现横屏填充 */</span></span><br><span class="line">        <span class="keyword">if</span> (b &gt; <span class="number">120</span>) &#123; <span class="comment">/* 循环120次实现横屏填充 */</span></span><br><span class="line">            b = <span class="number">0</span>;</span><br><span class="line">            d += <span class="number">2</span>; <span class="comment">/* 循环2次实现横屏填充 */</span></span><br><span class="line">        &#125;</span><br><span class="line">        j++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> IOT_GPIO_EX_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IOT_GPIO_EX_H</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief Enumerates GPIO pull-up or pull-down settings.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    <span class="comment">/** No pull */</span></span><br><span class="line">    IOT_IO_PULL_NONE,</span><br><span class="line">    <span class="comment">/** Pull-up */</span></span><br><span class="line">    IOT_IO_PULL_UP,</span><br><span class="line">    <span class="comment">/** Pull-down */</span></span><br><span class="line">    IOT_IO_PULL_DOWN,</span><br><span class="line">    <span class="comment">/** Maximum value */</span></span><br><span class="line">    IOT_IO_PULL_MAX,</span><br><span class="line">&#125; IotIoPull;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @ingroup iot_io</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * GPIO pin ID. CNcomment:IO硬件管脚编号。CNend</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_NAME_GPIO_0, <span class="comment">/* &lt;GPIO0 */</span></span><br><span class="line">    IOT_IO_NAME_GPIO_1, <span class="comment">/* &lt;GPIO1 */</span></span><br><span class="line">    IOT_IO_NAME_GPIO_2, <span class="comment">/* &lt;GPIO2 */</span></span><br><span class="line">    IOT_IO_NAME_GPIO_3, <span class="comment">/* &lt;GPIO3 */</span></span><br><span class="line">    IOT_IO_NAME_GPIO_4, <span class="comment">/* &lt;GPIO4 */</span></span><br><span class="line">    IOT_IO_NAME_GPIO_5, <span class="comment">/* &lt;GPIO5 */</span></span><br><span class="line">    IOT_IO_NAME_GPIO_6, <span class="comment">/* &lt;GPIO6 */</span></span><br><span class="line">    IOT_IO_NAME_GPIO_7, <span class="comment">/* &lt;GPIO7 */</span></span><br><span class="line">    IOT_IO_NAME_GPIO_8, <span class="comment">/* &lt;GPIO8 */</span></span><br><span class="line">    IOT_IO_NAME_GPIO_9, <span class="comment">/* &lt;GPIO9 */</span></span><br><span class="line">    IOT_IO_NAME_GPIO_10, <span class="comment">/* &lt;GPIO10 */</span></span><br><span class="line">    IOT_IO_NAME_GPIO_11, <span class="comment">/* &lt;GPIO11 */</span></span><br><span class="line">    IOT_IO_NAME_GPIO_12, <span class="comment">/* &lt;GPIO12 */</span></span><br><span class="line">    IOT_IO_NAME_GPIO_13, <span class="comment">/* &lt;GPIO13 */</span></span><br><span class="line">    IOT_IO_NAME_GPIO_14, <span class="comment">/* &lt;GPIO14 */</span></span><br><span class="line">    IOT_IO_NAME_SFC_CSN, <span class="comment">/* &lt;SFC_CSN */</span></span><br><span class="line">    IOT_IO_NAME_SFC_IO1, <span class="comment">/* &lt;SFC_IO1 */</span></span><br><span class="line">    IOT_IO_NAME_SFC_IO2, <span class="comment">/* &lt;SFC_IO2 */</span></span><br><span class="line">    IOT_IO_NAME_SFC_IO0, <span class="comment">/* &lt;SFC_IO0 */</span></span><br><span class="line">    IOT_IO_NAME_SFC_CLK, <span class="comment">/* &lt;SFC_CLK */</span></span><br><span class="line">    IOT_IO_NAME_SFC_IO3, <span class="comment">/* &lt;SFC_IO3 */</span></span><br><span class="line">    IOT_IO_NAME_MAX,</span><br><span class="line">&#125; IotIoName;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @ingroup iot_io</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * GPIO_0 pin function.CNcomment:GPIO_0管脚功能。CNend</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_0_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_0_UART1_TXD = <span class="number">2</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_0_SPI1_CK,</span><br><span class="line">    IOT_IO_FUNC_GPIO_0_JTAG_TDO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_0_PWM3_OUT,</span><br><span class="line">    IOT_IO_FUNC_GPIO_0_I2C1_SDA,</span><br><span class="line">&#125; IotIoFuncGpio0;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* GPIO_1 pin function.CNcomment:GPIO_1管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_1_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_1_UART1_RXD = <span class="number">2</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_1_SPI1_RXD,</span><br><span class="line">    IOT_IO_FUNC_GPIO_1_JTAG_TCK,</span><br><span class="line">    IOT_IO_FUNC_GPIO_1_PWM4_OUT,</span><br><span class="line">    IOT_IO_FUNC_GPIO_1_I2C1_SCL,</span><br><span class="line">    IOT_IO_FUNC_GPIO_1_BT_FREQ,</span><br><span class="line">&#125; IotIoFuncGpio1;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* GPIO_2 pin function.CNcomment:GPIO_2管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_2_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_2_UART1_RTS_N = <span class="number">2</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_2_SPI1_TXD,</span><br><span class="line">    IOT_IO_FUNC_GPIO_2_JTAG_TRSTN,</span><br><span class="line">    IOT_IO_FUNC_GPIO_2_PWM2_OUT,</span><br><span class="line">    IOT_IO_FUNC_GPIO_2_SSI_CLK = <span class="number">7</span>,</span><br><span class="line">&#125; IotIoFuncGpio2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* GPIO_3 pin function.CNcomment:GPIO_3管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_3_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_3_UART0_TXD,</span><br><span class="line">    IOT_IO_FUNC_GPIO_3_UART1_CTS_N,</span><br><span class="line">    IOT_IO_FUNC_GPIO_3_SPI1_CSN,</span><br><span class="line">    IOT_IO_FUNC_GPIO_3_JTAG_TDI,</span><br><span class="line">    IOT_IO_FUNC_GPIO_3_PWM5_OUT,</span><br><span class="line">    IOT_IO_FUNC_GPIO_3_I2C1_SDA,</span><br><span class="line">    IOT_IO_FUNC_GPIO_3_SSI_DATA,</span><br><span class="line">&#125; IotIoFuncGpio3;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* GPIO_4 pin function.CNcomment:GPIO_4管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_4_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_4_UART0_RXD = <span class="number">2</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_4_JTAG_TMS = <span class="number">4</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_4_PWM1_OUT,</span><br><span class="line">    IOT_IO_FUNC_GPIO_4_I2C1_SCL,</span><br><span class="line">&#125; IotIoFuncGpio4;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* GPIO_5 pin function.CNcomment:GPIO_5管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_5_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_5_UART1_RXD = <span class="number">2</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_5_SPI0_CSN,</span><br><span class="line">    IOT_IO_FUNC_GPIO_5_PWM2_OUT = <span class="number">5</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_5_I2S0_MCLK,</span><br><span class="line">    IOT_IO_FUNC_GPIO_5_BT_STATUS,</span><br><span class="line">&#125; IotIoFuncGpio5;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* GPIO_6 pin function.CNcomment:GPIO_6管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_6_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_6_UART1_TXD = <span class="number">2</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_6_SPI0_CK,</span><br><span class="line">    IOT_IO_FUNC_GPIO_6_PWM3_OUT = <span class="number">5</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_6_I2S0_TX,</span><br><span class="line">    IOT_IO_FUNC_GPIO_6_COEX_SWITCH,</span><br><span class="line">&#125; IotIoFuncGpio6;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* GPIO_7 pin function.CNcomment:GPIO_7管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_7_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_7_UART1_CTS_N = <span class="number">2</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_7_SPI0_RXD,</span><br><span class="line">    IOT_IO_FUNC_GPIO_7_PWM0_OUT = <span class="number">5</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_7_I2S0_BCLK,</span><br><span class="line">    IOT_IO_FUNC_GPIO_7_BT_ACTIVE,</span><br><span class="line">&#125; IotIoFuncGpio7;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* GPIO_8 pin function.CNcomment:GPIO_8管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_8_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_8_UART1_RTS_N = <span class="number">2</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_8_SPI0_TXD,</span><br><span class="line">    IOT_IO_FUNC_GPIO_8_PWM1_OUT = <span class="number">5</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_8_I2S0_WS,</span><br><span class="line">    IOT_IO_FUNC_GPIO_8_WLAN_ACTIVE,</span><br><span class="line">&#125; IotIoFuncGpio8;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* GPIO_9 pin function.CNcomment:GPIO_9管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_9_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_9_I2C0_SCL,</span><br><span class="line">    IOT_IO_FUNC_GPIO_9_UART2_RTS_N,</span><br><span class="line">    IOT_IO_FUNC_GPIO_9_SDIO_D2,</span><br><span class="line">    IOT_IO_FUNC_GPIO_9_SPI0_TXD,</span><br><span class="line">    IOT_IO_FUNC_GPIO_9_PWM0_OUT,</span><br><span class="line">    IOT_IO_FUNC_GPIO_9_I2S0_MCLK = <span class="number">7</span>,</span><br><span class="line">&#125; IotIoFuncGpio9;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* GPIO_10 pin function.CNcomment:GPIO_10管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_10_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_10_I2C0_SDA,</span><br><span class="line">    IOT_IO_FUNC_GPIO_10_UART2_CTS_N,</span><br><span class="line">    IOT_IO_FUNC_GPIO_10_SDIO_D3,</span><br><span class="line">    IOT_IO_FUNC_GPIO_10_SPI0_CK,</span><br><span class="line">    IOT_IO_FUNC_GPIO_10_PWM1_OUT,</span><br><span class="line">    IOT_IO_FUNC_GPIO_10_I2S0_TX = <span class="number">7</span>,</span><br><span class="line">&#125; IotIoFuncGpio10;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* GPIO_11 pin function.CNcomment:GPIO_11管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_11_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_11_UART2_TXD = <span class="number">2</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_11_SDIO_CMD,</span><br><span class="line">    IOT_IO_FUNC_GPIO_11_SPI0_RXD,</span><br><span class="line">    IOT_IO_FUNC_GPIO_11_PWM2_OUT,</span><br><span class="line">    IOT_IO_FUNC_GPIO_11_RF_TX_EN_EXT,</span><br><span class="line">    IOT_IO_FUNC_GPIO_11_I2S0_RX,</span><br><span class="line">&#125; IotIoFuncGpio11;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* GPIO_12 pin function.CNcomment:GPIO_12管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_12_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_12_UART2_RXD = <span class="number">2</span>,</span><br><span class="line">    IOT_IO_FUNC_GPIO_12_SDIO_CLK,</span><br><span class="line">    IOT_IO_FUNC_GPIO_12_SPI0_CSN,</span><br><span class="line">    IOT_IO_FUNC_GPIO_12_PWM3_OUT,</span><br><span class="line">    IOT_IO_FUNC_GPIO_12_RF_RX_EN_EXT,</span><br><span class="line">    IOT_IO_FUNC_GPIO_12_I2S0_BCLK,</span><br><span class="line">&#125; IotIoFuncGpio12;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* GPIO_13 pin function.CNcomment:GPIO_13管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_13_SSI_DATA,</span><br><span class="line">    IOT_IO_FUNC_GPIO_13_UART0_TXD,</span><br><span class="line">    IOT_IO_FUNC_GPIO_13_UART2_RTS_N,</span><br><span class="line">    IOT_IO_FUNC_GPIO_13_SDIO_D0,</span><br><span class="line">    IOT_IO_FUNC_GPIO_13_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_13_PWM4_OUT,</span><br><span class="line">    IOT_IO_FUNC_GPIO_13_I2C0_SDA,</span><br><span class="line">    IOT_IO_FUNC_GPIO_13_I2S0_WS,</span><br><span class="line">&#125; IotIoFuncGpio13;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* GPIO_14 pin function.CNcomment:GPIO_14管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_GPIO_14_SSI_CLK,</span><br><span class="line">    IOT_IO_FUNC_GPIO_14_UART0_RXD,</span><br><span class="line">    IOT_IO_FUNC_GPIO_14_UART2_CTS_N,</span><br><span class="line">    IOT_IO_FUNC_GPIO_14_SDIO_D1,</span><br><span class="line">    IOT_IO_FUNC_GPIO_14_GPIO,</span><br><span class="line">    IOT_IO_FUNC_GPIO_14_PWM5_OUT,</span><br><span class="line">    IOT_IO_FUNC_GPIO_14_I2C0_SCL,</span><br><span class="line">&#125; IotIoFuncGpio14;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* SFC_CSN pin function.CNcomment:SFC_CSN管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_SFC_CSN_SFC_CSN,</span><br><span class="line">    IOT_IO_FUNC_SFC_CSN_SDIO_D2,</span><br><span class="line">    IOT_IO_FUNC_SFC_CSN_GPIO9,</span><br><span class="line">    IOT_IO_FUNC_SFC_CSN_SPI0_TXD = <span class="number">4</span>,</span><br><span class="line">&#125; IotIoFuncSfcCsn;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* SFC_DO pin function.CNcomment:SFC_DO管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_SFC_IO_1_SFC_DO,</span><br><span class="line">    IOT_IO_FUNC_SFC_IO_1_SDIO_D3,</span><br><span class="line">    IOT_IO_FUNC_SFC_IO_1_GPIO10,</span><br><span class="line">    IOT_IO_FUNC_SFC_IO_1_SPI0_CK = <span class="number">4</span>,</span><br><span class="line">&#125; IotIoFuncSfcIo1;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* SFC_WPN pin function.CNcomment:SFC_WPN管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_SFC_IO_2_SFC_WPN,</span><br><span class="line">    IOT_IO_FUNC_SFC_IO_2_SDIO_CMD,</span><br><span class="line">    IOT_IO_FUNC_SFC_IO_2_GPIO11,</span><br><span class="line">    IOT_IO_FUNC_SFC_IO_2_RF_TX_EN_EXT,</span><br><span class="line">    IOT_IO_FUNC_SFC_IO_2_SPI0_RXD,</span><br><span class="line">&#125; IotIoFuncSfcIo2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* SFC_DI pin function.CNcomment:SFC_DI管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_SFC_IO_0_SFC_DI,</span><br><span class="line">    IOT_IO_FUNC_SFC_IO_0_SDIO_CLK,</span><br><span class="line">    IOT_IO_FUNC_SFC_IO_0_GPIO12,</span><br><span class="line">    IOT_IO_FUNC_SFC_IO_0_RF_RX_EN_EXT,</span><br><span class="line">    IOT_IO_FUNC_SFC_IO_0_SPI0_CSN,</span><br><span class="line">&#125; IotIoFuncSfcIo0;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* SFC_CLK pin function.CNcomment:SFC_CLK管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_SFC_CLK_SFC_CLK,</span><br><span class="line">    IOT_IO_FUNC_SFC_CLK_SDIO_D0,</span><br><span class="line">    IOT_IO_FUNC_SFC_CLK_GPIO13,</span><br><span class="line">    IOT_IO_FUNC_SFC_CLK_SSI_DATA = <span class="number">4</span>,</span><br><span class="line">&#125; IotIoFuncSfcClk;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* SFC_HOLDN pin function.CNcomment:SFC_HOLDN管脚功能。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_FUNC_SFC_IO_3_SFC_HOLDN,</span><br><span class="line">    IOT_IO_FUNC_SFC_IO_3_SDIO_D1,</span><br><span class="line">    IOT_IO_FUNC_SFC_IO_3_GPIO14,</span><br><span class="line">    IOT_IO_FUNC_SFC_IO_3_SSI_CLK = <span class="number">4</span>,</span><br><span class="line">&#125; IotIoFuncSfcIo3;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @ingroup iot_io</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* I/O drive capability.CNcomment:IO驱动能力。CNend</span></span><br><span class="line"><span class="comment">* Note: The HI_IO_NAME_GPIO_0~HI_IO_NAME_GPIO_11 and HI_IO_NAME_GPIO_13~HI_IO_NAME_GPIO_14 driver capabilities are</span></span><br><span class="line"><span class="comment">*       optional.The value range is HI_IO_DRIVER_STRENGTH_0~HI_IO_DRIVER_STRENGTH_3, and the other I/O ranges are</span></span><br><span class="line"><span class="comment">*       HI_IO_DRIVER_STRENGTH_0~HI_IO_DRIVER_STRENGTH_7.CNcomment:注意:HI_IO_NAME_GPIO_0~HI_IO_NAME_GPIO_11、</span></span><br><span class="line"><span class="comment">*       HI_IO_NAME_GPIO_13~HI_IO_NAME_GPIO_14驱动能力可选范围是HI_IO_DRIVER_STRENGTH_0~HI_IO_DRIVER_STRENGTH_3，</span></span><br><span class="line"><span class="comment">*       其余IO范围是HI_IO_DRIVER_STRENGTH_0~HI_IO_DRIVER_STRENGTH_7。CNend</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    IOT_IO_DRIVER_STRENGTH_0 = <span class="number">0</span>,   <span class="comment">/* &lt;Drive strength level 0 (highest).CNcomment:驱动能力0级，驱动能力最高CNend */</span></span><br><span class="line">    IOT_IO_DRIVER_STRENGTH_1,   <span class="comment">/* &lt;Drive strength level 1.CNcomment:驱动能力1级CNend */</span></span><br><span class="line">    IOT_IO_DRIVER_STRENGTH_2,   <span class="comment">/* &lt;Drive strength level 2.CNcomment:驱动能力2级CNend */</span></span><br><span class="line">    IOT_IO_DRIVER_STRENGTH_3,   <span class="comment">/* &lt;Drive strength level 3.CNcomment:驱动能力3级CNend */</span></span><br><span class="line">    IOT_IO_DRIVER_STRENGTH_4,   <span class="comment">/* &lt;Drive strength level 4.CNcomment:驱动能力4级CNend */</span></span><br><span class="line">    IOT_IO_DRIVER_STRENGTH_5,   <span class="comment">/* &lt;Drive strength level 5.CNcomment:驱动能力5级CNend */</span></span><br><span class="line">    IOT_IO_DRIVER_STRENGTH_6,   <span class="comment">/* &lt;Drive strength level 6.CNcomment:驱动能力6级CNend */</span></span><br><span class="line">    IOT_IO_DRIVER_STRENGTH_7,   <span class="comment">/* &lt;Drive strength level 7 (lowest).CNcomment:驱动能力7级，驱动能力最低CNend */</span></span><br><span class="line">    IOT_IO_DRIVER_STRENGTH_MAX,</span><br><span class="line">&#125; IotIoDriverStrength;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">IoSetPull</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> id, IotIoPull val)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">IoSetFunc</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> id, <span class="type">unsigned</span> <span class="type">char</span> val)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">TaskMsleep</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> ms)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">/** @&#125; */</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-4"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> OLED_FONTS_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OLED_FONTS_H</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/************************************6*8的点阵************************************/</span></span><br><span class="line"><span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> g_f6X8[][<span class="number">6</span>] = &#123;</span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span> &#125;, <span class="comment">// sp</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x2f</span>, <span class="number">0x00</span>, <span class="number">0x00</span> &#125;, <span class="comment">// !</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x00</span> &#125;, <span class="comment">// &quot;</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x14</span>, <span class="number">0x7f</span>, <span class="number">0x14</span>, <span class="number">0x7f</span>, <span class="number">0x14</span> &#125;, <span class="comment">// #</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x24</span>, <span class="number">0x2a</span>, <span class="number">0x7f</span>, <span class="number">0x2a</span>, <span class="number">0x12</span> &#125;, <span class="comment">// $</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x62</span>, <span class="number">0x64</span>, <span class="number">0x08</span>, <span class="number">0x13</span>, <span class="number">0x23</span> &#125;, <span class="comment">// %</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x36</span>, <span class="number">0x49</span>, <span class="number">0x55</span>, <span class="number">0x22</span>, <span class="number">0x50</span> &#125;, <span class="comment">// &amp;</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span> &#125;, <span class="comment">// &#x27;</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x1c</span>, <span class="number">0x22</span>, <span class="number">0x41</span>, <span class="number">0x00</span> &#125;, <span class="comment">// (</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x22</span>, <span class="number">0x1c</span>, <span class="number">0x00</span> &#125;, <span class="comment">// )</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x14</span>, <span class="number">0x08</span>, <span class="number">0x3E</span>, <span class="number">0x08</span>, <span class="number">0x14</span> &#125;, <span class="comment">// *</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x3E</span>, <span class="number">0x08</span>, <span class="number">0x08</span> &#125;, <span class="comment">// +</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xA0</span>, <span class="number">0x60</span>, <span class="number">0x00</span> &#125;, <span class="comment">// ,</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span> &#125;, <span class="comment">// -</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x60</span>, <span class="number">0x60</span>, <span class="number">0x00</span>, <span class="number">0x00</span> &#125;, <span class="comment">// .</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x04</span>, <span class="number">0x02</span> &#125;, <span class="comment">// /</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x3E</span>, <span class="number">0x51</span>, <span class="number">0x49</span>, <span class="number">0x45</span>, <span class="number">0x3E</span> &#125;, <span class="comment">// 0</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x42</span>, <span class="number">0x7F</span>, <span class="number">0x40</span>, <span class="number">0x00</span> &#125;, <span class="comment">// 1</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x42</span>, <span class="number">0x61</span>, <span class="number">0x51</span>, <span class="number">0x49</span>, <span class="number">0x46</span> &#125;, <span class="comment">// 2</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x21</span>, <span class="number">0x41</span>, <span class="number">0x45</span>, <span class="number">0x4B</span>, <span class="number">0x31</span> &#125;, <span class="comment">// 3</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x18</span>, <span class="number">0x14</span>, <span class="number">0x12</span>, <span class="number">0x7F</span>, <span class="number">0x10</span> &#125;, <span class="comment">// 4</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x27</span>, <span class="number">0x45</span>, <span class="number">0x45</span>, <span class="number">0x45</span>, <span class="number">0x39</span> &#125;, <span class="comment">// 5</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x3C</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x49</span>, <span class="number">0x30</span> &#125;, <span class="comment">// 6</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x71</span>, <span class="number">0x09</span>, <span class="number">0x05</span>, <span class="number">0x03</span> &#125;, <span class="comment">// 7</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x36</span>, <span class="number">0x49</span>, <span class="number">0x49</span>, <span class="number">0x49</span>, <span class="number">0x36</span> &#125;, <span class="comment">// 8</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x06</span>, <span class="number">0x49</span>, <span class="number">0x49</span>, <span class="number">0x29</span>, <span class="number">0x1E</span> &#125;, <span class="comment">// 9</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x36</span>, <span class="number">0x36</span>, <span class="number">0x00</span>, <span class="number">0x00</span> &#125;, <span class="comment">// :</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x56</span>, <span class="number">0x36</span>, <span class="number">0x00</span>, <span class="number">0x00</span> &#125;, <span class="comment">// ;号</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x14</span>, <span class="number">0x22</span>, <span class="number">0x41</span>, <span class="number">0x00</span> &#125;, <span class="comment">// &lt;</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x14</span>, <span class="number">0x14</span>, <span class="number">0x14</span>, <span class="number">0x14</span>, <span class="number">0x14</span> &#125;, <span class="comment">// =</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x22</span>, <span class="number">0x14</span>, <span class="number">0x08</span> &#125;, <span class="comment">// &gt;</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x51</span>, <span class="number">0x09</span>, <span class="number">0x06</span> &#125;, <span class="comment">// ?</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x32</span>, <span class="number">0x49</span>, <span class="number">0x59</span>, <span class="number">0x51</span>, <span class="number">0x3E</span> &#125;, <span class="comment">// @</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7C</span>, <span class="number">0x12</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x7C</span> &#125;, <span class="comment">// A</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x49</span>, <span class="number">0x49</span>, <span class="number">0x49</span>, <span class="number">0x36</span> &#125;, <span class="comment">// B</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x3E</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x22</span> &#125;, <span class="comment">// C</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x22</span>, <span class="number">0x1C</span> &#125;, <span class="comment">// D</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x49</span>, <span class="number">0x49</span>, <span class="number">0x49</span>, <span class="number">0x41</span> &#125;, <span class="comment">// E</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x09</span>, <span class="number">0x09</span>, <span class="number">0x09</span>, <span class="number">0x01</span> &#125;, <span class="comment">// F</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x3E</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x49</span>, <span class="number">0x7A</span> &#125;, <span class="comment">// G</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x7F</span> &#125;, <span class="comment">// H</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x7F</span>, <span class="number">0x41</span>, <span class="number">0x00</span> &#125;, <span class="comment">// I</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x41</span>, <span class="number">0x3F</span>, <span class="number">0x01</span> &#125;, <span class="comment">// J</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x08</span>, <span class="number">0x14</span>, <span class="number">0x22</span>, <span class="number">0x41</span> &#125;, <span class="comment">// K</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x40</span> &#125;, <span class="comment">// L</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x02</span>, <span class="number">0x7F</span> &#125;, <span class="comment">// M</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x7F</span> &#125;, <span class="comment">// N</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x3E</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x3E</span> &#125;, <span class="comment">// O</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x09</span>, <span class="number">0x09</span>, <span class="number">0x09</span>, <span class="number">0x06</span> &#125;, <span class="comment">// P</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x3E</span>, <span class="number">0x41</span>, <span class="number">0x51</span>, <span class="number">0x21</span>, <span class="number">0x5E</span> &#125;, <span class="comment">// Q</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x09</span>, <span class="number">0x19</span>, <span class="number">0x29</span>, <span class="number">0x46</span> &#125;, <span class="comment">// R</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x46</span>, <span class="number">0x49</span>, <span class="number">0x49</span>, <span class="number">0x49</span>, <span class="number">0x31</span> &#125;, <span class="comment">// S</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x7F</span>, <span class="number">0x01</span>, <span class="number">0x01</span> &#125;, <span class="comment">// T</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x3F</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x3F</span> &#125;, <span class="comment">// U</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x1F</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x20</span>, <span class="number">0x1F</span> &#125;, <span class="comment">// V</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x3F</span>, <span class="number">0x40</span>, <span class="number">0x38</span>, <span class="number">0x40</span>, <span class="number">0x3F</span> &#125;, <span class="comment">// W</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x63</span>, <span class="number">0x14</span>, <span class="number">0x08</span>, <span class="number">0x14</span>, <span class="number">0x63</span> &#125;, <span class="comment">// X</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x70</span>, <span class="number">0x08</span>, <span class="number">0x07</span> &#125;, <span class="comment">// Y</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x61</span>, <span class="number">0x51</span>, <span class="number">0x49</span>, <span class="number">0x45</span>, <span class="number">0x43</span> &#125;, <span class="comment">// Z</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x00</span> &#125;, <span class="comment">// [</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x55</span>, <span class="number">0x2A</span>, <span class="number">0x55</span>, <span class="number">0x2A</span>, <span class="number">0x55</span> &#125;, <span class="comment">// 55</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x7F</span>, <span class="number">0x00</span> &#125;, <span class="comment">// ]</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span> &#125;, <span class="comment">// ^</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x40</span> &#125;, <span class="comment">// _</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x00</span> &#125;, <span class="comment">// &#x27;</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x78</span> &#125;, <span class="comment">// a</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x48</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x38</span> &#125;, <span class="comment">// b</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x38</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x20</span> &#125;, <span class="comment">// c</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x38</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x48</span>, <span class="number">0x7F</span> &#125;, <span class="comment">// d</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x38</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x18</span> &#125;, <span class="comment">// e</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x7E</span>, <span class="number">0x09</span>, <span class="number">0x01</span>, <span class="number">0x02</span> &#125;, <span class="comment">// f</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x18</span>, <span class="number">0xA4</span>, <span class="number">0xA4</span>, <span class="number">0xA4</span>, <span class="number">0x7C</span> &#125;, <span class="comment">// g</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x08</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x78</span> &#125;, <span class="comment">// h</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x44</span>, <span class="number">0x7D</span>, <span class="number">0x40</span>, <span class="number">0x00</span> &#125;, <span class="comment">// i</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x84</span>, <span class="number">0x7D</span>, <span class="number">0x00</span> &#125;, <span class="comment">// j</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x10</span>, <span class="number">0x28</span>, <span class="number">0x44</span>, <span class="number">0x00</span> &#125;, <span class="comment">// k</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x7F</span>, <span class="number">0x40</span>, <span class="number">0x00</span> &#125;, <span class="comment">// l</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7C</span>, <span class="number">0x04</span>, <span class="number">0x18</span>, <span class="number">0x04</span>, <span class="number">0x78</span> &#125;, <span class="comment">// m</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7C</span>, <span class="number">0x08</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x78</span> &#125;, <span class="comment">// n</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x38</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x38</span> &#125;, <span class="comment">// o</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0xFC</span>, <span class="number">0x24</span>, <span class="number">0x24</span>, <span class="number">0x24</span>, <span class="number">0x18</span> &#125;, <span class="comment">// p</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x18</span>, <span class="number">0x24</span>, <span class="number">0x24</span>, <span class="number">0x18</span>, <span class="number">0xFC</span> &#125;, <span class="comment">// q</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x7C</span>, <span class="number">0x08</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x08</span> &#125;, <span class="comment">// r</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x48</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x20</span> &#125;, <span class="comment">// s</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x3F</span>, <span class="number">0x44</span>, <span class="number">0x40</span>, <span class="number">0x20</span> &#125;, <span class="comment">// t</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x3C</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x20</span>, <span class="number">0x7C</span> &#125;, <span class="comment">// u</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x1C</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x20</span>, <span class="number">0x1C</span> &#125;, <span class="comment">// v</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x3C</span>, <span class="number">0x40</span>, <span class="number">0x30</span>, <span class="number">0x40</span>, <span class="number">0x3C</span> &#125;, <span class="comment">// w</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x44</span>, <span class="number">0x28</span>, <span class="number">0x10</span>, <span class="number">0x28</span>, <span class="number">0x44</span> &#125;, <span class="comment">// x</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x1C</span>, <span class="number">0xA0</span>, <span class="number">0xA0</span>, <span class="number">0xA0</span>, <span class="number">0x7C</span> &#125;, <span class="comment">// y</span></span><br><span class="line">    &#123; <span class="number">0x00</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0x54</span>, <span class="number">0x4C</span>, <span class="number">0x44</span> &#125;, <span class="comment">// z</span></span><br><span class="line">    &#123; <span class="number">0x14</span>, <span class="number">0x14</span>, <span class="number">0x14</span>, <span class="number">0x14</span>, <span class="number">0x14</span>, <span class="number">0x14</span> &#125;, <span class="comment">// horiz lines</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/****************************************8*16的点阵************************************/</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> g_f8X16[] = &#123;</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// 0</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x33</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// ! 1</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x10</span>, <span class="number">0x0C</span>, <span class="number">0x06</span>, <span class="number">0x10</span>, <span class="number">0x0C</span>, <span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// &quot; 2</span></span><br><span class="line">    <span class="number">0x40</span>, <span class="number">0xC0</span>, <span class="number">0x78</span>, <span class="number">0x40</span>, <span class="number">0xC0</span>, <span class="number">0x78</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x3F</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x3F</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="comment">// # 3</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x70</span>, <span class="number">0x88</span>, <span class="number">0xFC</span>, <span class="number">0x08</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x18</span>, <span class="number">0x20</span>, <span class="number">0xFF</span>, <span class="number">0x21</span>, <span class="number">0x1E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// $ 4</span></span><br><span class="line">    <span class="number">0xF0</span>, <span class="number">0x08</span>, <span class="number">0xF0</span>, <span class="number">0x00</span>, <span class="number">0xE0</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x21</span>, <span class="number">0x1C</span>, <span class="number">0x03</span>, <span class="number">0x1E</span>, <span class="number">0x21</span>, <span class="number">0x1E</span>, <span class="number">0x00</span>, <span class="comment">// % 5</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0xF0</span>, <span class="number">0x08</span>, <span class="number">0x88</span>, <span class="number">0x70</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x1E</span>, <span class="number">0x21</span>, <span class="number">0x23</span>, <span class="number">0x24</span>, <span class="number">0x19</span>, <span class="number">0x27</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="comment">// &amp; 6</span></span><br><span class="line">    <span class="number">0x10</span>, <span class="number">0x16</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// &#x27; 7</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xE0</span>, <span class="number">0x18</span>, <span class="number">0x04</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x18</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="comment">// ( 8</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x18</span>, <span class="number">0xE0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x20</span>, <span class="number">0x18</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// ) 9</span></span><br><span class="line">    <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0xF0</span>, <span class="number">0x80</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x0F</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="comment">// * 10</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x1F</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="comment">// + 11</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0xB0</span>, <span class="number">0x70</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// , 12</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="comment">// - 13</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// . 14</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x60</span>, <span class="number">0x18</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x60</span>, <span class="number">0x18</span>, <span class="number">0x06</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// / 15</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0xE0</span>, <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0xE0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="comment">// 0 16</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x10</span>, <span class="number">0x10</span>, <span class="number">0xF8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// 1 17</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x70</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x88</span>, <span class="number">0x70</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x28</span>, <span class="number">0x24</span>, <span class="number">0x22</span>, <span class="number">0x21</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, <span class="comment">// 2 18</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x08</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0x48</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x18</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x11</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="comment">// 3 19</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC0</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0xF8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x04</span>, <span class="number">0x24</span>, <span class="number">0x24</span>, <span class="number">0x3F</span>, <span class="number">0x24</span>, <span class="number">0x00</span>, <span class="comment">// 4 20</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0xF8</span>, <span class="number">0x08</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x19</span>, <span class="number">0x21</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x11</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="comment">// 5 21</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0xE0</span>, <span class="number">0x10</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0x11</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x11</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="comment">// 6 22</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x38</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0xC8</span>, <span class="number">0x38</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x3F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// 7 23</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x70</span>, <span class="number">0x88</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x88</span>, <span class="number">0x70</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x1C</span>, <span class="number">0x22</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x1C</span>, <span class="number">0x00</span>, <span class="comment">// 8 24</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0xE0</span>, <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0xE0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x31</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x11</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="comment">// 9 25</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// : 26</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x60</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// ;号 27</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x40</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="comment">// &lt; 28</span></span><br><span class="line">    <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="comment">// = 29</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x04</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="comment">// &gt; 30</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0xF0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// ? 31</span></span><br><span class="line">    <span class="number">0xC0</span>, <span class="number">0x30</span>, <span class="number">0xC8</span>, <span class="number">0x28</span>, <span class="number">0xE8</span>, <span class="number">0x10</span>, <span class="number">0xE0</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x18</span>, <span class="number">0x27</span>, <span class="number">0x24</span>, <span class="number">0x23</span>, <span class="number">0x14</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="comment">// @ 32</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC0</span>, <span class="number">0x38</span>, <span class="number">0xE0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3C</span>, <span class="number">0x23</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x27</span>, <span class="number">0x38</span>, <span class="number">0x20</span>, <span class="comment">// A 33</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0x70</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x11</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="comment">// B 34</span></span><br><span class="line">    <span class="number">0xC0</span>, <span class="number">0x30</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x38</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x18</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="comment">// C 35</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0xE0</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="comment">// D 36</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0xE8</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x23</span>, <span class="number">0x20</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="comment">// E 37</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0xE8</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// F 38</span></span><br><span class="line">    <span class="number">0xC0</span>, <span class="number">0x30</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x38</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x18</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x22</span>, <span class="number">0x1E</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="comment">// G 39</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x08</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x21</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x21</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="comment">// H 40</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// I 41</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0xC0</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x7F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// J 42</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x88</span>, <span class="number">0xC0</span>, <span class="number">0x28</span>, <span class="number">0x18</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x01</span>, <span class="number">0x26</span>, <span class="number">0x38</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="comment">// K 43</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, <span class="comment">// L 44</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0xF8</span>, <span class="number">0x00</span>, <span class="number">0xF8</span>, <span class="number">0xF8</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x00</span>, <span class="number">0x3F</span>, <span class="number">0x00</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="comment">// M 45</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x30</span>, <span class="number">0xC0</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x08</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x18</span>, <span class="number">0x3F</span>, <span class="number">0x00</span>, <span class="comment">// N 46</span></span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0xE0</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="comment">// O 47</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0xF0</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x21</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// P 48</span></span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0xE0</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0x18</span>, <span class="number">0x24</span>, <span class="number">0x24</span>, <span class="number">0x38</span>, <span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="comment">// Q 49</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0x70</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x0C</span>, <span class="number">0x30</span>, <span class="number">0x20</span>, <span class="comment">// R 50</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x70</span>, <span class="number">0x88</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x38</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x38</span>, <span class="number">0x20</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x1C</span>, <span class="number">0x00</span>, <span class="comment">// S 51</span></span><br><span class="line">    <span class="number">0x18</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// T 52</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x1F</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x1F</span>, <span class="number">0x00</span>, <span class="comment">// U 53</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0x78</span>, <span class="number">0x88</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC8</span>, <span class="number">0x38</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x38</span>, <span class="number">0x0E</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// V 54</span></span><br><span class="line">    <span class="number">0xF8</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0xF8</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x3C</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x3C</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="comment">// W 55</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0x18</span>, <span class="number">0x68</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x68</span>, <span class="number">0x18</span>, <span class="number">0x08</span>, <span class="number">0x20</span>, <span class="number">0x30</span>, <span class="number">0x2C</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x2C</span>, <span class="number">0x30</span>, <span class="number">0x20</span>, <span class="comment">// X 56</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0x38</span>, <span class="number">0xC8</span>, <span class="number">0x00</span>, <span class="number">0xC8</span>, <span class="number">0x38</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// Y 57</span></span><br><span class="line">    <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0xC8</span>, <span class="number">0x38</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x38</span>, <span class="number">0x26</span>, <span class="number">0x21</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="comment">// Z 58</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xFE</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x7F</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="comment">// [ 59</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x0C</span>, <span class="number">0x30</span>, <span class="number">0xC0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x06</span>, <span class="number">0x38</span>, <span class="number">0xC0</span>, <span class="number">0x00</span>, <span class="comment">// \ 60</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0xFE</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x7F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// ] 61</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// ^ 62</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="comment">// _ 63</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// ` 64</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x19</span>, <span class="number">0x24</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="comment">// a 65</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x3F</span>, <span class="number">0x11</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x11</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="comment">// b 66</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0E</span>, <span class="number">0x11</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="comment">// c 67</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x88</span>, <span class="number">0xF8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0E</span>, <span class="number">0x11</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="comment">// d 68</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x1F</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x13</span>, <span class="number">0x00</span>, <span class="comment">// e 69</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0xF0</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// f 70</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6B</span>, <span class="number">0x94</span>, <span class="number">0x94</span>, <span class="number">0x94</span>, <span class="number">0x93</span>, <span class="number">0x60</span>, <span class="number">0x00</span>, <span class="comment">// g 71</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x21</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="comment">// h 72</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x98</span>, <span class="number">0x98</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// i 73</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x98</span>, <span class="number">0x98</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC0</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x7F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// j 74</span></span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x24</span>, <span class="number">0x02</span>, <span class="number">0x2D</span>, <span class="number">0x30</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="comment">// k 75</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0xF8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// l 76</span></span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x3F</span>, <span class="comment">// m 77</span></span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x21</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="comment">// n 78</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x1F</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x1F</span>, <span class="number">0x00</span>, <span class="comment">// o 79</span></span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0xFF</span>, <span class="number">0xA1</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x11</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="comment">// p 80</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0E</span>, <span class="number">0x11</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0xA0</span>, <span class="number">0xFF</span>, <span class="number">0x80</span>, <span class="comment">// q 81</span></span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x3F</span>, <span class="number">0x21</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="comment">// r 82</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x33</span>, <span class="number">0x24</span>, <span class="number">0x24</span>, <span class="number">0x24</span>, <span class="number">0x24</span>, <span class="number">0x19</span>, <span class="number">0x00</span>, <span class="comment">// s 83</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0xE0</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x1F</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// t 84</span></span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x1F</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0x3F</span>, <span class="number">0x20</span>, <span class="comment">// u 85</span></span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x0E</span>, <span class="number">0x30</span>, <span class="number">0x08</span>, <span class="number">0x06</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="comment">// v 86</span></span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x0F</span>, <span class="number">0x30</span>, <span class="number">0x0C</span>, <span class="number">0x03</span>, <span class="number">0x0C</span>, <span class="number">0x30</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="comment">// w 87</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x31</span>, <span class="number">0x2E</span>, <span class="number">0x0E</span>, <span class="number">0x31</span>, <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="comment">// x 88</span></span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x81</span>, <span class="number">0x8E</span>, <span class="number">0x70</span>, <span class="number">0x18</span>, <span class="number">0x06</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="comment">// y 89</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x21</span>, <span class="number">0x30</span>, <span class="number">0x2C</span>, <span class="number">0x22</span>, <span class="number">0x21</span>, <span class="number">0x30</span>, <span class="number">0x00</span>, <span class="comment">// z 90</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x7C</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x3F</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="comment">// &#123; 91</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// | 92</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x7C</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x3F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// &#125; 93</span></span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x06</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// ~ 94</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-5"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> OLED_SSD1306_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OLED_SSD1306_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief ssd1306 OLED Initialize.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">OledInit</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief Set cursor position</span></span><br><span class="line"><span class="comment"> * @param x the horizontal posistion of cursor</span></span><br><span class="line"><span class="comment"> * @param y the vertical position of cursor</span></span><br><span class="line"><span class="comment"> * @return Returns &#123;@link WIFI_IOT_SUCCESS&#125; if the operation is successful;</span></span><br><span class="line"><span class="comment"> * returns an error code defined in &#123;@link wifiiot_errno.h&#125; otherwise.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">OledSetPosition</span><span class="params">(<span class="type">uint8_t</span> x, <span class="type">uint8_t</span> y)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">OledFillScreen</span><span class="params">(<span class="type">uint8_t</span> fillData)</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Font</span> &#123;</span></span><br><span class="line">    FONT6_X8 = <span class="number">1</span>,</span><br><span class="line">    FONT8_X16</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> <span class="title">Font</span> <span class="title">Font</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">OledShowChar</span><span class="params">(<span class="type">uint8_t</span> x, <span class="type">uint8_t</span> y, <span class="type">uint8_t</span> ch, Font font)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">OledShowString</span><span class="params">(<span class="type">uint8_t</span> x, <span class="type">uint8_t</span> y, <span class="type">const</span> <span class="type">char</span>* str, Font font)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// OLED_SSD1306_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h1 id="Hi3516DV300板子开发">Hi3516DV300板子开发</h1><div class="note blue icon modern"><p>由于篇幅问题，点击<a href="https://asa-world.cn/36f24770/">这里</a>阅读分类网模型的训练。</p></div>]]></content>
      
      
      <categories>
          
          <category> 人工智能 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ubuntu </tag>
            
            <tag> 项目开发 </tag>
            
            <tag> 机器视觉 </tag>
            
            <tag> 人工智能 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用SDN网络架构的dijkstra算法实践</title>
      <link href="/39935ec6/"/>
      <url>/39935ec6/</url>
      
        <content type="html"><![CDATA[<h1 id="项目要求-4">项目要求</h1><ol><li>使用 Dijkstra 算法（dial 实现）计算任意两点间的最短路；</li><li>使用最短路由配置任意两点间的通信业务；</li><li>将所有业务在可视化平台上进行展示。</li></ol><h1 id="Dijkstra-算法原理">Dijkstra 算法原理</h1><h2 id="基本思想-4">基本思想</h2><p>Dijkstra 算法使用了广度优先搜索解决赋权有向图或者无向图的单源最短路径问题，采用的是一种贪心的策略，构造一个循环，每次循环都增加一个顶点到最短路径树上，所选择的顶点即为在所有与树邻接的顶点中和源点最近的顶点， 其中就隐含了广度优先搜索的思想，逐步地发展最短路径树，直到它覆盖所有顶点。其中，记录每一个顶点的前继节点可以实现最短路的重建，对距离的更新可以保证现有路径为当前最优解。</p><h2 id="基本步骤-3">基本步骤</h2><ol><li>初始化：使用 d(i)来表示顶点 i 的距离标记，初始化为无穷大；使用 p(i)来表示顶点 i 在最短路径树上的前继点，初始化为 null；使用 S 表示最短路径树上的顶点集合，初始化时加入源点 s，同时将 s 点的距离标记初始化为 0， 前继点为 null</li><li>对 s 点做更新，更新操作为：对需要更新的点 i 的所有邻接点，如果 i 点到源点的距离和 i 点到邻接点的权重之和小于邻接点到源点的的距离，由贪心算法求局部最优解的要求，将该邻接点到源点的距离标记更新为 i 点到源点的距离和 i 点到邻接点的权重之和，此时邻接点的前继点为 i。</li><li>循环扩张最小路径树，直到所有顶点都在该树上，循环内的操作为： 找出已经永久标记的顶点集合和未被标记的顶点集合之间的权重最小割边，将该割边上未被探索的顶点加入已被标记的顶点集合，同时更新对该顶点做更新，更新操作如（2）。</li><li>以上方法为单源多宿最短路的求解，若要求解单源单宿最短路，可以增加一个判断模块，当宿点被永久标记时终止循环。永久标记条件：当一点的所 有入度的另一端都已经被永久标记时，该点即可被永久标记。</li></ol><h2 id="示例-3">示例</h2><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223348508.png" alt="示例拓扑图"></p><p>上图是一个无向有权图，若源点为 a，最小路径树的生成过程为：</p><ol><li>a-&gt;b:0+1&lt; ∞ ; a −&gt; c: 0 + 6 &lt; ∞. 所以 d[b] = 1, d[c] = 6，前继点为 a,进入 while 循环，选择最小割边，将 b 加入最小路径树，更新 b；</li><li>对 b 的邻接点做更新，1+2 &lt; d[d] ，1+5 &lt; d[e] ，所以d[d]  = d[b] + w[b,d] = 3，d[e] = d[b] +w[b,e] = 6 ，将 d,e 的前继点设为 b，进入下一次循环，选择最小割边， 将 d 加入最小路径树，更新 d；</li><li>一直进行如上的循环，直到所有顶点都在最短路径树上。</li></ol><h1 id="算法实现-2">算法实现</h1><h2 id="引进新的数据结构——桶">引进新的数据结构——桶</h2><h3 id="特殊之处">特殊之处</h3><p>根据距离值的最大值留出足够数量的桶，桶的标记即为距离值，根据顶点的距离标记将顶点加入不同的桶中，执行 FindMin 操作时直接从 标记最小的桶读起，节约了比较的时间。同时，距离标记更新后要将顶点转移到 新的桶里面，</p><h3 id="桶的数量">桶的数量</h3><p>令 C 表示边权的最大值，则距离的最大值为 nC，同时还有 一个距离为无穷大的桶，所以总共需要 nC+1 个桶。</p><h3 id="缺陷">缺陷</h3><p>nC 数量级的桶太消耗空间了，有大量的桶一直闲置。</p><h3 id="改进：循环桶">改进：循环桶</h3><p>由于边界点的距离标记不会超过 d[i]+C（i 为当前标记点，C 为权重最大值）， 对顶点 x 的标号为 d[x]mod(C+1)，最多需要 C+1 个桶。</p><p>对于同一个桶里面的实际上距离标记不相同的点不必做额外处理，因为第一次永久标记的节点距离标记肯定是最短的，该永久标记点的邻接点不可能在同一个桶中（边权重值最大为 C，桶的编号为距离标记对 C+1 取余后的值），除非两个邻接点和该点之间的边权值相同，即使如此，选其中的任意一个也没有问题。 考虑是否标记邻接点时只需要判断邻接点是否已经被永久标记，是则不再标记， 否则永久标记。</p><p>每永久标记一次，桶的头部都要往后一个桶移动，并且保证改变桶的头部之 前先把头部桶里面的所有节点清除出桶，然后永久标记。</p><h2 id="实现方式比较-2">实现方式比较</h2><h3 id="数组（队列）实现">数组（队列）实现</h3><p>此方法为最通用的算法实现方法，也是对读者来说最容易理解的一种实现方法。核心思想为用一个数据结构来维护所有的边界点，相当于所有边界边被分成不同的小集合，与同一个边界点相关联的那些边只记录一个最小值。相比与直接简单粗暴地每次都搜索所有边再筛选后进行更新距离的 Dijkstra 的最直接实现算法，此算法的运行时间从 O(nm) 优化到了 O(n*n+m)。</p><h3 id="堆实现">堆实现</h3><p>此方法逻辑上和 1 类似，只是用堆来维护 V-X 集合。堆本身可以利用 Python 中的 heapq 模块较为简单地实现各种操作，如存储时就给元素进行排序，在调用弹出元素时会自行选择最大或最小的元素进行弹出。距离值更新后要将元素先从堆中删除，再插入。这减少了算法中的代码编写和算法的复杂度。此方法下总 RT 为 O(mlogn)。</p><h3 id="桶实现">桶实现</h3><p>此方法逻辑上和 1 类似，只是用桶来维护 V-X 集合。对普通桶，令 C 表示边权的最大值，则桶的数目上限为 nC+1。此时 RT 为 O(m+nC)。循环桶则是减小了桶的用量，但是 RT 不变。因为每个桶被检查的数目依旧会增大。从多次实验的结果来看，此方法在 RT 上实际上优于方法2。</p><p>最终，我们选择使用循环桶来实现 Dijkstra 算法。</p><h2 id="循环桶实现-dijkstra-算法">循环桶实现 dijkstra 算法</h2><h3 id="步骤">步骤</h3><ol><li>初始化桶，把源节点加入到桶中。</li><li>弹出最小距离标记节点。</li><li>将最小距离标记节点永久标记。</li><li>将永久标记节点的所有邻接节点入桶。</li><li>重复 bcd 操作，直到所有桶空，算法结束。</li></ol><h3 id="示例-4">示例</h3><p>上图为一个有向有权图。若源点为 1 号点，则最短路径树的生成过程为</p><ol><li>首先初始化循环桶，由于最大边权重为 15，所以 C 为 15。将点 1 放入桶内， 因为此时将点 1 的距离设为了 0，因此放入桶头（初始化时设置桶头为第一个桶），如图 2.5 所示。</li></ol><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223410578.png" alt="桶状态示意图"></p><ol start="2"><li>进入循环，弹出最小距离标记节点。此时先从桶头开始搜索，按顺序寻找第 一个不为空的桶。在此范例中顺序为顺时针。找到该桶后开始弹出此桶内的元素。 在此范例中弹出的元素是 1 号；</li><li>之后开始检索，首先判断 1 号是否已经被永久标记，判断结果为 1 号未被永 久标记，则此时将 1 号永久标记。标记的同时永久记录此时的记录值，不再更改。</li><li>标记后搜索与 1 号相连的节点，将相应节点按照此时对应的距离对 16 取余后 的结果加入桶中。在本例中，加入 2 号（入 1 桶），再加入 3 号（入 12 桶）。如图 2.6 所示；</li><li>此时一轮循环已经结束，开始进行下一轮循环。桶头开始按顺时针方向移动， 直到找到下一个非空桶。在本例中它会发现 1 桶。开始清空此时的 1 桶。如图 2.7 所示；</li><li>2 号点被弹出，判断后进行永久标记并开始搜索和 2 号点相连的点。只要点未被永久标记，就按照 d 中规则将它们按照对应的距离值入相应的桶。需要注意的是，此时桶内会有两个 3 号点，因为它的距离值被更新过。但由于优先被弹出并且标记的 3 号点对应的距离一定更小，所以这种加入方式等效于让 3 号点移动到了能更快被弹出的桶内。见图 2.8；</li><li>重复上述过程，直到整个桶内无空桶，理论上整个图就完成了遍历，按照永久标记时记录的距离值可生成最小生成树。</li></ol><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223542219.png" alt="桶状态示意图"></p><h2 id="代码实现-4">代码实现</h2><h3 id="dijkstra-算法的实现">dijkstra 算法的实现</h3><p>（1）初始化，将距离标记置为 99999，前继节点为空，源主机的距离标记赋为 0 。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dijkstra</span>(<span class="params">self,src_dpid,dst_dpid,src_port,dst_port</span>): <span class="number">2.</span> c = <span class="number">29</span></span><br><span class="line">    adjacent = self.get_adjacent(self.links)</span><br><span class="line">    buckets = BucketSet(c+<span class="number">1</span>)</span><br><span class="line">    node_s = (<span class="number">0</span>,src_dpid)</span><br><span class="line">    d = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> u <span class="keyword">in</span> self.switches: </span><br><span class="line">        d[u] = <span class="number">99999</span></span><br><span class="line">    d[src_dpid] = <span class="number">0</span></span><br><span class="line">    pre = &#123;&#125;</span><br></pre></td></tr></table></figure><p>（2）用循环桶来维护未标记点的集合，其中循环桶是自定义的一个类，需在前面中引用：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> BucketSet <span class="keyword">import</span> BucketSet</span><br></pre></td></tr></table></figure><p>实现如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">buckets.add_thing(node_s)</span><br><span class="line">flag = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> buckets.SetEmpty() <span class="keyword">and</span> flag == <span class="number">1</span>: </span><br><span class="line">    min_list = buckets.pop_min() <span class="comment">#将桶中距离标记最小的点加入最短路径列表，实际上就是将已标记集合和未标记集合之间的最短割边加入最短路径树，此时还未永久标记，即 find_min 操作</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> <span class="built_in">len</span>(min_list) == <span class="number">0</span>: </span><br><span class="line">            min_node = min_list.pop() <span class="comment">#取出该点，与目的主机的进行比对，如果已经探测到目的主机，则跳出循环</span></span><br><span class="line">            <span class="keyword">if</span>(min_node[<span class="number">1</span>] == dst_dpid): </span><br><span class="line">                flag = <span class="number">0</span></span><br><span class="line">                <span class="keyword">break</span> </span><br><span class="line">            <span class="keyword">for</span> u <span class="keyword">in</span> self.switches: <span class="comment">#取该点的邻接点，进行距离标记的更新，如果该点的下一点的距离标记比该点的距离标记和两点之间权值之和大，则将该点设为下一点的前继节点，将该点的距离标记和两点之间权值之和设为新的距离标记，即 update 操作</span></span><br><span class="line">                <span class="keyword">if</span>(u <span class="keyword">in</span> adjacent[min_node[<span class="number">1</span>]]):</span><br><span class="line">                    <span class="keyword">for</span> link <span class="keyword">in</span> self.links: </span><br><span class="line">                        <span class="keyword">if</span> (link[<span class="string">&#x27;src_dpid&#x27;</span>] == min_node[<span class="number">1</span>]) <span class="keyword">and</span> (link[<span class="string">&#x27;dst_dpid&#x27;</span>]== u): <span class="comment">#如果要寻找的最短路之间仅有一条边，这条边的权重即为最短路的权重</span></span><br><span class="line">                            delay = link[<span class="string">&#x27;delay&#x27;</span>]</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">if</span>(d[min_node[<span class="number">1</span>]]+delay &lt; d[u]): <span class="comment">#update 操作，权值更新</span></span><br><span class="line">                        pre[u] = min_node[<span class="number">1</span>] <span class="comment">#前继节点更新</span></span><br><span class="line">                        d[u] = d[min_node[<span class="number">1</span>]] + delay <span class="comment">#距离标记更新</span></span><br><span class="line">                        buckets.add_thing((d[u],u)) <span class="comment">#将 u 点的邻接点加入桶中</span></span><br></pre></td></tr></table></figure><p>（3）重建最短路径</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">getpath = []</span><br><span class="line">s = dst_dpid</span><br><span class="line"><span class="keyword">while</span> s != src_dpid: <span class="comment">#从目的主机到源主机，将最短路径上的点加入 getpath 列表</span></span><br><span class="line">    getpath.append(s)</span><br><span class="line">    s = pre[s]</span><br><span class="line">    getpath.append(src_dpid)</span><br><span class="line">    getpath.reverse()<span class="comment">#由于上面的操作存储的最短路径是反向的，需要使用 reverse 函数将列表中的序列进行反向</span></span><br><span class="line"></span><br><span class="line">    self.minpath = getpath<span class="comment">#得到最终的最短路</span></span><br></pre></td></tr></table></figure><p>（4）提供 ryu 配置最短路所需的端口信息，使流表的下发能够一步到位</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ryu_path = []</span><br><span class="line">in_port = src_port<span class="comment">#从源主机到与它相连的交换机的端口号</span></span><br><span class="line"><span class="keyword">for</span> s1,s2 <span class="keyword">in</span> <span class="built_in">zip</span>(getpath[:-<span class="number">1</span>],getpath[<span class="number">1</span>:]):<span class="comment">#分别获得从源交换机到主机的路径上的各个出端口和各个入端口</span></span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> self.links: </span><br><span class="line">        <span class="keyword">if</span> (link[<span class="string">&#x27;src_dpid&#x27;</span>] == s1) <span class="keyword">and</span> (link[<span class="string">&#x27;dst_dpid&#x27;</span>] == s2):</span><br><span class="line">            out_port = link[<span class="string">&#x27;src_port_no&#x27;</span>]</span><br><span class="line">            ryu_path.append((s1,in_port,out_port))</span><br><span class="line">            in_port = link[<span class="string">&#x27;dst_port_no&#x27;</span>]</span><br><span class="line">            <span class="keyword">if</span> s2 == dst_dpid: </span><br><span class="line">                ryu_path.append((s2,in_port,dst_port))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"><span class="keyword">return</span> ryu_path</span><br></pre></td></tr></table></figure><p>（5）求最短路径上的时延</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sum_delay</span>(<span class="params">self,path,links</span>): </span><br><span class="line">    delay = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(path)-<span class="number">1</span>): </span><br><span class="line">        <span class="keyword">for</span> link <span class="keyword">in</span> links: </span><br><span class="line">            <span class="keyword">if</span> (link[<span class="string">&#x27;src_dpid&#x27;</span>] == path[j]) <span class="keyword">and</span> (link[<span class="string">&#x27;dst_dpid&#x27;</span>] == path[j+<span class="number">1</span>]): </span><br><span class="line">                delay += link[<span class="string">&#x27;delay&#x27;</span>]</span><br><span class="line">    <span class="keyword">return</span> delay</span><br></pre></td></tr></table></figure><p>（6）获取邻接点</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_adjacent</span>(<span class="params">self,links</span>): </span><br><span class="line">    adjacent = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> switch <span class="keyword">in</span> self.switches:</span><br><span class="line">        adjacent.setdefault(switch,[]) <span class="comment">#邻接点列表初始化 </span></span><br><span class="line">    <span class="keyword">for</span> switch <span class="keyword">in</span> self.switches: </span><br><span class="line">        <span class="keyword">for</span> link <span class="keyword">in</span> links:</span><br><span class="line">            <span class="keyword">if</span> link[<span class="string">&#x27;src_dpid&#x27;</span>] == switch:</span><br><span class="line">                adjacent[switch].append(link[<span class="string">&#x27;dst_dpid&#x27;</span>]) <span class="comment">#以交换机作为 key，以邻接交换机作为 value </span></span><br><span class="line">    <span class="keyword">return</span> adjacent</span><br></pre></td></tr></table></figure><h3 id="桶类的实现">桶类的实现</h3><p>（1）首先创建循环桶类，并对一些基础变量进行初始化</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BucketSet</span>(<span class="title class_ inherited__">object</span>): </span><br><span class="line">    header_loc = <span class="number">0</span> <span class="comment">#初始化桶头指针</span></span><br><span class="line">    things_number = <span class="number">0</span> <span class="comment">#初始化循环桶中节点的数目</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>（2）定义用于初始化的函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,buc_num</span>): </span><br><span class="line">    self.bucket_num = buc_num <span class="comment">#初始化小桶数目</span></span><br><span class="line">    self.buckets = [<span class="literal">None</span>]*buc_num <span class="comment">#初始化循环桶整体，它由指定数目的小桶组成</span></span><br><span class="line">    self.init_buckets(buc_num)</span><br><span class="line">    self.header = self.buckets[<span class="number">0</span>] <span class="comment">#初始化头桶</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init_buckets</span>(<span class="params">self,bucket_num</span>):<span class="comment"># 利用小桶类的初始化函树进行初始化</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bucket_num): </span><br><span class="line">        self.buckets[i] = BucketSet.Bucket(i)</span><br></pre></td></tr></table></figure><p>（3）定义用于使头桶指针后移的函数。因为每次对桶的元素取出都是针对头桶， 所以在头桶空后需要调用此函数实现对后续桶的搜索</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">move_header</span>(<span class="params">self</span>):<span class="comment"># 头桶指针后移一位</span></span><br><span class="line">    self.header_loc = ((self.header_loc + <span class="number">1</span> )% self.bucket_num)<span class="comment"># 因为是循环桶所以需要用取余操作保证尾部和头部的衔接</span></span><br><span class="line">    self.header = self.buckets[self.header_loc]</span><br></pre></td></tr></table></figure><p>（4）定义用于计算入桶的节点应该去哪个桶的函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Length_cal</span>(<span class="params">self,length</span>): </span><br><span class="line">    <span class="keyword">return</span> (length % self.bucket_num) <span class="comment">#因为是循环桶所以需要用取余保证所得数字的正确</span></span><br></pre></td></tr></table></figure><p>（5）定义用于处理节点加入桶的函数，作为和外部的关键接口</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_thing</span>(<span class="params">self,thing</span>): </span><br><span class="line">    length = thing[<span class="number">0</span>] <span class="comment">#输入此函数的节点数据中，第一项为它到 src 的距离</span></span><br><span class="line">    <span class="built_in">id</span> = self.Length_cal(length) <span class="comment">#计算该节点该去哪个桶</span></span><br><span class="line">    self.buckets[<span class="built_in">id</span>].add_thing(thing) <span class="comment">#把节点加入对应的桶</span></span><br><span class="line">    self.things_number += <span class="number">1</span> <span class="comment">#节点数加一</span></span><br></pre></td></tr></table></figure><p>（6）定义判断函数，用于判断整个循环桶是否全空，也就是确定整个 Dijkstra 算法何时结束</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">SetEmpty</span>(<span class="params">self</span>): </span><br><span class="line">    <span class="keyword">return</span> self.things_number == <span class="number">0</span></span><br></pre></td></tr></table></figure><p>（7）定义用于弹出桶中需要被永久标记的最短距离点的函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">pop_min</span>(<span class="params">self</span>): </span><br><span class="line">    <span class="keyword">while</span> self.header.is_empty(): <span class="comment">#寻找非空桶</span></span><br><span class="line">        self.move_header()</span><br><span class="line">        min_lists = self.header.pop_out() <span class="comment">#将头桶内节点弹出</span></span><br><span class="line">        self.things_number = self.things_number - <span class="built_in">len</span>(min_lists) <span class="comment">#节点数减少</span></span><br><span class="line">    <span class="keyword">return</span> </span><br></pre></td></tr></table></figure><p>（8）在循环桶类内部定义桶类，即用于组成循环桶的小桶。依旧从初始化函数开始定义</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Bucket</span>(<span class="title class_ inherited__">object</span>): </span><br><span class="line">    things_amount = <span class="number">0</span> <span class="comment">#计数，记录每个小桶内节点数目</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,bucketId</span>): <span class="comment">#初始化小桶，利用 list()，每个桶有对应的编号，从 0 到 C</span></span><br><span class="line">        self.bucket = <span class="built_in">list</span>()</span><br><span class="line">        self.<span class="built_in">id</span> = bucketId</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>（9）定义往小桶内加入节点的函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_thing</span>(<span class="params">self,thing</span>): </span><br><span class="line">    self.bucket.append(thing) <span class="comment">#加入节点，利用 list()性质</span></span><br><span class="line">    self.things_amount += <span class="number">1</span> <span class="comment">#计数加</span></span><br></pre></td></tr></table></figure><p>（10）定义弹出小桶内节点数据的函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">pop_out</span>(<span class="params">self</span>):</span><br><span class="line">    things = self.bucket.copy() <span class="comment">#things 记录了桶内现有节点</span></span><br><span class="line">    self.bucket.clear() <span class="comment">#清空桶</span></span><br><span class="line">    self.things_amount = <span class="number">0</span> <span class="comment">#计数清 0</span></span><br><span class="line">    <span class="keyword">return</span> thing</span><br></pre></td></tr></table></figure><p>（11）定义判断小桶是否为空的函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">is_empty</span>(<span class="params">self</span>): </span><br><span class="line">    <span class="keyword">return</span> self.things_amount == <span class="number">0</span></span><br></pre></td></tr></table></figure><h3 id="RYU通信-2">RYU通信</h3><p>（1）初始化</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Kruskaltest</span>(app_manager.RyuApp): </span><br><span class="line">    OFP_VERSIONS=[ofproto_v1_3.OFP_VERSION]<span class="comment">#确定控制器的 openflow 版本</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,*args,**kwargs</span>): </span><br><span class="line">        <span class="built_in">super</span>(Kruskaltest,self).__init__(*args,**kwargs)<span class="comment">#继承自己，方便后面的初始化步骤</span></span><br><span class="line">        self.mac_to_port=&#123;&#125;<span class="comment">#arp 列表初始化</span></span><br><span class="line">        self.topology_api_app=self</span><br><span class="line">        self.sleep_interval = <span class="number">0.5</span><span class="comment">#程序暂停的时间为 0.5 秒，以使 mininet 和 ryu 的拓扑建立保持同步，防止链路丢失</span></span><br><span class="line">        self.switches = []<span class="comment">#交换机列表初始化</span></span><br><span class="line">        self.links = []<span class="comment">#链路信息初始化</span></span><br><span class="line">        self.mst_links = []<span class="comment">#最小生成树上的链路初始化</span></span><br><span class="line">        self.pathes = &#123;&#125;<span class="comment">#路径初始化</span></span><br><span class="line">        self.banport = &#123;&#125;<span class="comment">#被禁止的端口初始化</span></span><br></pre></td></tr></table></figure><p>（2）流表配置</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@set_ev_cls(<span class="params">ofp_event.EventOFPSwitchFeatures,CONFIG_DISPATCHER</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">switch_features_handler</span>(<span class="params">self,ev</span>): </span><br><span class="line">        datapath=ev.msg.datapath</span><br><span class="line">        ofproto=datapath.ofproto</span><br><span class="line">        ofp_parser=datapath.ofproto_parser</span><br><span class="line">        <span class="keyword">match</span>=ofp_parser.OFPMatch()</span><br><span class="line">        actions=[ofp_parser.OFPActionOutput(ofproto.OFPP_CONTROLLER,ofproto.OFPCML_NO_BUF</span><br><span class="line">FER)]</span><br><span class="line">        self.add_flow(datapath,<span class="number">0</span>,<span class="keyword">match</span>,actions)<span class="comment">#配置缺省流表，match 域为空，对每一个交换机都添加该流表，当交换机无法处理收到的数据包时，执行 actions，把数据包向控制器转发</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_flow</span>(<span class="params">self,datapath,priority,<span class="keyword">match</span>,actions</span>):<span class="comment">#控制器向交换机发流表的方法</span></span><br><span class="line">        ofproto=datapath.ofproto </span><br><span class="line">        ofp_parser=datapath.ofproto_parser</span><br><span class="line">        inst=[ofp_parser.OFPInstructionActions(ofproto.OFPIT_APPLY_ACTIONS,actions)]<span class="comment">#收到后立即执行 actions</span></span><br><span class="line">        <span class="comment">#以上内容为流表信息的获取</span></span><br><span class="line">        mod=ofp_parser.OFPFlowMod(datapath=datapath,priority=priority,<span class="keyword">match</span>=<span class="keyword">match</span>,instructions=inst)<span class="comment">#流表内容定义，第一个为流表从哪一个交换机发送过来，第二个为权重，第三个为匹配域，当收到的数据包和匹配域匹配上时执行 instructions         </span></span><br><span class="line">        datapath.send_msg(mod)<span class="comment">#发送流表</span></span><br></pre></td></tr></table></figure><p>（3）拓扑发现</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@set_ev_cls(<span class="params">event.EventSwitchEnter,[CONFIG_DISPATCHER,MAIN_DISPATCHER]</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">switch_enter_handler</span>(<span class="params">self,ev</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;==================================&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;switch entered...&#x27;</span>)</span><br><span class="line">        self.switches,self.links = self.get_topology() <span class="comment">#通过后面的 get_topology 方法来获取交换机和链路信息</span></span><br><span class="line">        self.banport = self.find_banport(self.links[:]) <span class="comment">#找到被禁止的端口，因为洪泛时不能有圈，否则会陷入死循环</span></span><br><span class="line">        <span class="keyword">for</span> link <span class="keyword">in</span> self.mst_links:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;&#123;&#125; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(link[<span class="string">&#x27;src_dpid&#x27;</span>],link[<span class="string">&#x27;dst_dpid&#x27;</span>]))<span class="comment">#打印最小生成树</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;==================================&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        time.sleep(self.sleep_interval) <span class="comment">#ryu 每发现一个交换机之后都要暂停一段时间，让mininetd 建立拓扑的速度能跟上，否则会造成链路丢失</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_topology</span>(<span class="params">self</span>): </span><br><span class="line">        switch_list = get_switch(self.topology_api_app,<span class="literal">None</span>)</span><br><span class="line">        switches = [switch.dp.<span class="built_in">id</span> <span class="keyword">for</span> switch <span class="keyword">in</span> switch_list]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;switches:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(switches)) <span class="comment">#得到并打印交换机列表</span></span><br><span class="line">        <span class="keyword">for</span> switch <span class="keyword">in</span> switches: </span><br><span class="line">            self.banport.setdefault(switch,[]) <span class="comment">#初始化被禁止的端口列表</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;------------------------------------&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;banport first_list is&#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.banport))</span><br><span class="line">        link_list = get_link(self.topology_api_app,<span class="literal">None</span>)</span><br><span class="line">        links = [&#123;<span class="string">&#x27;src_dpid&#x27;</span>:link.src.dpid,<span class="string">&#x27;src_port_no&#x27;</span>:link.src.port_no, <span class="number">12.</span> <span class="string">&#x27;dst_dpid&#x27;</span>:link.dst.dpid,<span class="string">&#x27;dst_port_no&#x27;</span>:link.dst.port_no&#125;</span><br><span class="line">                 <span class="keyword">for</span> link <span class="keyword">in</span> link_list]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;the getted link_list is&#123;&#125;&quot;</span>.<span class="built_in">format</span>(links)) <span class="comment">#得到并打印链路信息，其中包含了源交换机的 dpid 和对应的端口号以及目的交换机的 dpid 和对应的端口号</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#file = open(&quot;./topo24.json&quot;,&quot;r&quot;)</span></span><br><span class="line">        file = <span class="built_in">open</span>(<span class="string">&quot;./topo7.json&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="comment">#由于原来的 24 个交换机拓扑太大，故用 7 个交换机来作为测试，读取 topo7.json 里的信息</span></span><br><span class="line">        topoinfo = json.load(file)</span><br><span class="line">        <span class="keyword">for</span> link <span class="keyword">in</span> links:</span><br><span class="line">             <span class="keyword">for</span> edge <span class="keyword">in</span> topoinfo[<span class="string">&#x27;links&#x27;</span>]: </span><br><span class="line">                    <span class="keyword">if</span>([<span class="string">&quot;s&quot;</span>+<span class="built_in">str</span>(link[<span class="string">&quot;src_dpid&quot;</span>]),<span class="string">&quot;s&quot;</span>+<span class="built_in">str</span>(link[<span class="string">&quot;dst_dpid&quot;</span>])] == edge[<span class="string">&quot;vertexs&quot;</span>] <span class="keyword">or</span> [<span class="string">&quot;s&quot;</span>+<span class="built_in">str</span>(link[<span class="string">&quot;dst_dpid&quot;</span>]),<span class="string">&quot;s&quot;</span>+<span class="built_in">str</span>(link[<span class="string">&quot;src_dpid&quot;</span>])] == edge[<span class="string">&quot;vertexs&quot;</span>]):</span><br><span class="line">                        link[<span class="string">&#x27;delay&#x27;</span>] = edge[<span class="string">&#x27;delay&#x27;</span>]</span><br><span class="line">                        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>（4）ryu 配置最短路</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">configure_path</span>(<span class="params">self,path,src,dst,datapath</span>): </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;configure the shortest path&quot;</span>)</span><br><span class="line">    path_print=src</span><br><span class="line">    <span class="keyword">for</span> switch,in_port,out_port <span class="keyword">in</span> path: <span class="comment">#下发流表</span></span><br><span class="line">        ofp_parser=datapath.ofproto_parser </span><br><span class="line">        <span class="keyword">match</span>=ofp_parser.OFPMatch(in_port=in_port,eth_src=src,eth_dst=dst)</span><br><span class="line">        actions=[ofp_parser.OFPActionOutput(out_port)]</span><br><span class="line">        self.add_flow(datapath,<span class="number">1</span>,<span class="keyword">match</span>,actions)</span><br><span class="line">        path_print+=<span class="string">&quot;--&gt;&#123;&#125;-[&#123;&#125;]-&#123;&#125;&quot;</span>.<span class="built_in">format</span>(in_port,switch,out_port) <span class="comment">#更新打印的最短路序列</span></span><br><span class="line">    delay = self.sum_delay(self.minpath,self.links)</span><br><span class="line">    path_print+=<span class="string">&quot;--&gt;&quot;</span>+dst</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;the shortest path is:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(path_print),<span class="string">&#x27;delay:&#x27;</span>,delay)</span><br></pre></td></tr></table></figure><p>（5）对 packetin 的修改</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path=self.dijkstra(src_switch,dst_switch,first_port,final_port) <span class="comment">#调用dijkstra，获取配置的路径信息</span></span><br><span class="line">self.configure_path(path,src,dst,datapath) <span class="comment">#配置最短路</span></span><br></pre></td></tr></table></figure><h1 id="成果展示-4">成果展示</h1><h2 id="拓扑的构建-2">拓扑的构建</h2><p>（1）mininet 侧</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223609396.png" alt="拓扑构建"></p><p>（2）RYU 侧</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223630662.png" alt="RYU侧拓扑发现"></p><p>（3）二十四节点网络拓扑可视化</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223649765.png" alt="拓扑示意图"></p><h2 id="Dijkstra-算法实现">Dijkstra 算法实现</h2><p>（1）mininet 侧：连通性良好</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223900092.png" alt="pingall情况"></p><p>（2）时延现象（以 h1 ping h19 为例）</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223803112.png" alt="mininet 侧时延信息"></p><p>（3）ryu 侧</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223933169.png" alt="RYU 侧最短路输出"></p><p>（4）最短路可视化 （黄色路径为最短路，黑色路径为未经过路径）</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223948401.png" alt="最短路可视化"></p>]]></content>
      
      
      <categories>
          
          <category> 网络算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SDN </tag>
            
            <tag> Ubuntu </tag>
            
            <tag> 项目开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用SDN网络架构的DFS算法实践项目</title>
      <link href="/e9c4a133/"/>
      <url>/e9c4a133/</url>
      
        <content type="html"><![CDATA[<h1 id="项目要求-2">项目要求</h1><ol><li>在 Mininet 上搭建一个 7 个节点网络（拓扑给定），每个网络节点下挂一 个主机；</li><li>使用 Ryu 连接 Mininet 中的交换机；</li><li>并将拓扑读出来进行可视化展示；</li><li>在 Ryu 上实现深度优先遍历算法，并找出任意两个主机间的最短路和最长路；</li><li>使用最长路来配置任意两个主机间的通信连接；</li><li>将配置通的业务在可视化平台上进行展示 。</li></ol><h1 id="DFS算法原理">DFS算法原理</h1><h2 id="基本思想-2">基本思想</h2><p>深度优先搜索 DFS（Depth First Search）是从初始结点开始扩展，扩展顺 序总是先扩展最新产生的结点。这就使得搜索沿着状态空间某条单一的路径进行 下去，直到最后的结点不能产生新结点或者找到目标结点为止。当搜索到不能产 生新的结点的时候，就沿着结点产生顺序的反方向寻找可以产生新结点的结点， 并扩展它，形成另一条搜索路径。</p><h2 id="基本步骤-2">基本步骤</h2><ol><li>从初始结点开始，将待扩展结点依次放到栈中。</li><li>如果栈空，即所有待扩展结点已全部扩展完毕，则问题无解，退出。</li><li>取栈中最新加入的结点，即栈顶结点出栈，并用相应的扩展原则扩展出所有的子结点，并按顺序将这些结点放入栈中。若没有子结点产生，则转（2）。</li><li>如果某个子结点为目标结点，则找到问题的解（这不一定是最优解）， 结束。如果要求得问题的最优解，或者所有解，则转（2），继续搜索新的目标结点。</li></ol><h2 id="示例-2">示例</h2><p>下图是一个无向图，如果我们从 A 点发起深度优先搜索（以下的访问次序并 不是唯一的，第二个点既可以是 B 也可以是 C,D），则我们可能得到如下的一个 访问过程：A-&gt;B-&gt;E（没有路了！回溯到 A)-&gt;C-&gt;F-&gt;H-&gt;G-&gt;D（没有路，最终 回溯到 A,A 也没有未访问的相邻节点，本次搜索结束）</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225430116.png" alt="示例拓扑图"></p><h2 id="DFS-与-BFS-比较">DFS 与 BFS 比较</h2><ul><li><strong>遍历方式</strong>不同：DFS 的方式则是从一条路一直走到底后再回退，再走到底 而 BFS 遍历方式是围绕着根结点一圈一圈（level by level）向外遍历。</li><li><strong>数据结构</strong>不同：DFS 常借助栈的方式来实现，而 BFS 常借助队列的方式实 基于深度优先遍历算法框架的主机最长路连接配置项目实验报告 第 3 页 现。</li><li><strong>具体应用</strong>不同：DFS 比较适合判断图中是否有环，寻找两个节点之间的路径，有向无环图（DAG）的拓扑排序，寻找所有强连通片（SCC），无向图中寻找 割点和桥等； BFS 则比较适合判断二分图，以及用于实现寻找最小生成树（MST），如在 BFS 基础上的 Kruskal 算法以及寻找最短路径问题（如 Dijkstra算法）</li></ul><h1 id="代码分析">代码分析</h1><h2 id="DFS-算法实现">DFS 算法实现</h2><h3 id="可行实现方式">可行实现方式</h3><ul><li>自己建立堆栈以代替系统栈，从而进行 DFS</li><li>利用系统栈以及循环实现递归，从而进行 DFS</li></ul><h3 id="实现方式比较">实现方式比较</h3><p>DFS 是一个递归算法，就算额外建立堆栈，本质上处理数据的规则和利用的 空间大小是依旧不变的。它的空间复杂度无论选择哪种方式，都是 O ( N ) （N 为节点数）。而 DFS 计算路径几乎是遍历全图输出路径，因此其耗费的时间受存 储拓扑信息的结构决定。 因此 DFS 选择两种实现方式在效率上没有差异。但就代码长度来说，第二种实现方式更为简洁明了并且简短。因此在实现的过程中本文选择第二种方法。</p><h3 id="变量说明">变量说明</h3><table><thead><tr><th style="text-align:center">符号</th><th style="text-align:center">含义</th></tr></thead><tbody><tr><td style="text-align:center">u</td><td style="text-align:center">当前检索的交换机</td></tr><tr><td style="text-align:center">i</td><td style="text-align:center">与 u 有相连边的邻接交换机</td></tr><tr><td style="text-align:center">dst</td><td style="text-align:center">目标终点主机对应的交换机</td></tr><tr><td style="text-align:center">visited</td><td style="text-align:center">用于标记交换机的变量</td></tr><tr><td style="text-align:center">cur_path</td><td style="text-align:center">i 和 u 之间的路径，一个边</td></tr><tr><td style="text-align:center">allpaths</td><td style="text-align:center">所有可行路径的集合</td></tr></tbody></table><h3 id="DFS实现">DFS实现</h3><p>（一）获得邻居节点</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获得邻居节点</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_adjacent</span>(<span class="params">self,links</span>):</span><br><span class="line">    adjacent = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> switch <span class="keyword">in</span> self.switches: </span><br><span class="line">        adjacent.setdefault(switch,[]) <span class="comment">#初始化字典</span></span><br><span class="line">        <span class="keyword">for</span> switch <span class="keyword">in</span> self.switches: </span><br><span class="line">            <span class="keyword">for</span> link <span class="keyword">in</span> links: </span><br><span class="line">                <span class="keyword">if</span> link[<span class="string">&#x27;src_dpid&#x27;</span>] == switch:</span><br><span class="line">                    adjacent[switch].append(link[<span class="string">&#x27;dst_dpid&#x27;</span>]) <span class="comment">#作为源交换机时添加目的交换机</span></span><br></pre></td></tr></table></figure><p>（二）使用 DFS 寻找源宿全部路径</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">DFS</span>(<span class="params">self,u,dst,visited,cur_path,allpaths</span>): <span class="comment">#根据传过来的源主机和目的主机来探索最短路，采用递归方法</span></span><br><span class="line">    adjacent = self.get_adjacent(self.links)</span><br><span class="line">    <span class="keyword">if</span> u ==dst: </span><br><span class="line">        allpaths.append(cur_path.copy())</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> adjacent[u]: </span><br><span class="line">            <span class="keyword">if</span> visited[i] == <span class="number">0</span>: </span><br><span class="line">                visited[i] = <span class="number">1</span></span><br><span class="line">                cur_path.append(i)</span><br><span class="line">                self.DFS(i,dst,visited,cur_path,allpaths)</span><br><span class="line">                cur_path.pop()</span><br><span class="line">                visited[i] = <span class="number">0</span></span><br></pre></td></tr></table></figure><p>（三）计算路径上的时延</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sum_delay</span>(<span class="params">self,all_path,links</span>): </span><br><span class="line">    sum_delay = [<span class="number">0</span>]*<span class="built_in">len</span>(all_path) <span class="comment">#时延列表初始化</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(all_path)): <span class="comment">#分别计算每一条路径上的时延并储存在 sum_delay 列表中，作为返回值返回</span></span><br><span class="line">        path = all_path[i]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(path)-<span class="number">1</span>): </span><br><span class="line">            <span class="keyword">for</span> link <span class="keyword">in</span> links: </span><br><span class="line">                <span class="keyword">if</span> (link[<span class="string">&#x27;src_dpid&#x27;</span>] == path[j]) <span class="keyword">and</span> (link[<span class="string">&#x27;dst_dpid&#x27;</span>] == path[j+<span class="number">1</span>]): </span><br><span class="line">                    sum_delay[i] += <span class="built_in">int</span>(link[<span class="string">&#x27;delay&#x27;</span>])</span><br><span class="line">    <span class="keyword">return</span> sum_dela</span><br></pre></td></tr></table></figure><p>（四）给全部路径加上时延属性，并找出最短和最长路</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">search_path</span>(<span class="params">self,src,dst,src_port,dst_port</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Calculating all the path of &#123;&#125;:&#123;&#125; -&gt; &#123;&#125;:&#123;&#125;...&#x27;</span>.<span class="built_in">format</span>(src,src_port,dst,dst_port))</span><br><span class="line">    visited = &#123;&#125; <span class="comment">#标记，判断是否已经被加入路径</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> self.switches: </span><br><span class="line">        visited[s] = <span class="number">0</span></span><br><span class="line">    visited[src] = <span class="number">1</span> <span class="comment">#将源主机标记为已被探索</span></span><br><span class="line">        </span><br><span class="line">    cur_path = []</span><br><span class="line">    cur_path.append(src) <span class="comment">#将源主机加入路径</span></span><br><span class="line">    all_paths = []</span><br><span class="line">        </span><br><span class="line">    self.DFS(src,dst,visited,cur_path,all_paths) <span class="comment">#调用 DFS，发现从 src 到 dst 的全部路径并存储在 all_paths 中         </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;find &#123;&#125; paths&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(all_paths))) <span class="comment">#路径的数量</span></span><br><span class="line">        </span><br><span class="line">    sum_delay = self.sum_delay(all_paths,self.links) <span class="comment">#计算出所有路径的时延，交换机和主机之间的时延存储在 links 列表中</span></span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> path <span class="keyword">in</span> all_paths: </span><br><span class="line">        <span class="built_in">print</span>(path,sum_delay[k]) <span class="comment">#打印各条路径的时延信息</span></span><br><span class="line">        k = k+<span class="number">1</span></span><br><span class="line">        <span class="comment">#计算时延最长路和时延最短路</span></span><br><span class="line">    <span class="built_in">max</span> = <span class="number">0</span></span><br><span class="line">    <span class="built_in">min</span> = <span class="number">100000</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(sum_delay)): </span><br><span class="line">        <span class="keyword">if</span> sum_delay[i] &gt; <span class="built_in">max</span>: </span><br><span class="line">            max_i = i</span><br><span class="line">            <span class="built_in">max</span> = sum_delay[i]</span><br><span class="line">        <span class="keyword">if</span> sum_delay[i] &lt; <span class="built_in">min</span>: </span><br><span class="line">            min_i = i</span><br><span class="line">            <span class="built_in">min</span> = sum_delay[i]</span><br><span class="line">    <span class="comment">#打印时延最短路和时延最长路</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;the shortest path :&#x27;</span>,all_paths[min_i],<span class="string">&#x27;delay:&#x27;</span>,sum_delay[min_i])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;the longest path :&#x27;</span>,all_paths[max_i],<span class="string">&#x27;delay:&#x27;</span>,sum_delay[max_i])</span><br><span class="line">    <span class="comment">#要求配置的是时延最长路，因此用下列代码将最长路的主机、交换机和端口信息存入 ryu_path，返回给调用函数</span></span><br><span class="line">    path = all_paths[max_i]</span><br><span class="line">    ryu_path = []</span><br><span class="line">    in_port = src_port</span><br><span class="line">    <span class="keyword">for</span> s1,s2 <span class="keyword">in</span> <span class="built_in">zip</span>(path[:-<span class="number">1</span>],path[<span class="number">1</span>:]):</span><br><span class="line">        <span class="keyword">for</span> link <span class="keyword">in</span> self.links:</span><br><span class="line">    <span class="comment">#从原图的 links 列表中得到对应交换机的端口信息，从目的主机到源主机读取出端口，从源主机到目的主机读取入端口，其中 s1 是从目的主机一侧开始往源主机一侧推进，s2 是从源主机一侧开始往目的主机一侧推进。</span></span><br><span class="line">            <span class="keyword">if</span> link[<span class="string">&#x27;src_dpid&#x27;</span>] == s1 <span class="keyword">and</span> link[<span class="string">&#x27;dst_dpid&#x27;</span>] == s2: </span><br><span class="line">                out_port = link[<span class="string">&#x27;dst_port_no&#x27;</span>]</span><br><span class="line">                ryu_path.append((s1,in_port,out_port))</span><br><span class="line">        <span class="keyword">for</span> link <span class="keyword">in</span> self.links: </span><br><span class="line">            <span class="keyword">if</span> link[<span class="string">&#x27;src_dpid&#x27;</span>] == s2 <span class="keyword">and</span> link[<span class="string">&#x27;dst_dpid&#x27;</span>] == s1: </span><br><span class="line">                in_port = link[<span class="string">&#x27;src_port_no&#x27;</span>]</span><br><span class="line">                ryu_path.append((dst,in_port,dst_port))</span><br><span class="line">    <span class="keyword">return</span> ryu_path <span class="comment">#返回最长路上的主机和所有交换机以及对应的端口信息，以便配置的时候调用</span></span><br></pre></td></tr></table></figure><h3 id="RYU通信实现">RYU通信实现</h3><p>（一）初始化</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Kruskaltest</span>(app_manager.RyuApp): </span><br><span class="line">    OFP_VERSIONS=[ofproto_v1_3.OFP_VERSION] <span class="comment">#确定控制器的 openflow 版本</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,*args,**kwargs</span>): <span class="number">7.</span> <span class="built_in">super</span>(Kruskaltest,self).__init__(*args,**kwargs)<span class="comment">#继承自己，方便后面的初始化步骤</span></span><br><span class="line">    self.mac_to_port=&#123;&#125; <span class="comment">#arp 列表初始化</span></span><br><span class="line">    self.topology_api_app=self</span><br><span class="line">    self.sleep_interval = <span class="number">0.5</span> <span class="comment">#程序暂停的时间为 0.5 秒，以使 mininet 和 ryu 的拓扑建立保持同步，防止链路丢失</span></span><br><span class="line">    self.switches = [] <span class="comment">#交换机列表初始化</span></span><br><span class="line">    self.links = [] <span class="comment">#链路信息初始化</span></span><br><span class="line">    self.mst_links = [] <span class="comment">#最小生成树上的链路初始化</span></span><br><span class="line">    self.pathes = &#123;&#125; <span class="comment">#路径初始化</span></span><br><span class="line">    self.banport = &#123;&#125; <span class="comment">#被禁止的端口初始化</span></span><br></pre></td></tr></table></figure><p>（二）流表配置</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@set_ev_cls(<span class="params">ofp_event.EventOFPSwitchFeatures,CONFIG_DISPATCHER</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">switch_features_handler</span>(<span class="params">self,ev</span>):</span><br><span class="line">        datapath=ev.msg.datapath</span><br><span class="line">        ofproto=datapath.ofproto </span><br><span class="line">        ofp_parser=datapath.ofproto_parser </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">match</span>=ofp_parser.OFPMatch()</span><br><span class="line">        actions=[ofp_parser.OFPActionOutput(ofproto.OFPP_CONTROLLER,ofproto.OFPCML_NO_BUFFER)]</span><br><span class="line">        self.add_flow(datapath,<span class="number">0</span>,<span class="keyword">match</span>,actions)<span class="comment">#配置缺省流表，match 域为空，对每一个交换机都添加该流表，当交换机无法处理收到的数据包时，执行 actions，把数据包向控制器转发</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_flow</span>(<span class="params">self,datapath,priority,<span class="keyword">match</span>,actions</span>):<span class="comment">#控制器向交换机发流表的方法</span></span><br><span class="line">        ofproto=datapath.ofproto </span><br><span class="line">        ofp_parser=datapath.ofproto_parser </span><br><span class="line">        inst=[ofp_parser.OFPInstructionActions(ofproto.OFPIT_APPLY_ACTIONS,actions)]<span class="comment">#收到后立即执行 actions</span></span><br><span class="line"><span class="comment">#以上内容为流表信息的获取</span></span><br><span class="line">        mod=ofp_parser.OFPFlowMod(datapath=datapath,priority=priority,<span class="keyword">match</span>=<span class="keyword">match</span>,instructions=inst)<span class="comment">#流表内容定义，第一个为流表从哪一个交换机发送过来，第二个为权重，第三个为匹配域，当收到的数据包和匹配域匹配上时执行 instructions </span></span><br><span class="line">    datapath.send_msg(mod)<span class="comment">#发送流表</span></span><br></pre></td></tr></table></figure><p>（三）拓扑发现</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@set_ev_cls(<span class="params">event.EventSwitchEnter,[CONFIG_DISPATCHER,MAIN_DISPATCHER]</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">switch_enter_handler</span>(<span class="params">self,ev</span>): </span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;==================================&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;switch entered...&#x27;</span>)</span><br><span class="line">        self.switches,self.links = self.get_topology() <span class="comment">#通过后面的 get_topology 方法来获取交换机和链路信息</span></span><br><span class="line">        self.banport = self.find_banport(self.links[:]) <span class="comment">#找到被禁止的端口，因为洪泛时不能有圈，否则会陷入死循环</span></span><br><span class="line">        <span class="keyword">for</span> link <span class="keyword">in</span> self.mst_links: </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;&#123;&#125; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(link[<span class="string">&#x27;src_dpid&#x27;</span>],link[<span class="string">&#x27;dst_dpid&#x27;</span>])) <span class="comment">#打印最小生成树</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;==================================&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        time.sleep(self.sleep_interval) <span class="comment">#ryu 每发现一个交换机之后都要暂停一段时间，让mininetd 建立拓扑的速度能跟上，否则会造成链路丢失</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_topology</span>(<span class="params">self</span>): </span><br><span class="line">    switch_list = get_switch(self.topology_api_app,<span class="literal">None</span>)</span><br><span class="line">    switches = [switch.dp.<span class="built_in">id</span> <span class="keyword">for</span> switch <span class="keyword">in</span> switch_list]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;switches:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(switches)) <span class="comment">#得到并打印交换机列表</span></span><br><span class="line">    <span class="keyword">for</span> switch <span class="keyword">in</span> switches: </span><br><span class="line">        self.banport.setdefault(switch,[]) <span class="comment">#初始化被禁止的端口列表</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;------------------------------------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;banport first_list is&#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.banport))</span><br><span class="line">    link_list = get_link(self.topology_api_app,<span class="literal">None</span>)</span><br><span class="line">    links = [&#123;<span class="string">&#x27;src_dpid&#x27;</span>:link.src.dpid,<span class="string">&#x27;src_port_no&#x27;</span>:link.src.port_no,<span class="string">&#x27;dst_dpid&#x27;</span>:link.dst.dpid,<span class="string">&#x27;dst_port_no&#x27;</span>:link.dst.port_no&#125;<span class="keyword">for</span> link <span class="keyword">in</span> link_list]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;the getted link_list is&#123;&#125;&quot;</span>.<span class="built_in">format</span>(links)) <span class="comment">#得到并打印链路信息，其中包含了源交换机的 dpid 和对应的端口号以及目的交换机的 dpid 和对应的端口号</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#file = open(&quot;./topo24.json&quot;,&quot;r&quot;)</span></span><br><span class="line">    file = <span class="built_in">open</span>(<span class="string">&quot;./topo7.json&quot;</span>,<span class="string">&quot;r&quot;</span>)<span class="comment">#由于原来的 24 个交换机拓扑太大，故用 7 个交换机来作为测试，读取 topo7.json 里的信息</span></span><br><span class="line">    topoinfo = json.load(file)</span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> links: </span><br><span class="line">        <span class="keyword">for</span> edge <span class="keyword">in</span> topoinfo[<span class="string">&#x27;links&#x27;</span>]:</span><br><span class="line">            <span class="keyword">if</span>([<span class="string">&quot;s&quot;</span>+<span class="built_in">str</span>(link[<span class="string">&quot;src_dpid&quot;</span>]),<span class="string">&quot;s&quot;</span>+<span class="built_in">str</span>(link[<span class="string">&quot;dst_dpid&quot;</span>])] == edge[<span class="string">&quot;vertexs&quot;</span>] <span class="keyword">or</span> [<span class="string">&quot;s&quot;</span>+<span class="built_in">str</span>(link[<span class="string">&quot;dst_dpid&quot;</span>]),<span class="string">&quot;s&quot;</span>+<span class="built_in">str</span>(link[<span class="string">&quot;src_dpid&quot;</span>])] == edge[<span class="string">&quot;vertexs&quot;</span>]):</span><br><span class="line">                link[<span class="string">&#x27;delay&#x27;</span>] = edge[<span class="string">&#x27;delay&#x27;</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>（四）DFS最长路配置</p><blockquote><p>配置思路 : 将需要配置的路径存储在 path 中，其中有源主机和目的主机的 mac 地址、 路径上的交换机号和对应的端口，将对应流表下发。</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">configure_path</span>(<span class="params">self,path,src,dst,datapath</span>): <span class="comment">#路径配置函数</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;configure the longgest path&quot;</span>)</span><br><span class="line">    path_print=src <span class="comment">#将源主机的 mac 地址加入到打印序列中</span></span><br><span class="line">    <span class="keyword">for</span> switch,in_port,out_port <span class="keyword">in</span> path: <span class="comment">#向对应的交换机下发流表指导通信</span></span><br><span class="line">        ofp_parser=datapath.ofproto_parser</span><br><span class="line">        <span class="keyword">match</span>=ofp_parser.OFPMatch(in_port=in_port,eth_src=src,eth_dst=dst)</span><br><span class="line">        actions=[ofp_parser.OFPActionOutput(out_port)]</span><br><span class="line">        self.add_flow(datapath,<span class="number">1</span>,<span class="keyword">match</span>,actions)</span><br><span class="line">        path_print+=<span class="string">&quot;--&gt;&#123;&#125;-&#123;&#125;-&#123;&#125;&quot;</span>.<span class="built_in">format</span>(in_port,switch,out_port)<span class="comment">#将路径上的进入端</span></span><br><span class="line">口、交换机和输出端口加入打印序列</span><br><span class="line">    path_print+=<span class="string">&quot;--&quot;</span>+dst<span class="comment">#将目的主机的 mac 地址加入打印序列</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;the longgest path is:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(path_print))<span class="comment">#打印最长路</span></span><br></pre></td></tr></table></figure><p>（五）控制器对数据包的处理</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@set_ev_cls(<span class="params">ofp_event.EventOFPPacketIn,MAIN_DISPATCHER</span>)</span><span class="comment">#监视器，当有 packetin 消息进来时，执行下面的代码</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">packet_in_handler</span>(<span class="params">self,ev</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;==========================================================&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;it has entered packet_in_handler func&#x27;</span>)</span><br><span class="line">        msg=ev.msg</span><br><span class="line">        datapath=msg.datapaths </span><br><span class="line">        ofproto=datapath.ofproto </span><br><span class="line">        ofp_parser=datapath.ofproto_parser </span><br><span class="line">        dpid=datapath.<span class="built_in">id</span> <span class="comment">#id from switch</span></span><br><span class="line">        <span class="comment">#以上是对收到的数据包进行解析</span></span><br><span class="line">        self.mac_to_port.setdefault(dpid,&#123;&#125;)</span><br><span class="line">        <span class="comment"># 对控制器里面的 mac_to_port 列表初始化</span></span><br><span class="line">        pkt=packet.Packet(msg.data)<span class="comment">#读取需要传输的数据</span></span><br><span class="line">        eth=pkt.get_protocol(ethernet.ethernet)<span class="comment">#读取以太网地址的数据包，里面包含了 src 和dst 以及 ethertype 等信息</span></span><br><span class="line">        in_port=msg.<span class="keyword">match</span>[<span class="string">&#x27;in_port&#x27;</span>] <span class="comment">#读取匹配域中的进入交换机的端口号</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;in_port is &quot;</span>,in_port)</span><br><span class="line">        src = eth.src <span class="number">21.</span> self.mac_to_port[dpid][src]=in_port<span class="comment">#将源交换机的 MAC 地址和源交换机进入该交换机的端口号对应起来</span></span><br><span class="line">        dst=eth.dst <span class="comment">#目的主机的 MAC 地址</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;the src is &#x27;</span>, src)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;the dst is &#x27;</span>, dst)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;the dpid is &#x27;</span>, dpid)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;self.mac_to_port:&quot;</span>, self.mac_to_port)</span><br><span class="line">        pathes=&#123;&#125;<span class="comment">#路径初始化</span></span><br><span class="line">        <span class="keyword">if</span> dst <span class="keyword">in</span> self.mac_to_port[dpid]: <span class="comment">#如果目的主机的 MAC 地址已经在控制器的 mac_to_port列表里面有记录，直接下发流表</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;dst mac is known&#x27;</span>)</span><br><span class="line">            out_port=self.mac_to_port[dpid][dst]</span><br><span class="line">            actions=[ofp_parser.OFPActionOutput(out_port)]</span><br><span class="line">            <span class="keyword">match</span>=ofp_parser.OFPMatch(in_port=in_port,eth_dst=dst,eth_src=src)</span><br><span class="line">            <span class="comment">#以上为对流表内容的定义</span></span><br><span class="line">            self.add_flow(datapath,<span class="number">1</span>,<span class="keyword">match</span>,actions)<span class="comment">#权值为 1，表示优先级先于缺省流表</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;add flow&quot;</span>)</span><br><span class="line">            self.pathes.setdefault(src,&#123;&#125;)</span><br><span class="line">            self.pathes[src].setdefault(dst,[]) <span class="comment">#对从这个主机开始的路径做初始化</span></span><br><span class="line">            self.pathes[src][dst].append(dpid)<span class="comment">#往路径上添加交换机</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;path appending:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.pathes[src][dst]))<span class="comment">#打印路径上的交换机</span></span><br><span class="line">        <span class="keyword">else</span>:<span class="comment">#如果控制器的 mac_to_port 列表里面没有目的主机的 mac 地址，执行以下代码</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;dst mac is unknown&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;the dpid is &#x27;</span>,dpid)</span><br><span class="line">            actions=[]<span class="comment">#actions 初始化</span></span><br><span class="line">            <span class="keyword">for</span> port <span class="keyword">in</span> datapath.ports:<span class="comment">#对于向控制器发送 packetin 消息的交换机中的每一个端口，执行下面的代码</span></span><br><span class="line">                <span class="keyword">if</span>(port <span class="keyword">not</span> <span class="keyword">in</span> self.banport[dpid]) <span class="keyword">and</span> (port != in_port):<span class="comment">#如果端口不是禁止端口并且不是数据包进入的端口，将端口加入执行洪泛操作的端口列表里面</span></span><br><span class="line">                    actions.append(ofp_parser.OFPActionOutput(port))</span><br><span class="line">        out=ofp_parser.OFPPacketOut(datapath=datapath,buffer_id=msg.buffer_id,in_port=in_port,actions=actions,data=msg.data)<span class="comment">#向出端口发送的数据包内容</span></span><br><span class="line">        datapath.send_msg(out)<span class="comment">#发送数据包</span></span><br></pre></td></tr></table></figure><p>新定义一个字典列表来存储主机和交换机之间的链路信息。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> dst <span class="keyword">in</span> self.mac_to_port[dpid]:<span class="comment">#目的主机地址在 mac_to_port 表中</span></span><br><span class="line">    <span class="keyword">if</span> src <span class="keyword">not</span> <span class="keyword">in</span> self.host_mac_to.keys(): </span><br><span class="line">        self.host_mac_to[src]=(dpid,in_port)<span class="comment">#若源主机地址不在 host_mac_to 表中,则在该表中增加这一项</span></span><br><span class="line">    <span class="keyword">if</span> dst,src <span class="keyword">in</span> self.host_mac_to.keys():<span class="comment">#如果目的主机和源主机 mac 地址在host_mac_to 表中，则读取主机和交换机之间的链路</span></span><br><span class="line">        src_switch=self.host_mac_to[src][<span class="number">0</span>]</span><br><span class="line">        first_port=self.host_mac_to[src][<span class="number">1</span>]</span><br><span class="line">        dst_switch=self.host_mac_to[dst][<span class="number">0</span>]</span><br><span class="line">        final_port=self.host_mac_to[dst][<span class="number">1</span>]</span><br><span class="line">        path=self.search_path(src_switch,dst_switch,first_port,final_port)<span class="comment">#寻找路径</span></span><br><span class="line">        self.configure_path(path,src,dst,datapath)<span class="comment">#配置路径</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#发流表</span></span><br><span class="line">        out_port=self.mac_to_port[dpid][dst]</span><br><span class="line">        actions=[ofp_parser.OFPActionOutput(out_port)]</span><br><span class="line">        <span class="keyword">match</span>=ofp_parser.OFPMatch(in_port=in_port,eth_dst=dst,eth_src=src)</span><br><span class="line">        self.add_flow(datapath,<span class="number">1</span>,<span class="keyword">match</span>,actions)</span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">        <span class="keyword">if</span> src <span class="keyword">not</span> <span class="keyword">in</span> self.host_mac_to.keys(): </span><br><span class="line">            self.host_mac_to[src]=(dpid,in_port)</span><br><span class="line">        actions=[]</span><br><span class="line">        <span class="keyword">for</span> port <span class="keyword">in</span> datapath.ports: </span><br><span class="line">            <span class="keyword">if</span>(port <span class="keyword">not</span> <span class="keyword">in</span> self.banport[dpid]) <span class="keyword">and</span> (port != in_port): </span><br><span class="line">                actions.append(ofp_parser.OFPActionOutput(port))</span><br></pre></td></tr></table></figure><h1 id="成果展示-2">成果展示</h1><h2 id="拓扑构建">拓扑构建</h2><p>（一）mininet侧</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225454759.png" alt="mininet拓扑构建信息"></p><p>（二）RYU侧</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225510126.png" alt="RYU侧拓扑发现"></p><p>（三）七节点拓扑可视化</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225525767.png" alt="拓扑示意图"></p><h2 id="DFS算法实现">DFS算法实现</h2><p>（一）mininet侧 —— 连通性良好</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225538716.png" alt="mininet侧连通性良好"></p><p>以 h2 ping h7 示例</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225553983.png" alt="ping测试"></p><p>（二）RYU侧</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225615811.png" alt="RYU侧连通性测试"></p><p>（三）最短路和最长路可视化</p><p>（蓝色路径为最长路，黄色路径为最短路，绿色路径为重合的路径，黑色路径为未经过路径）</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225633115.png" alt="拓扑可视化"></p>]]></content>
      
      
      <categories>
          
          <category> 网络算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SDN </tag>
            
            <tag> Ubuntu </tag>
            
            <tag> 项目开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用SDN网络架构的Kruskal算法实践</title>
      <link href="/fd05d161/"/>
      <url>/fd05d161/</url>
      
        <content type="html"><![CDATA[<h1 id="项目要求-3">项目要求</h1><ol><li>配置一个广播通信业务，假设主机0 向所有其它主机进行广播。</li><li>使用Kruskal 算法计算广播使用的最小生成树。</li><li>将广播业务在可视化平台上进行展示。</li></ol><h1 id="基本原理">基本原理</h1><h2 id="Kruskal-算法">Kruskal 算法</h2><h3 id="最小生成树概念">最小生成树概念</h3><p>引入一个实际问题：要在n 个城市中建立一个通信网络，则连通这n 个城市需要布置n-1 一条通信线路，这个时候我们需要考虑如何在成本最低的情况下建立这个通信网？</p><p>将问题抽象出来，即n 个城市就是图上的n 个顶点，然后，边表示两个城市的通信线路，每条边上的权重就是我们搭建这条线路所需要的成本，所以现在我们有n 个顶点的连通网可以建立不同的生成树，每一颗生成树都可以作为一个通信网，当我们构造这个连通网所花的成本最小时，搭建该连通网的生成树，就称为最小生成树。</p><p>具体概念：在一给定的无向图G = (V, E) 中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> 代表连接顶点u 与顶点v 的边，而 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\omega (u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>代表此边的权重，若存在 t 为 E 的子集且为无循环图，使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>t</mi></mrow><mrow></mrow></msubsup><mi>ω</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\omega (t) = \sum_{(u,v)\in t}^{} \omega (u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2247em;vertical-align:-0.4747em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.5029em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">u</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4747em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\omega (t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span> 最小，则此T 为G 的最小生成树（最小权重生成树）。</p><h3 id="基本思想-3">基本思想</h3><p>将所有边按照权值的大小进行升序排序，然后从小到大一一判断，条件为：如果这个边不会与之前选择的所有边组成回路，就可以作为最小生成树的一部分；反之，舍去。直到具有n 个顶点的连通网筛选出来n-1 条边为止。筛选出来的边和所有的顶点构成此连通网的最小生成树。</p><h3 id="关键点">关键点</h3><p>Kruskal 算法基本分为排序和成环检测两大环节，其中排序算法发展多年，已经将其复杂度压榨到了很小，尤其对于非线性时间比较类排序，其时间复杂度更是不能突破nlogn。</p><p>因此，kruskal 算法的关键点在于成环检测算法的优化。</p><p>最直接的实现方式是将图用邻接链表存储，调用广度优先算法（Breadth First Search，BFS）,如果遍历到向相同的点，则说明有环，否则说明无环。引入新的数据结构——UNION-FIND，主要操作是UNION（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">C_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>）:将集合<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">C_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>合并为一个集合，并用FIND（x）返回元素x 所在集合的名字，记为leader。若一条边的两顶点的leader 不同，说明该边是一条割边，即不会成环。</p><h2 id="拓扑可视化">拓扑可视化</h2><h3 id="可视化思路">可视化思路</h3><p>利用mininet 的net 操作打印出所读取的拓扑的网络节点关系信息，并且修改mininet 文件中的相关代码使得net 操作打印出的信息能直接进入用于存储信息的txt 文件中。之后利用python 中的networkx 库读取txt 文件内容并且利用Matplotlib 的绘图功能即可画出相应的拓扑图。</p><h3 id="NetworkX-原理">NetworkX 原理</h3><p>NetworkX 是一款python 的软件包，它内置了常用的图和网络分析算法。但是在本项目中我们只使用它的创建简单图（有向图或无向图）的功能，再导入Matplotlib 的绘图接口绘出所需拓扑图的图像。</p><h1 id="代码实现-2">代码实现</h1><h2 id="拓扑建立">拓扑建立</h2><h3 id="主体代码">主体代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;topo24.json&quot;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> load_f:</span><br><span class="line">    topoinfo=json.load(load_f)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, topoinfo[<span class="string">&quot;host_no&quot;</span>]+<span class="number">1</span>):</span><br><span class="line">        self.addHost(<span class="string">&quot;h&quot;</span>+<span class="built_in">str</span>(h))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, topoinfo[<span class="string">&quot;switch_no&quot;</span>]+<span class="number">1</span>):</span><br><span class="line">        self.addSwitch(<span class="string">&quot;s&quot;</span>+<span class="built_in">str</span>(s))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">17</span>):</span><br><span class="line">        self.addLink(topoinfo[<span class="string">&quot;links&quot;</span>][i][<span class="string">&quot;vertexs&quot;</span>][<span class="number">0</span>],topoinfo[<span class="string">&quot;links&quot;</span>][i][<span class="string">&quot;vertexs&quot;</span>][<span class="number">1</span>],delay=<span class="built_in">str</span>(topoinfo[<span class="string">&quot;links&quot;</span>][i][<span class="string">&quot;delay&quot;</span>])+<span class="string">&#x27;ms&#x27;</span>,bw=<span class="built_in">int</span>(topoinfo[<span class="string">&quot;links&quot;</span>][i][<span class="string">&quot;bw&quot;</span>]))</span><br></pre></td></tr></table></figure><p>读取topo24.json 文件里的信息，存入topoinfo 中。通过addHost 读取并存储主机信息，通过addSwitch 读取并存储交换机信息，通过addLink 读取交换机和主机之间以及交换机之间的连接信息和时延带宽信息。</p><h3 id="库函数说明">库函数说明</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mininet.topo <span class="keyword">import</span> Topo <span class="comment">#该类里面包含了addHost、addSwitch 和addLink 方法</span></span><br><span class="line"><span class="keyword">from</span> mininet.net <span class="keyword">import</span> Mininet <span class="comment">#该类提供了实现控制台pingall 等命令的方法、将搭建好的拓扑连接到Ryu 控制器的方法以及给拓扑中的主机和交换机分配MAC 地址以及IP 地址的方法</span></span><br><span class="line"><span class="keyword">from</span> mininet.node <span class="keyword">import</span> CPULimitedHost <span class="comment">#给控制器和交换机之间的接口设置IP 地址，并且对虚拟主机的CPU 划定带宽</span></span><br><span class="line"><span class="keyword">from</span> mininet.link <span class="keyword">import</span> TCLink <span class="comment">#引用TClink 类，设置虚拟链路的带宽和时延</span></span><br><span class="line"><span class="keyword">from</span> mininet.util <span class="keyword">import</span> dumpNodeConnections <span class="comment">#引用dumpNodeConnections 方法，断开和某一个节点的连接</span></span><br><span class="line"><span class="keyword">from</span> mininet.log <span class="keyword">import</span> setLogLevel <span class="comment">#引用setLogLevel，输出mininet 运行的状态</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br></pre></td></tr></table></figure><p>其中sys 和os 都是python 的系统操作模块，sys 提供了一组非常实用的服务，os 模块负责程序和操作系统的交互，提供了访问操作系统底层的接口。json 提供了读取json 文件的方法。</p><h2 id="RYU通信">RYU通信</h2><h3 id="初始化">初始化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Kruskaltest</span>(app_manager.RyuApp):</span><br><span class="line"></span><br><span class="line">    OFP_VERSIONS=[ofproto_v1_3.OFP_VERSION] <span class="comment">#确定控制器的openflow 版本</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,*args,**kwargs</span>):</span><br><span class="line">        <span class="built_in">super</span>(Kruskaltest,self).__init__(*args,**kwargs) <span class="comment">#继承自己，方便后面的初始化步骤</span></span><br><span class="line">        self.mac_to_port=&#123;&#125; <span class="comment">#arp 列表初始化</span></span><br><span class="line">        self.topology_api_app=self</span><br><span class="line">        self.sleep_interval = <span class="number">0.5</span> <span class="comment">#程序暂停的时间为0.5 秒，以使mininet 和ryu 的拓扑建立保持同步，防止链路丢失</span></span><br><span class="line">        self.switches = [] <span class="comment">#交换机列表初始化</span></span><br><span class="line">        self.links = [] <span class="comment">#链路信息初始化</span></span><br><span class="line">        self.mst_links = [] <span class="comment">#最小生成树上的链路初始化</span></span><br><span class="line">        self.pathes = &#123;&#125; <span class="comment">#路径初始化</span></span><br><span class="line">        self.banport = &#123;&#125; <span class="comment">#被禁止的端口初始化</span></span><br></pre></td></tr></table></figure><h3 id="流表配置">流表配置</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@set_ev_cls(<span class="params">ofp_event.EventOFPSwitchFeatures,CONFIG_DISPATCHER</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">switch_features_handler</span>(<span class="params">self,ev</span>):</span><br><span class="line">    datapath=ev.msg.datapath</span><br><span class="line">    ofproto=datapath.ofproto</span><br><span class="line">    ofp_parser=datapath.ofproto_parser</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">match</span>=ofp_parser.OFPMatch()</span><br><span class="line">    actions=[ofp_parser.OFPActionOutput(ofproto.OFPP_CONTROLLER,ofproto.OFPCML_NO_BUFFER)]</span><br><span class="line">    self.add_flow(datapath,<span class="number">0</span>,<span class="keyword">match</span>,actions) <span class="comment">#配置缺省流表，match 域为空，对每一个交换机都添加该流表，当交换机无法处理收到的数据包时，执行actions，把数据包向控制器转发</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_flow</span>(<span class="params">self,datapath,priority,<span class="keyword">match</span>,actions</span>):<span class="comment">#控制器向交换机发流表的方法</span></span><br><span class="line">    ofproto=datapath.ofproto</span><br><span class="line">    ofp_parser=datapath.ofproto_parser</span><br><span class="line"> </span><br><span class="line">    inst=[ofp_parser.OFPInstructionActions(ofproto.OFPIT_APPLY_ACTIONS,actions)]<span class="comment">#收到后立即执行actions</span></span><br><span class="line">  <span class="comment">#以上内容为流表信息的获取</span></span><br><span class="line"></span><br><span class="line">    mod=ofp_parser.OFPFlowMod(datapath=datapath,priority=priority,<span class="keyword">match</span>=<span class="keyword">match</span>,instructions=inst)<span class="comment">#流表内容定义，第一个为流表从哪一个交换机发送过来，第二个为权重，第三个为匹配域，当收到的数据包和匹配域匹配上时执行instructions</span></span><br><span class="line">    datapath.send_msg(mod)<span class="comment">#发送流表</span></span><br></pre></td></tr></table></figure><h3 id="拓扑发现">拓扑发现</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@set_ev_cls(<span class="params">event.EventSwitchEnter,[CONFIG_DISPATCHER,MAIN_DISPATCHER]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">switch_enter_handler</span>(<span class="params">self,ev</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;==================================&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;switch entered...&#x27;</span>)</span><br><span class="line">    self.switches,self.links = self.get_topology() <span class="comment">#通过后面的get_topology 方法来获取交换机和链路信息</span></span><br><span class="line">    <span class="comment">#self.mst_links = self.kruskal(self.links[:])</span></span><br><span class="line">    self.banport = self.find_banport(self.links[:]) <span class="comment">#找到被禁止的端口，因为洪泛时不能有圈，否则会陷入死循环</span></span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> self.mst_links:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&#123;&#125; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(link[<span class="string">&#x27;src_dpid&#x27;</span>],link[<span class="string">&#x27;dst_dpid&#x27;</span>])) <span class="comment">#打印最小生成树</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;==================================&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    time.sleep(self.sleep_interval) <span class="comment">#ryu 每发现一个交换机之后都要暂停一段时间，让mininetd 建立拓扑的速度能跟上，否则会造成链路丢失</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_topology</span>(<span class="params">self</span>):</span><br><span class="line">    switch_list = get_switch(self.topology_api_app,<span class="literal">None</span>)</span><br><span class="line">    switches = [switch.dp.<span class="built_in">id</span> <span class="keyword">for</span> switch <span class="keyword">in</span> switch_list]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;switches:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(switches))<span class="comment">#得到并打印交换机列表</span></span><br><span class="line">    <span class="keyword">for</span> switch <span class="keyword">in</span> switches:</span><br><span class="line">        self.banport.setdefault(switch,[])<span class="comment">#初始化被禁止的端口列表</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;------------------------------------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;banport first_list is&#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.banport))</span><br><span class="line">    link_list = get_link(self.topology_api_app,<span class="literal">None</span>)</span><br><span class="line"> </span><br><span class="line">    links = [&#123;<span class="string">&#x27;src_dpid&#x27;</span>:link.src.dpid,<span class="string">&#x27;src_port_no&#x27;</span>:link.src.port_no,<span class="string">&#x27;dst_dpid&#x27;</span>:link.dst.dpid,<span class="string">&#x27;dst_port_no&#x27;</span>:link.dst.port_no&#125;</span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> link_list]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;the getted link_list is&#123;&#125;&quot;</span>.<span class="built_in">format</span>(links)) <span class="comment">#得到并打印链路信息，其中包含了源交换机的dpid 和对应的端口号以及目的交换机的dpid 和对应的端口号</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">#add &#x27;delay&#x27; in link</span></span><br><span class="line">    <span class="comment">#file = open(&quot;./topo24.json&quot;,&quot;r&quot;)</span></span><br><span class="line">    file = <span class="built_in">open</span>(<span class="string">&quot;./topo7.json&quot;</span>,<span class="string">&quot;r&quot;</span>)<span class="comment">#由于原来的24 个交换机拓扑太大，故用7 个交换机来作为测试，读取topo7.json 里的信息</span></span><br><span class="line">    topoinfo = json.load(file)</span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> links:</span><br><span class="line">        <span class="keyword">for</span> edge <span class="keyword">in</span> topoinfo[<span class="string">&#x27;links&#x27;</span>]:</span><br><span class="line">          <span class="keyword">if</span>([<span class="string">&quot;s&quot;</span>+<span class="built_in">str</span>(link[<span class="string">&quot;src_dpid&quot;</span>]),<span class="string">&quot;s&quot;</span>+<span class="built_in">str</span>(link[<span class="string">&quot;dst_dpid&quot;</span>])] == edge[<span class="string">&quot;vertexs&quot;</span>] <span class="keyword">or</span> [<span class="string">&quot;s&quot;</span>+<span class="built_in">str</span>(link[<span class="string">&quot;dst_dpid&quot;</span>]),<span class="string">&quot;s&quot;</span>+<span class="built_in">str</span>(link[<span class="string">&quot;src_dpid&quot;</span>])] == edge[<span class="string">&quot;vertexs&quot;</span>]): </span><br><span class="line">            link[<span class="string">&#x27;delay&#x27;</span>] = edge[<span class="string">&#x27;delay&#x27;</span>]</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="控制器对收到的数据包的处理">控制器对收到的数据包的处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@set_ev_cls(<span class="params">ofp_event.EventOFPPacketIn,MAIN_DISPATCHER</span>) </span><span class="comment">#监视器，当有packetin 消息进来时，</span></span><br><span class="line">执行下面的代码</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">packet_in_handler</span>(<span class="params">self,ev</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;==========================================================&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;it has entered packet_in_handler func&#x27;</span>)</span><br><span class="line">    msg=ev.msg</span><br><span class="line"></span><br><span class="line">    datapath=msg.datapaths</span><br><span class="line">    ofproto=datapath.ofproto</span><br><span class="line">    ofp_parser=datapath.ofproto_parser</span><br><span class="line"> </span><br><span class="line">    dpid=datapath.<span class="built_in">id</span> <span class="comment">#id from switch</span></span><br><span class="line">    <span class="comment">#以上是对收到的数据包进行解析</span></span><br><span class="line">    </span><br><span class="line">    self.mac_to_port.setdefault(dpid,&#123;&#125;) <span class="comment"># 对控制器里面的mac_to_port 列表初始化</span></span><br><span class="line">    pkt=packet.Packet(msg.data) <span class="comment">#读取需要传输的数据</span></span><br><span class="line">    eth=pkt.get_protocol(ethernet.ethernet) <span class="comment">#读取以太网地址的数据包，里面包含了src 和dst 以及ethertype 等信息</span></span><br><span class="line">    in_port=msg.<span class="keyword">match</span>[<span class="string">&#x27;in_port&#x27;</span>] <span class="comment">#读取匹配域中的进入交换机的端口号</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;in_port is &quot;</span>,in_port)</span><br><span class="line">    src = eth.src</span><br><span class="line">    self.mac_to_port[dpid][src]=in_port <span class="comment">#将源交换机的MAC 地址和源交换机进入该交换机的端口号对应起来</span></span><br><span class="line">    dst=eth.dst <span class="comment">#目的主机的MAC 地址</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;the src is &#x27;</span>, src)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;the dst is &#x27;</span>, dst)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;the dpid is &#x27;</span>, dpid)</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;self.mac_to_port:&quot;</span>, self.mac_to_port)</span><br><span class="line">    pathes=&#123;&#125; <span class="comment">#路径初始化</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">#如果目的主机的MAC地址已经在控制器的mac_to_port列表里面有记录，直接下发流表</span></span><br><span class="line">    <span class="keyword">if</span> dst <span class="keyword">in</span> self.mac_to_port[dpid]: </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;dst mac is known&#x27;</span>)</span><br><span class="line">        out_port=self.mac_to_port[dpid][dst]</span><br><span class="line">        actions=[ofp_parser.OFPActionOutput(out_port)]</span><br><span class="line">        <span class="keyword">match</span>=ofp_parser.OFPMatch(in_port=in_port,eth_dst=dst,eth_src=src)</span><br><span class="line">        <span class="comment">#以上为对流表内容的定义</span></span><br><span class="line">        </span><br><span class="line">        self.add_flow(datapath,<span class="number">1</span>,<span class="keyword">match</span>,actions) <span class="comment">#权值为1，表示优先级先于缺省流表</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;add flow&quot;</span>)</span><br><span class="line"> </span><br><span class="line">        self.pathes.setdefault(src,&#123;&#125;)</span><br><span class="line">        self.pathes[src].setdefault(dst,[]) <span class="comment">#对从这个主机开始的路径做初始化</span></span><br><span class="line"> </span><br><span class="line">        self.pathes[src][dst].append(dpid) <span class="comment">#往路径上添加交换机</span></span><br><span class="line"> </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;path appending:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.pathes[src][dst])) <span class="comment">#打印路径上的交换机</span></span><br><span class="line">    <span class="keyword">else</span>: <span class="comment">#如果控制器的mac_to_port 列表里面没有目的主机的mac 地址，执行以下代码</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;dst mac is unknown&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;the dpid is &#x27;</span>,dpid)</span><br><span class="line">        actions=[] <span class="comment">#actions 初始化</span></span><br><span class="line">        <span class="keyword">for</span> port <span class="keyword">in</span> datapath.ports: <span class="comment">#对于向控制器发送packetin 消息的交换机中的每一个端口，执行下面的代码</span></span><br><span class="line">            <span class="keyword">if</span>(port <span class="keyword">not</span> <span class="keyword">in</span> self.banport[dpid]) <span class="keyword">and</span> (port != in_port): <span class="comment">#如果端口不是禁止端口并且不是数据包进入的端口，将端口加入执行洪泛操作的端口列表里面</span></span><br><span class="line">                actions.append(ofp_parser.OFPActionOutput(port))</span><br><span class="line">    out=ofp_parser.OFPPacketOut(datapath=datapath,buffer_id=msg.buffer_id,in_port=in_port,actions=actions,data=msg.data) <span class="comment">#向出端口发送的数据包内容</span></span><br><span class="line">    datapath.send_msg(out)<span class="comment">#发送数据包</span></span><br></pre></td></tr></table></figure><h3 id="库函数说明-2">库函数说明</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ryu.base <span class="keyword">import</span> app_manager <span class="comment">#ryu.base 是ryu 的管理中心，起到加载各种ryu 应用、为ryu应用提供环境和提供不同ryu 应用之间的连接的作用，从ryu.base 里面引用的app_manager 类里面包含管理所有ryu 程序的方法，包括启动ryu、加载ryu 应用和关闭ryu 等</span></span><br><span class="line"><span class="keyword">from</span> ryu.topology.api <span class="keyword">import</span> get_link,get_switch</span><br><span class="line"><span class="keyword">from</span> ryu.base <span class="keyword">import</span> app_manager</span><br><span class="line"><span class="keyword">from</span> ryu.ofproto <span class="keyword">import</span> ofproto_v1_3 <span class="comment">#引入ofproto_v1_3 协议，该协议是本ryu 控制器遵守的协议</span></span><br><span class="line"><span class="keyword">from</span> ryu.controller.handler <span class="keyword">import</span> set_ev_cls</span><br><span class="line"><span class="keyword">from</span> ryu.controller.handler <span class="keyword">import</span> CONFIG_DISPATCHER,MAIN_DISPATCHER <span class="comment">#引入了一个事件监视器，下面的语句引入了两种状态config 为配置状态，main 为运行状态</span></span><br><span class="line"><span class="keyword">from</span> ryu.lib.packet <span class="keyword">import</span> packet <span class="comment">#将收到的数据包里信息转换成特定格式</span></span><br><span class="line"><span class="keyword">from</span> ryu.lib.packet <span class="keyword">import</span> ethernet <span class="comment">#引入ethernet 类，将数据包的MAC 地址组织成特定格式</span></span><br><span class="line"><span class="keyword">from</span> ryu.topology <span class="keyword">import</span> event <span class="comment">#event 里面定义了后续使用的EventSwitchEnter 等类</span></span><br><span class="line"><span class="keyword">from</span> ryu.topology.api <span class="keyword">import</span> get_switch,get_link <span class="comment">#用于实现交换机和控制器的连接和通过LLDP协议读取交换机的拓扑</span></span><br><span class="line"><span class="comment">#import networkx as nx</span></span><br><span class="line"><span class="keyword">from</span> ryu.controller <span class="keyword">import</span> ofp_event <span class="comment">#ofp_event 类包含了之后需要使用的msg 和msg.datapath方法，前一个用于读取信息，后一个用于读取数据包的来自哪一个交换机</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> string</span><br></pre></td></tr></table></figure><h2 id="kruskal-算法运用">kruskal 算法运用</h2><h3 id="概述-3">概述</h3><p>在基于SDN 的实际网络拓扑中，每个交换机和所属主机可以看成一个顶点，各交换机相连接的信道看成一条边，其权重则为每条信道的时延。对于交换机，还有一个重要的属性——端口，即交换机连接其他网络设备的接口。为了洪泛简便，我们采用逆向kruskal 算法的原理，即找出最小生成树不在的端口，记为banport。只要数据包在banport 停止传输，只在允许通行的端口传输，那么一定不会成环，必然是在最小生成树上。</p><h3 id="变量说明-2">变量说明</h3><ul><li><p>src_dpid：源交换机id</p></li><li><p>dst_dpid:目的交换机id</p></li><li><p>Links：边集，特点：双向；包含源交换机id 和端口，目的交换机id 和端口，权重</p></li></ul><h3 id="代码实现-3">代码实现</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">links.sort(key = <span class="keyword">lambda</span> x:x[<span class="string">&#x27;delay&#x27;</span>]) <span class="comment">#升序排序</span></span><br></pre></td></tr></table></figure><p>对于排序，我们使用python 自带的对列表的排序，将关键字设为delay,即按时延为权重升序排序。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#成环检测（UNION-FIND 思想）</span></span><br><span class="line">group = [[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(self.switches)+<span class="number">1</span>)] <span class="comment">#创建包含交换机数量子集合的集合</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> link <span class="keyword">in</span> links:</span><br><span class="line">    <span class="keyword">if</span> link[<span class="string">&#x27;src_dpid&#x27;</span>]&lt;link[<span class="string">&#x27;dst_dpid&#x27;</span>]: <span class="comment">#遍历每一条边，且每一条边只遍历一次</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(group)):</span><br><span class="line">            <span class="keyword">if</span> link[<span class="string">&quot;dst_dpid&quot;</span>] <span class="keyword">in</span> group[i]:</span><br><span class="line">                m = i</span><br><span class="line">            <span class="keyword">if</span> link[<span class="string">&quot;src_dpid&quot;</span>] <span class="keyword">in</span> group[i]:</span><br><span class="line">                n = i <span class="comment">#将源交换机和目的交换机所在的集合序号记录在m,n 中</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#如果m,n 相等，即该边不是一条割边，则将其端口禁掉</span></span><br><span class="line">        <span class="keyword">if</span> m == n <span class="keyword">and</span> link[<span class="string">&#x27;dst_port_no&#x27;</span>] <span class="keyword">not</span> <span class="keyword">in</span> banport[link[<span class="string">&quot;dst_dpid&quot;</span>]]:</span><br><span class="line">            banport[link[<span class="string">&quot;dst_dpid&quot;</span>]].append(link[<span class="string">&#x27;dst_port_no&#x27;</span>])</span><br><span class="line">            banport[link[<span class="string">&quot;src_dpid&quot;</span>]].append(link[<span class="string">&#x27;src_port_no&#x27;</span>])</span><br><span class="line">        <span class="comment">#如果不相等，则将两边端点并入一个集合</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            group[m] = group[m] + group[n]</span><br><span class="line">            group[n] = []</span><br></pre></td></tr></table></figure><p>对于成环检测的实现，我们采用UNION-FIND 的思想，每个集合的leader 即为集合的序号，如果源交换机和目的交换机的leader 的相同，说明二者在同一个集合，即会成环，则将二者连接的两个端口禁掉；若二者的leader 不同，说明二者不会成环，则更新集合，将二者集合合并。由于边集是升序排列，因此遍历时也从小到大遍历，当最终所有交换机都在同一集合中时，说明最小生成树已经形成。</p><h1 id="成果展示-3">成果展示</h1><h2 id="拓扑构建-2">拓扑构建</h2><p>（一）mininet侧</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223056717.png" alt="mininet侧拓扑信息"></p><p>（二）RYU侧</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223116585.png" alt="RYU侧拓扑信息"></p><p>（三）拓扑可视化</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223133759.png" alt="拓扑示意图"></p><h2 id="kruskal-算法实现">kruskal 算法实现</h2><p>（一）禁止端口</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223155252.png" alt="禁止端口信息"></p><p>（二）最小生成树可视化</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223212865.png" alt="最小生成树示意图"></p><h2 id="连通性测试">连通性测试</h2><p>（一）随机ping测试</p><p>mininet侧，可以看到花费了0.499毫秒ping通</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223235154.png" alt="mininet侧打印信息"></p><p>RYU侧，可以看到逐渐从2号主机沿着最小生成树扩展到达19号</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223250541.png" alt="RYU侧打印信息"></p><p>（二）pingall测试</p><p>下图可见全部ping通，连通性良好。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223312822.png" alt="全部ping通图"></p>]]></content>
      
      
      <categories>
          
          <category> 网络算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SDN </tag>
            
            <tag> Ubuntu </tag>
            
            <tag> 项目开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mininet拓扑搭建</title>
      <link href="/2a47880c/"/>
      <url>/2a47880c/</url>
      
        <content type="html"><![CDATA[<h1 id="基于python脚本的拓扑搭建">基于python脚本的拓扑搭建</h1><p>Mininet这个网络仿真软件支持使用python脚本建立拓扑，我们只需要预先写好存储拓扑信息的文件和拓扑建立逻辑（这是两个文件）就可以一键运行，在拓扑规模大、链路数量多的情况下（实验用的拓扑就挺大）能极大提高仿真效率，且不容易出现错误搭建拓扑的情况（比如少拉了一根线，拉错了一根线之类的）。</p><h1 id="拓扑搭建逻辑">拓扑搭建逻辑</h1><p>mininet自带有一个拓扑搭建脚本，我们先来看一下拓扑搭建逻辑。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103221333212.png" alt="拓扑搭建逻辑"></p><p>你可以在上图红色框线所示的文件路径找到系统里的拓扑搭建脚本，里面的代码就只有一页这么多（才34行，简单得不能再简单了）。</p><ul><li>绿色框线里的内容是这个 python 脚本成功运行需要的一些库，一般不需要改动（当然了，如果你想给这个脚本增加一些新功能，相应的库也要加进来，比如让他能读取json文件，就需要添加读取json文件需要的库，具体是什么，可以自行搜索~）。</li><li>橙色框线的第一行代码读取拓扑信息，注意，此处读取的路径使用了相对路径（./表示当前脚本文件所在的路径），使用绝对路径也是可以的，第15行代码读取拓扑信息文件的第一行，即下图的第一行。下图的第一行数据分别表示这个拓扑里的主机数量（3）和交换机数量（7）</li><li>有了这两个信息，上图的紫色框线开始向 mininet 网络中添加主机（line18）和交换机（line21），然后上图的程序继续读取拓扑文件的其他行，用于添加设备之间的链路（上图蓝色框线部分）。</li><li>最后，上图白色框线的部分相当于为这个脚本创建的网络起了一个名字，你可以做定制化的改动，比如改成你自己的名字，但是一定要记住自己改成了什么，后面实际运行时需要用到。</li></ul><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103221353216.png" alt="拓扑信息"></p><p>接下来，我们看看拓扑信息文件到底存了什么。你可以在上图中红色框线所示的路径下（其实就是拓扑搭建脚本所在的路径）找到存储拓扑信息的文件（topoinfo.txt）。打开以后其实也就14行，第一行的意思刚刚已经解释过了，仔细观察，你会发现，之后的每一行都对应了要搭建的拓扑里面的一条边。这并不是实验要用的那个拓扑的信息，而是下图所示的拓扑。到这里，我们可以回到第一幅图的蓝色框线部分了，是不是能理解这部分代码在干什么了。</p><p><img src="https://cdn.jsdelivr.net/gh/asa-pic/pic_1/img/image-20220721213138963.png" alt="示例拓扑"></p><h1 id="json文件描述拓扑">json文件描述拓扑</h1><p>这一部分，还有一点补充，第二幅图的文件用最简单的文件格式（实际就是txt）去描述了一个网络的拓扑信息，但并不一定最好用，例如当网络拓扑比较大，且需要给链路附加诸如时延和带宽等属性的时候，文件解析（解析就是指从文件中去找想要的某些信息）起来不太方便，比如DFS、Dijkstra需要获取拓扑中链路的时延属性，最大流需要获取链路的带宽，有时候需要全部链路的这些信息，有时候又只需要某条链路的信息，那从这种txt中去找相关信息就比较麻烦。万幸的是，不论是拓扑搭建脚本、还是ryu控制器的控制逻辑，都是用python写的，python是可以通过调库将json文件读取成字典的（如果你还不知道python字典是什么，自觉去面壁10分钟），到这，你悟了吗？</p><h1 id="运行拓扑">运行拓扑</h1><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103221409328.png" alt="Mininet运行自定拓扑"></p><p>现在我们正式开始运行用户自定义的脚本（革命快要成功了，再坚持一下），上图中橙色框线里橙色横线处的代码表示要自定义脚本，其后紧跟的就是我们拓扑建立逻辑的脚本文件（严格讲应该是脚本文件所在的路径再加文件名，只是这里执行该命令的位置就是文件所在的目录），绿色框线里的内容就相当于这个建立的拓扑叫什么名字了，还记得最开始的图里里白色框线里的东西吗，就是那个玩意儿，蓝色框线的命令告诉mininet这个软件，我这个建起来的拓扑需要连接到一个远程的控制器，这个控制器的ip是127.0.0.1，端口号是6653（openflow协议的默认端口号），最后紫色框线的配置告诉mininet：你给我按照添加主机的顺序，从00:00:00:00:00:01开始依次分配物理地址（注意物理地址用的是十六进制，00:00:00:00:00:10不是10而是16，切记，切记），如果你不加这条命令，每个添加的主机的mac地址就是随机分配的，没有规律（在之前给的b站上的视频里面，作者也提到过这个）。输入密码后，Mininet就开始建立拓扑了，黄色框线内显示了mininet建立拓扑的过程，先添加了三个主机、然后是7个交换机、最后是13条边（注意是双向边）。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103221429940.png" alt="结束运行"></p><p>Mininet的命令状态下输入exit（图5红色框线）会退出，节点和链路都依次停止，蓝色框线里显示mininet停止了多少条链路。</p><p>这里还要注意一个问题，对mininet来说，一共增加了13条双向边，其中有三条是主机和交换机之间的链路，剩余10条才是交换机和交换机之间的边，对控制器来说，他只能观测到交换机和交换机之间的边（也就是他能获取到20条边，因为这里的10条边是双向边，所以ryu控制器按两个方向各存一条），而看不到主机和交换机之间的边，原因在于控制器发现拓扑用的是LLDP协议，且控制器控制的是交换机，只有交换机会向控制器请求指示，而在LLDP链路发现过程中发送到主机的测试包会被主机直接丢掉，不存在主机也将这个数据包向上发给控制器的可能，所以LLDP检测不到主机和交换机之间的链路。）</p><blockquote><p>还有一个问题需要解释，你可能都没发现这个问题：图3中交换机的端口号是怎么确定的？Mininet在给设备端口分配编号的时候也是从1开始（不同设备之间的端口编号是独立的），按照设备接口上连接链路的顺序，依次编号。举个栗子：按照图2的拓扑文件，与交换机1有关的链路的添加顺序是h1-s1、s1-s2、s1-s4，所以s1相对应的端口也就被分别编号1、2、3。也就是说，这个端口编号在你给定了拓扑信息和搭建拓扑的脚本逻辑的时候，命运已定。</p></blockquote><p>至此，拓扑搭建的所有内容已经介绍完了，回过头来再看，建立一个拓扑的信息文本其实要比搭建拓扑的逻辑脚本麻烦的多，毕竟后者就几个for的事，前者那可真是实打实地要一条条加呀，就拿之前给的那个24个节点地拓扑来说，交换机到交换机的边有43条（ryu控制器的get_link()拉取的信息中包含的链路数量翻倍），主机到交换机的边有24条，合起来67条（你可以用我上面介绍的办法看看他是不是真的是67条），这你要是拿miniedit拉可得拉多久，想想就头秃。</p><h1 id="实验拓扑">实验拓扑</h1><p>为了防止你头秃，这里破例提供两个已建好的拓扑信息的json文件（注意，前面讲解的拓扑搭建代码不能直接处理json文件，你还需要做出相应的调整），如果你愿意，可以直接用我提供的json文件去实现后续的逻辑。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;host_no&quot;</span><span class="punctuation">:</span> <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;switch_no&quot;</span><span class="punctuation">:</span> <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;links&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s1&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s2&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s3&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h4&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s4&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h5&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s5&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h6&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s6&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h7&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s7&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s2&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">18</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s4&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">9</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s3&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">14</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s5&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">22</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s6&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">19</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s4&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s5&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">15</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">16</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s4&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s6&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">21</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s5&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s6&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">10</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s5&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s7&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">9</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">6</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s6&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s7&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">11</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">11</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>上面代码中一共7个交换机，拓扑图如下，每个交换机下挂一个主机，图中只画出一个主机（h3），但你需要知道还有6个主机并没有画出来，主机和交换机之间的链路属性都按图6中的蓝色数值进行了设置，交换机之间的链路属性也按图中标注进行了设置。</p><p>所有链路的排列顺序（正常来说就是后面搭建拓扑的脚本添加链路的顺序，也就是说）如下：首先是主机和交换机之间的链路，按主机编号增序添加；然后是交换机和交换机之间的链路，按交换机编号增序依次添加交换机的所有邻居链路，对邻居的要求是其编号比自己的大，在满足这个条件的邻居里，先添加邻居编号小的链路（这里用文字描述有点绕，没看明白的话多看几次）。按这个规则形成的拓扑中，交换机的各个接口编号以较小的红色数字标注在了对应位置。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103221453635.png" alt="image-20230103221453635"></p><hr><p>类似的，下面给定实验拓扑，只是相比上图，下图追加了按这个文件建立的拓扑的交换机接口编号信息。代码中链路的顺序规则同上。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;host_no&quot;</span><span class="punctuation">:</span> <span class="number">24</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;switch_no&quot;</span><span class="punctuation">:</span> <span class="number">24</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;links&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s1&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s2&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s3&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h4&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s4&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h5&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s5&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h6&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s6&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h7&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s7&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h8&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s8&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h9&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s9&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h10&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s10&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h11&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s11&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h12&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s12&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h13&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s13&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h14&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s14&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h15&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s15&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h16&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s16&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h17&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s17&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h18&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s18&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h19&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s19&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h20&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s20&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h21&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s21&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h22&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s22&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h23&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s23&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;h24&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s24&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s2&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">19</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s7&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">21</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s3&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">13</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s7&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">9</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s4&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">6</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s5&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">24</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">30</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s6&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">7</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s4&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s5&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">12</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">11</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s4&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s8&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">15</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s5&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s6&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">16</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s6&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s7&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">9</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s6&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s8&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">29</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">18</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s6&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s9&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">25</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s7&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s9&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">5</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s7&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s10&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">15</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">27</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s8&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s14&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">14</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">6</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s9&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s10&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">26</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">17</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s9&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s12&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">15</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s9&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s14&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">19</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">14</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s10&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s11&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">11</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">10</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s10&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s12&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">7</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s10&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s18&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">25</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">18</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s11&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s17&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">18</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s11&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s19&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">20</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">13</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s12&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s13&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">13</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s12&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s17&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">13</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">22</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s13&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s14&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">14</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">19</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s13&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s15&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">11</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s13&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s16&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">14</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">2</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s14&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s15&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">7</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s15&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s24&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">25</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">16</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s16&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s17&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">17</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">6</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s16&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s21&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">11</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">9</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s16&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s22&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">12</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s16&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s24&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">14</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">6</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s17&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s20&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">21</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">8</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s17&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s21&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">10</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s18&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s19&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">15</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s19&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s20&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">15</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">7</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s20&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s21&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">9</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s21&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s22&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">13</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">14</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s22&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s23&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">4</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vertexs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;s23&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s24&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;delay&quot;</span><span class="punctuation">:</span> <span class="number">17</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;bw&quot;</span><span class="punctuation">:</span> <span class="number">23</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103221518431.png" alt="24节点拓扑图"></p>]]></content>
      
      
      <categories>
          
          <category> 网络算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SDN </tag>
            
            <tag> Ubuntu </tag>
            
            <tag> 教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验环境搭建</title>
      <link href="/14618721/"/>
      <url>/14618721/</url>
      
        <content type="html"><![CDATA[<h1 id="Ubuntu系统">Ubuntu系统</h1><p>ubuntu18.04是一个Linux内核的系统，如果你是Windows用户，不习惯是正常现象。在这里，应用更多是要通过命令行或者说终端去运行，而不是双击快捷方式，也许你不熟悉常用命令（cd、ls、sudo等），没关系，这种帖子网上很容易就能搜到，是时候自学点东西了。</p><p>另外虚拟机中还需要有RYU控制器和mininet这两个应用。</p><hr><h1 id="RYU控制器">RYU控制器</h1><p>RYU 是一个基于组件的完全用python 实现的开源框架，组件包括OpenFlow 协议支持、时间管理、消息机制、内存状态管理、应用程序管理、基础设施服务和一系列可用的库，此外，还提供一些应用程序和服务，例如侦测（Snort）、二层交换机、GRE 隧道抽象、VRRP、拓扑和统计服务等。</p><p>打开终端输入<em>ryu-manager</em>（区分大小写）按下回车，如下显示则说明ryu控制器可以正常运行。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103221548418.png" alt="开启ryu控制器示意图"></p><p>此外还可以尝试运行ryu自带的一些应用，进入到ryu的app目录下，输入：<em>ryu-manager</em> 空格 应用名（即python脚本文件名称，需要加后缀，见截图），若运行不报错则说明控制器工作正常。Mininet的测试类似，相关命令大家百度，这里不多说。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103221608850.png" alt="运行ryu应用示意图"></p><hr><h1 id="mininet">mininet</h1><p>Mininet 是一个网络模拟器，可以在Linux 内核上模拟出多个主机、交换机、路由器和链路，所有的组件都通过虚拟以太网进行连接，并配置了net-10 私有IP 地址，支持非常复杂的拓扑结构，可以近乎任意大小和顺序，基于它的网络的性能常常非常接近真实网络的性能。</p><p>Mininet 创建topo 的方式有很多：命令行创建网络拓扑、自定义拓扑脚本、可视<br>化界面创建拓扑。</p><p>我们同样可以建立mininet自带的一些拓扑，如下图所示。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103221626812.png" alt="建立拓扑示意图"></p><hr><h1 id="需要学的东西">需要学的东西</h1><p>Ryu的应用和mininet的拓扑脚本都是使用Python编写，也许你没有学过Python，但相信我，Python代码至少在编写的时候要比C语言人性化得多。</p><p>Mininet这边，需要掌握的东西相对较少，熟悉拓扑脚本文件的编写差不多就足够了，</p><p>Ryu控制器方面，对初学者来说，先看些视频、学习官方文档才是王道，全凭感觉是肯定不行的，那样你可能连前面的应用都跑不起来。<a href="https://www.bilibili.com/video/BV1VJ41117vJ?p=15&amp;vd_source=595ecb634d520a0458c323613451f9a6">这些视频</a>已经是我目前找到的讲得最最清楚的教程了（画质烂，但能凑合看），可以看看，之后再参考下Ryubook（群文件里的参考书文件夹中Ryubook-en）和在线的<a href="https://ryu.readthedocs.io/en/latest/writing_ryu_app.html">官方文档</a>，就差不多了。</p><p>要做完后续几个实验，至少需要：</p><ol><li><span class='p gray'>熟悉</span>Python的基础语法</li><li><span class='p yellow'>会用</span>Linux的常用命令</li><li><span class='p green'>了解</span>Mininet的拓扑创建逻辑</li><li><span class='p cyan'>清楚</span>Ryu的事件处理流程</li><li><span class='p red'>掌握</span>实验所需的算法理论</li></ol>]]></content>
      
      
      <categories>
          
          <category> 网络算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SDN </tag>
            
            <tag> Ubuntu </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>自动驾驶系统分层模型设计</title>
      <link href="/d3e09831/"/>
      <url>/d3e09831/</url>
      
        <content type="html"><![CDATA[<h1 id="任务概览">任务概览</h1><h2 id="主题">主题</h2><p>利用网络分层模型的要素，参考功能分层依据，设计一个分层系统，或者用分层模型描述一个系统。</p><h2 id="目标">目标</h2><ul><li><p>体会分层模型的分层方法和要素</p></li><li><p>体会垂直分层，纵向服务与被服务关系，横向协议合作关系在分层模型中的设计方法</p></li></ul><hr><h1 id="问题剖析">问题剖析</h1><h2 id="自动驾驶系统简介">自动驾驶系统简介</h2><p>自动驾驶系统系统采用先进的通信、计算机、网络和控制技术，对汽车实现实时、连续控制。采用现代通信手段，直接面对汽车，可实现车地间的双向数据通信，传输速率快，信息量大，后续追踪汽车和控制中心可以及时获知前汽车车的确切位置，使得运行管理更加灵活，控制更为有效，更加适应汽车自动驾驶的需求。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103221655745.png" alt="自动驾驶示意图"></p><h2 id="需求分析-3">需求分析</h2><p>自动驾驶汽车需要依靠人工智能、视觉计算、雷达、监控装置和全球定位系统协同合作，让电脑可以在没有任何人类主动的操作下，自动安全地操作机动车辆。最终目标为通过该系统实现完全自动化，即可无人驾驶车辆、允许车内所有乘员从事其他活动且无需进行监控的系统。</p><p>对分层的设计需要实现：</p><ul><li><p>垂直分层，下层为上层提供服务</p></li><li><p>层与层间界限清晰，尽可能独立</p></li><li><p>层内功能模块按一定的规则交互</p></li></ul><hr><h1 id="分层设计">分层设计</h1><p>根据系统内容及需求，我们将自动驾驶系统分为四层模型：</p><ul><li><p>交互层：根据系统做出的决策，替代人类控制车辆正常工作</p></li><li><p>决策层：处理网络层传来的信息并做出决策判断，判定相应的控制策略</p></li><li><p>网络层：识别和传递感知层获取的信息</p></li><li><p>物理层：信息收集与控制</p></li></ul><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222125258.png" alt="自动驾驶系统分层设计图"></p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222221643.png" alt="image-20230103222221643"></p><hr><h1 id="层次分析">层次分析</h1><h2 id="物理层">物理层</h2><h3 id="功能">功能</h3><p>物理层主要负责数据采集以及自动驾驶汽车操作的硬件行为控制。采集的信息包括自信息和互信息。</p><p>自信息：车速度、加速度、刹车状态、方向盘转角、GPS位置、本车类型、载员数、载物重</p><p>互信息（暂时不考虑存在路人干扰的情况）：</p><ul><li><p>与周围车辆1的距离，车辆1在本车的方位；</p></li><li><p>与周围车辆2的距离，车辆2在本车的方位；</p></li><li><p>……</p></li><li><p>与周围车辆n的距离，车辆n在本车的方位。</p></li></ul><h3 id="物理层-网络层数据传输格式">物理层-网络层数据传输格式</h3><p>数据内容与格式（data）：</p><div class="note modern"><p>#车仪表盘显示速度#加速度#刹车状态#方向盘转角#GPS提供的纬度数据#GPS提供的经度数据#GPS所得车速#GPS所测车航向#车型号#载员数#载物重#周围车辆数#车辆1与本车距离#车辆1在本车的方位#…#车辆n与本车距离#车辆n与本车的方位#</p></div><p>例：</p><div class="note modern"><p>#060.00#-01.500#50#+030#N04546.4089#E10246.1089#055.00#30#BJ2020S#2#250#1#90#</p></div><details class="folding-tag" cyan><summary> 参数标准设计 </summary>              <div class='content'>              <ul><li><p><strong>车仪表盘显示速度</strong>：整数位为3位，小数保留2位，单位为 km/h；</p></li><li><p><strong>加速度</strong>：符号位（‘+’‘-’）一位，整数位2位，小数位3位，单位为 m/s2；</p></li><li><p><strong>刹车状态</strong>：三位数表示，取值为0~100，表示刹车的下压程度，0表示未踩刹车，100表示刹车踩死，下压程度100%；</p></li><li><p><strong>方向盘转角</strong>：一位符号位（‘+’‘-’），三位数字位，符号位为正，表示顺时针转动方向盘，反之为逆时针，数字位表示转动角度；</p></li><li><p><strong>GPS提供的纬度数据</strong>：一个符号位（‘N’‘S’），五位整数位，四位小数位，dddmm.mmmm(度分)格式(前面的0也将被传输)；</p></li></ul><blockquote><p>经纬度计算规则：如接收到的纬度是4546.4089</p><p><em>4546.40891/100=45.464089**可以直接读出45度, 4546.40891-45*100=46.4089, 可以直接读出46分，46.4089–46 =0.4089*60=24.5346读出24秒, 所以纬度是：45度46分24秒</em></p></blockquote><ul><li><p><strong>GPS提供的经度数据</strong>：一个符号位（‘E’‘W’），数字位dddmm.mmmm，计算方法同纬度的计算方法；</p></li><li><p><strong>GPS所得车速</strong>：由于车仪表盘的速度和GPS所测的速度是有所不同的，根据实际的需要，所以准备两份数据，格式同车仪表盘的速度传输格式；</p></li><li><p><strong>GPS所测车航向</strong>：偏离正北的角度，数据范围0~ 360，0表示正北方向，90正东和180表示正南方向，270正西；</p></li><li><p><strong>车型号</strong>：根据车的不同型号提供不同的数据，无特定格式；</p></li><li><p><strong>载员数</strong>：数据范围0~N，N为车限制载人数，1，为只有司机一人；</p></li><li><p><strong>载物重</strong>：载物重根据车上的测重系统所得，更具车型不同有不同的计算方法和传输格式，单位为kg；</p></li><li><p><strong>周围车辆数</strong>：数字N，范围为 N&gt;=0；</p></li><li><p><strong>车辆1与本车距离</strong>：直线相对距离，单位m；</p></li><li><p><strong>车辆1在本车的方位</strong>：相对方位，以车正对方向为0度，俯视，顺时针扫描，记录转动的角度，范围0~360度，精确到小数后两位；</p></li><li><p><strong>车辆n与本车距离</strong>：同车辆1；</p></li><li><p><strong>车辆n与本车的方位</strong>：同车辆1。</p></li></ul>              </div>            </details><h3 id="物理层和网络层的接口设计和数据文件的封装">物理层和网络层的接口设计和数据文件的封装</h3><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222238334.png" alt="物理层-网络层数据格式示意图"></p><details class="folding-tag" red><summary> 参数说明 </summary>              <div class='content'>              <ul><li><p>flg：标志位，101，表示上传数据，由物理层传送到网络层，来自采集的信息；102表示下载数据，由决策层传送到网络层，再到物理层的数据，系统将根据这些数据对车辆的下一步对对应参数做出调整；</p></li><li><p>Serial number：序列号，根据数据采集产生的顺序形成的序列号；</p></li><li><p>Time：数据采集时间；</p></li><li><p>total length：首部和数据的总长度；</p></li><li><p>source address：源地址；</p></li><li><p>destination address：目的地址；</p></li><li><p>data：采集的需传输的数据。</p></li></ul>              </div>            </details><h3 id="数据包解封">数据包解封</h3><p>flg=102的数据包来自网络，数据内容是决策层对本车下一步状态的控制，解封时，验证源地址是否为本车网络层，目的地址是否为物理层，再通过total length检查数据完整性，最后取出数据，将数据作于于对应位置。</p><h2 id="网络层">网络层</h2><h3 id="功能-2">功能</h3><p>网络层实现数据的存储、查询、分析，以及对等层的数据交换，数据交换过程中的加密功能。</p><h3 id="加密协议">加密协议</h3><p>加密协议是用于在数据的传输、交换过程中通过加密技术建立安全通信以保障驾驶安全以及用户信息安全的协议。</p><p>自动驾驶的应用会使得更多的数据将会被使用、传输，因此自动驾驶数据的安全性需要极其关注。需要避免汽车收集数据的恶意篡改导致操作失误，以及用户隐私的泄露（如家的地理位置等等）。所以我们将采用加密协议来对数据进行加密处理，实现隐私数据的安全传输。</p><p>该协议可以对传输的隐私数据进行对称密钥加密，在保证一定的传输速度的同时，提供一定的安全性。</p><h3 id="网络层-网络层之间的数据包格式">网络层-网络层之间的数据包格式</h3><p>为了实现统一性和整体性设计原则，我们把网络层数据包格式和封装的设计与物理层的设计类似，但其传输的数据内容和意义将有变化。如下图所示。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222300038.png" alt="网络层-网络层数据格式示意图"></p><details class="folding-tag" red><summary> 参数说明 </summary>              <div class='content'>              <ul><li><p>flg：这个传输包flg=203，表示这个包属于网络层之间的传输的数据包。</p></li><li><p>Serial number和Time位与原包相同，不发生变化。</p></li><li><p>total length：表示这个包首部和数据的总长度。</p></li><li><p>source address：本车网络层的地址；</p></li><li><p>destination address: 邻车网络层地址；</p></li><li><p>data：数据内容源于对flg=10的数据包解封，但只传输一部分数据，这部分数据包含如下：</p></li></ul><div class="note modern"><p>#车仪表盘显示速度#加速度#刹车状态#方向盘转角#车型号#周围车辆数#车辆1与本车距离#车辆1在本车的方位#…#车辆n与本车距离#车辆n与本车的方位#</p></div>              </div>            </details><h3 id="网络层与决策层之间的数据封装格式">网络层与决策层之间的数据封装格式</h3><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222319354.png" alt="网络层-决策层数据格式示意图"></p><details class="folding-tag" red><summary> 参数说明 </summary>              <div class='content'>              <ul><li><p>flg ：flg =201，表示该数据是由网络层传送至决策层；flg=202，表示该数据是由网络层传送至网络层的数据；</p></li><li><p>Serial number ：序列号，根据数据包生成顺序形成的序列号；</p></li><li><p>Time ：数据包生成时间；</p></li><li><p>total length ：首部和数据的总长度；</p></li><li><p>source address ；源地址，本车网络层地址或决策层地址；</p></li><li><p>destination address ：目的地址，本车网络层地址或决策层地址；</p></li><li><p>flg1/flg2：由于网络层向决策层传输数据包含了本车的数据和邻车的数据，而决策层向网络层的下行数据包只包含对本车下一步决策的数据，不再包含邻车的数据，所以接下来这几个数据会由于flg=201或flg=202不同而不同：</p><blockquote><ul><li><p>flg=201时，flg1=1，flg2=1，表示这是个上行数据包，data1、data2都有数据，其中data1是本车的数据，data2是邻车的数据；</p></li><li><p>flg=202时，flg=1，flg2=0，表示这是个下行数据包，仅data1有数据；</p></li></ul></blockquote></li><li><p>Data 1 acquisition time/Data 2 acquisition time：数据获取或生成时间，这里指最开始数据的采集时间，或者针对flg=202时，指的是决策生成时间；</p></li><li><p>Length of the data 1/Length of the data 2：表示data1/data2的数据长度。</p></li></ul>              </div>            </details><h3 id="数据包解封-2">数据包解封</h3><ol><li><strong>对flg=102的数据包进行解封</strong></li></ol><p>flg=102的数据是从物理层传送到本层网络层的，解封检查源地址与目标地址，源地址应该是本层，目标地址为本层（网络层）的地址，若不满足条件，则丢弃该数据，最后经过total length验证数据完整性，取出数据（data），以便分析时使用。</p><ol start="2"><li><strong>对flg=202的数据包进行解封</strong></li></ol><p>flg=202的数据包是由决策层传输至网络层的，数据包最终作用于物理层，用于将决策层对汽车的下一步状态的控制，解封检查源地址是否为本车决策层地址，目的地址是否为本车网络层地址，再用total length和Length of the data 1验证数据完整性，最后取出数据。</p><ol start="3"><li><strong>对flg=203的数据包进行解封</strong></li></ol><p>flg =203的数据是网络层之间传输的，所以对收到的flg=2的数据包，源地址是临车的网络层地址，目的地址是本车的网络层地址，然后通过total length检查数据完整性，最后取出数据。</p><h2 id="决策层">决策层</h2><h3 id="功能-3">功能</h3><p>决策层通过网络层提供的数据来对汽车下一步行为的决策，同时实现车与车之间决策信息的交换、计算与冲突解决，最终将关键的决策信息上传于交互层。</p><h3 id="差错控制协议">差错控制协议</h3><p>差错控制协议用于作为自动驾驶系统的网络层中，车辆之间数据交换的可靠传输协议。</p><p>在自动驾驶系统中，提高收集数据的准确性可以保证自动驾驶的安全性。因此数据的准确获取与传输至关重要。在网络层，不同的车辆间将会互相进行数据的交换，而车辆所获取的数据可能存在错误。因此，利用差错控制协议比对交换的数据，来控制可能出现的数据错误而导致的决策层误判。</p><p>在比对数据时，若发现交换的数据不同（误差不可接受），说明可能发生数据的错误，则要求物理层在合理时间范围内重新收集并传输数据，进行再次比对；若超过时间范围，则不向物理层请求重传而使用原始数据。</p><p>例：在网络层数据的初步分析中，会进行数据对比（两辆车的基础数据进行对比），如A车测得B车在东南方向50m，则B车应该检测到A车在自己西北50m，但B车实际传入的数据是A车在西北100m处，这时候网络层通过这个协议判断出原始数据存在较大的误差，这会影响决策层的决策，所以网络层丢弃这份数据，发送指令让物理层重新采集数据，我们称之为差错控制协议。</p><h3 id="决策选择协议">决策选择协议</h3><p>决策选择协议是从多个决策中选出最优决策以做出最优操作行为，并避免与其他自动驾驶车辆产生决策冲突的协议。</p><p>在车道上一般会有多辆车在行驶，如果车辆根据获取的数据采取了相互冲突的行驶行为，就很有可能会发生碰撞等意外情况，造成安全事故。所以通过设计决策选择协议，在多个决策当中选择车辆间互不冲突的决策达到规避事故的目的，并顺利完成行驶。</p><p>决策层根据网络层信息做出多个决策，并预先将每个决策通过算法计算出执行决策后的行车数据。进一步，交换比对车辆间的“决策后行车数据”，判断出执行某一决策后是否会产生车辆间的行驶冲突，会则舍弃该决策，不会则选择该决策。</p><h3 id="决策层数据包">决策层数据包</h3><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222338460.png" alt="决策层数据包示意图"></p><details class="folding-tag" red><summary> 参数说明 </summary>              <div class='content'>              <p>flg说明：</p><ul><li><p>flg=301，表示决策层向交互层发送的数据包，这里的数据包内容包含有：汽车当前状态、下一步决策，这个数据包的意义就是将这些参数外显给用户；</p></li><li><p>flg=302，表示交互层向决策层发送的数据包，这个数据包传输的是用户下达的指令，如更改目的地、减速等指令，决策层处理这些指令，并转换格式编码，传输给执行的物理层；</p></li><li><p>flg=303，表示决策层之间传输的数据包，为了确保两辆或多辆车之间的决策不会冲突，说以，车辆之间的决策需要共享，若存在冲突，则根据协议需要更改；</p></li></ul><p>Serial number、Time、total length同上说明；</p>              </div>            </details><h3 id="数据包解封-3">数据包解封</h3><p>对flg=201，数据进行解封：数据来源于网络层，包含了本车和邻近车量的状态数据，解封时，验证源地址、目的地址、数据长度。</p><h2 id="交互层">交互层</h2><h3 id="功能-4">功能</h3><p>交互层将决策层的决策信息呈现给用户，并实现不同车辆人员之间的信息交互（包括通话、娱乐等）。</p><p>第四层主要是人机之间的交互，还有就是两辆车上的用户通过交互层进行互动，这些完全可以引用和参考其他协议的实现，如HTTP、XMPP等，因此这里不再赘述。</p><hr><h1 id="参考资料-10">参考资料</h1><ul><li><p>汤珺雅,李莉,刘凌,汪伟,王文明,谢勇波 .  基于全时空数据的驾驶行为模型设计 . [2017]</p></li><li><p>韩双双,王迎春,要婷婷,曹东璞,王飞跃 . 平行智能车:基于CPSS的网联自动驾驶汽车 . [2017]</p></li><li><p>陈海明,崔莉,谢开斌 . 物联网体系结构与实现方法的比较研究 . [2013]</p></li><li><p>魏歌 . 不同物联网架构的分层标准的研究 . [2015]</p></li><li><p>彭赟,刘志雄,刘晓莉,孙云莲,査晓明,饶凌平 . TCP/IP网络体系结构分层研究 . [2014]</p></li><li><p>K. M. Alam, M. Saini and A. E. Saddik  . Toward Social Internet of Vehicles: Concept, Architecture, and Applications .[2015]</p></li><li><p>彭锴 . 网络安全分层评价体系模型设计 . [2016]</p></li></ul><blockquote><p>鸣谢：琦琦子、林林子</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 项目报告 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 研究报告 </tag>
            
            <tag> 计算机通信网 </tag>
            
            <tag> 自动驾驶 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OFDM技术（2）—— 多载波技术</title>
      <link href="/32a389a4/"/>
      <url>/32a389a4/</url>
      
        <content type="html"><![CDATA[<h1 id="频分复用">频分复用</h1><p><strong>频分复用</strong>（FDM,Frequency Division Multiplexing）这个概念我们并不陌生。当用汽车接收广播的时候，每个电台节目使用不同的频率，就可以看成不同的载波。此时如果我们想听 f1 频道，那么经过与 f1 相一致的带通滤波器，这个电台节目就会被接收下来了。这是传统的FDM。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232119095.png" alt="滤波示意图"></p><p>但是频段资源是有限的，如果要支持成千上百的电台节目是很困难的，因此我们必须提高频段的利用率。</p><hr><h1 id="OFDM技术">OFDM技术</h1><h2 id="单载波与多载波技术">单载波与多载波技术</h2><p>单载波是指在一个固定的频段内只采用一个载波的调制技术，上面举的例子就是单载波的传输方案。单载波存在很多问题，除了频谱利用率低，还有之前所说的<a href="http://asa-world.github.io/2022/02/25/OFDM%E6%8A%80%E6%9C%AF%EF%BC%881%EF%BC%89%E2%80%94%E2%80%94%E7%A0%81%E5%85%83%E4%B8%8E%E6%AF%94%E7%89%B9%E8%A7%A3%E6%9E%90/">码间串扰</a> 、回响、脉冲干扰、振幅不平衡、群延时响应等。</p><p>就码间串扰而言，单载波方法的码元速率相对较高，通常1MS/s～30MS/s，因此码元持续时间（符号速率的倒数）为1µs或更短。然而地面传输路径的反射波延迟很容易位于100µs～250µs范围内（大约70km），将导致相邻码元甚至更远距离码元的码间串扰。</p><p>显然为减少干扰：</p><blockquote><ul><li>尽量延长符号持续时间；</li><li>可以在符号间插入空白，叫做防护间隔（guard intervals）；</li><li>同时在接收端，通过采用误码保护的方法恢复和重建信息。</li></ul></blockquote><hr><p>如果信息不通过单一载波进行传输，而是分散到多个载波，最多成千个副载波，那么如果某个载波或载波带受到衰落影响，其余<strong>子载波不会受影响</strong>。同时，接收端可从相对不分散的载波中恢复出足够的无误码信息，并利用采取的误码保护措施来<strong>重建无误码的输出数据流</strong>。另外，如果采用成千的子载波使得符号速率将被降低，<strong>符号持续时间也将相应延长</strong>几千倍，最大到1ms。</p><p>这就是多载波传输的优势所在，那么我们的<strong>正交频分复用技术</strong>（OFDM,Orthogonal Frequency Division Multiplexing）是目前实现复杂度最低、应用最广的一种多载波传输方案。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232058625.png" alt="多载波传输"></p><h2 id="三角函数的正交原理">三角函数的正交原理</h2><p>三角函数的正交原理是OFDM技术的最基本的原理，它是指不同频率的正弦波是正交的。下面我们来证明这一点。</p><p>假设有两个正弦波：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>sin</mi><mo>⁡</mo><mn>2</mn><mi>π</mi><msub><mi>k</mi><mn>1</mn></msub><mi>t</mi></mrow><annotation encoding="application/x-tex">\sin 2\pi k_{1}  t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span></span></span></span> 、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>sin</mi><mo>⁡</mo><mn>2</mn><mi>π</mi><msub><mi>k</mi><mn>2</mn></msub><mi>t</mi></mrow><annotation encoding="application/x-tex">\sin 2\pi k_{2} t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span></span></span></span>，让我们来算一下二者在[0,1]区间内的积分 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msub><mi>a</mi><mi>k</mi></msub><mi>sin</mi><mo>⁡</mo><mn>2</mn><mi>π</mi><msub><mi>k</mi><mn>1</mn></msub><mi>t</mi><mo>⋅</mo><mi>sin</mi><mo>⁡</mo><mn>2</mn><mi>π</mi><msub><mi>k</mi><mn>2</mn></msub><mi>t</mi><mi mathvariant="normal">d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\int_{0}^{1} a_{k}\sin 2\pi k_{1}  t \cdot  \sin 2\pi k_{2} t \mathrm{d}t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3648em;vertical-align:-0.3558em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0006em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.009em;"><span style="top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.2579em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3558em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mord mathrm">d</span><span class="mord mathnormal">t</span></span></span></span>。</p><p>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>=</mo><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">k_{1} = k_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>时，</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msub><mi>a</mi><mi>k</mi></msub><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><msub><mi>k</mi><mn>1</mn></msub><mi>t</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><msub><mi>k</mi><mn>2</mn></msub><mi>t</mi><mo stretchy="false">)</mo><mi>d</mi><mi>t</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>a</mi><mi>k</mi></msub><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msup><mrow><mi>sin</mi><mo>⁡</mo></mrow><mn>2</mn></msup><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><msub><mi>k</mi><mn>1</mn></msub><mi>t</mi><mo stretchy="false">)</mo><mi>d</mi><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>a</mi><mi>k</mi></msub><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><mfrac><mrow><mn>1</mn><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>4</mn><mi>π</mi><msub><mi>k</mi><mn>1</mn></msub><mi>t</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac><mi>d</mi><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><msub><mi>a</mi><mi>k</mi></msub><mn>2</mn></mfrac></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}\begin{split}   \int_{0}^{1}a_{k} \sin( 2\pi k_{1}t ) \cdot \sin( 2\pi k_{2}t){d}t   &amp;= a_{k}\int_{0}^{1} \sin^{2} ( 2\pi k_{1}  t ){d}t\\      &amp;=a_{k}\int_{0}^{1} \frac{1-\cos(4\pi k_{1}t)}{2}{d}t\\      &amp;=\frac{a_{k}}{2}\end{split}\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.6455em;vertical-align:-3.5727em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0727em;"><span style="top:-6.0727em;"><span class="pstrut" style="height:6.0727em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0727em;"><span style="top:-6.0727em;"><span class="pstrut" style="height:3.564em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.564em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">d</span></span><span class="mord mathnormal">t</span></span></span><span style="top:-3.2968em;"><span class="pstrut" style="height:3.564em;"></span><span class="mord"></span></span><span style="top:-0.9773em;"><span class="pstrut" style="height:3.564em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5727em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0727em;"><span style="top:-6.0727em;"><span class="pstrut" style="height:3.564em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.564em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">sin</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8719em;"><span style="top:-3.1208em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">d</span></span><span class="mord mathnormal">t</span></span></span><span style="top:-3.2968em;"><span class="pstrut" style="height:3.564em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.564em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">d</span></span><span class="mord mathnormal">t</span></span></span><span style="top:-0.9773em;"><span class="pstrut" style="height:3.564em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5727em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5727em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0727em;"><span style="top:-6.0727em;"><span class="pstrut" style="height:6.0727em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5727em;"><span></span></span></span></span></span></span></span></span></p><p>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><mo mathvariant="normal">≠</mo><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">k_{1} \ne  k_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>时，</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msub><mi>a</mi><mi>k</mi></msub><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><msub><mi>k</mi><mn>1</mn></msub><mi>t</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><msub><mi>k</mi><mn>2</mn></msub><mi>t</mi><mo stretchy="false">)</mo><mi mathvariant="normal">d</mi><mi>t</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><mfrac><msub><mi>a</mi><mi>k</mi></msub><mn>2</mn></mfrac><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><mo stretchy="false">[</mo><mi>cos</mi><mo>⁡</mo><mtext>（</mtext><mn>2</mn><mi>π</mi><msub><mi>k</mi><mn>1</mn></msub><mi>t</mi><mo>+</mo><mn>2</mn><mi>π</mi><msub><mi>k</mi><mn>2</mn></msub><mi>t</mi><mtext>）</mtext><mo>−</mo><mi>cos</mi><mo>⁡</mo><mtext>（</mtext><mn>2</mn><mi>π</mi><msub><mi>k</mi><mn>1</mn></msub><mi>t</mi><mo>−</mo><mn>2</mn><mi>π</mi><msub><mi>k</mi><mn>2</mn></msub><mi>t</mi><mtext>）</mtext><mo stretchy="false">]</mo><mi mathvariant="normal">d</mi><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">(</mo><mtext>设</mtext><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mo>=</mo><mi>a</mi><mo separator="true">,</mo><msub><mi>k</mi><mn>1</mn></msub><mo>−</mo><msub><mi>k</mi><mn>2</mn></msub><mo>=</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><mfrac><msub><mi>a</mi><mi>k</mi></msub><mn>2</mn></mfrac><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><mo stretchy="false">[</mo><mi>cos</mi><mo>⁡</mo><mtext>（</mtext><mn>2</mn><mi>π</mi><mi>a</mi><mi>t</mi><mtext>）</mtext><mo>−</mo><mi>cos</mi><mo>⁡</mo><mtext>（</mtext><mn>2</mn><mi>π</mi><mi>b</mi><mi>t</mi><mtext>）</mtext><mo stretchy="false">]</mo><mi mathvariant="normal">d</mi><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}\begin{split} \int_{0}^{1}a_{k} \sin( 2\pi k_{1}  t )\cdot  \sin( 2\pi k_{2} t) \mathrm{d}t &amp;= - \frac{a_{k}}{2}\int_{0}^{1} [\cos（2\pi k_{1}t+2\pi k_{2}t）- \cos（2\pi k_{1}t-2\pi k_{2}t）] \mathrm{d}t\\&amp;(设k_{1}+k_{2}=a,k_{1}-k_{2}=b)\\&amp;=- \frac{a_{k}}{2}\int_{0}^{1} [\cos（2\pi at）- \cos（2\pi   bt）] \mathrm{d}t\\&amp;= 0 \end{split}\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:8.5519em;vertical-align:-4.026em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.526em;"><span style="top:-6.526em;"><span class="pstrut" style="height:6.526em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.526em;"><span style="top:-6.526em;"><span class="pstrut" style="height:3.564em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.564em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord mathrm">d</span><span class="mord mathnormal">t</span></span></span><span style="top:-4.474em;"><span class="pstrut" style="height:3.564em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.564em;"></span><span class="mord"></span></span><span style="top:-0.1981em;"><span class="pstrut" style="height:3.564em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.026em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.526em;"><span style="top:-6.526em;"><span class="pstrut" style="height:3.564em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.564em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">（</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">）</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">（</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">）</span><span class="mclose">]</span><span class="mord mathrm">d</span><span class="mord mathnormal">t</span></span></span><span style="top:-4.474em;"><span class="pstrut" style="height:3.564em;"></span><span class="mord"><span class="mord"></span><span class="mopen">(</span><span class="mord cjk_fallback">设</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.564em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.564em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">（</span><span class="mord">2</span><span class="mord mathnormal">πa</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">）</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">（</span><span class="mord">2</span><span class="mord mathnormal">πb</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">）</span><span class="mclose">]</span><span class="mord mathrm">d</span><span class="mord mathnormal">t</span></span></span><span style="top:-0.1981em;"><span class="pstrut" style="height:3.564em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.026em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.026em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.526em;"><span style="top:-6.526em;"><span class="pstrut" style="height:6.526em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.026em;"><span></span></span></span></span></span></span></span></span></p><p>这表明这一系列不同频率的正弦函数是正交的。同理，余弦函数同样有此性质。这种数学上的性质，对于通信而言异常重要。</p><p>因为这些正弦函数就是通信中所说的子载波，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">a_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>就是我们要发送的信息，也就是一个码元，经过基带调制后，实际发送的信号为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>k</mi></msub><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>k</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_{k}\sin(2πkt)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03148em;">πk</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span>。</p><h2 id="OFDM的调制与解调基本原理">OFDM的调制与解调基本原理</h2><p>用原始要发送的信号<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">a_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">b_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>去调制相互正交的子载波序列 { <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>sin</mi><mo>⁡</mo><mn>2</mn><mi>π</mi><mi>k</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\sin2πkt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03148em;">πk</span><span class="mord mathnormal">t</span></span></span></span>,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>sin</mi><mo>⁡</mo><mn>2</mn><mi>π</mi><mi>k</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\sin2πkt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03148em;">πk</span><span class="mord mathnormal">t</span></span></span></span>,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>sin</mi><mo>⁡</mo><mn>3</mn><mi>π</mi><mi>k</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\sin3πkt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:0.03148em;">πk</span><span class="mord mathnormal">t</span></span></span></span> } 和 { <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>cos</mi><mo>⁡</mo><mn>2</mn><mi>π</mi><mi>k</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\cos2πkt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03148em;">πk</span><span class="mord mathnormal">t</span></span></span></span>,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>cos</mi><mo>⁡</mo><mn>2</mn><mi>π</mi><mi>k</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\cos2πkt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03148em;">πk</span><span class="mord mathnormal">t</span></span></span></span>,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>cos</mi><mo>⁡</mo><mn>3</mn><mi>π</mi><mi>k</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\cos3πkt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:0.03148em;">πk</span><span class="mord mathnormal">t</span></span></span></span> } ，然后进行累加，得到 s(t) ，这个 s(t) 是OFDM基带信号，是一个实信号，又由于基带信号的频率太低，不满足远距离传输的要求，那么经过射频调制后，就满足了。然后再用天线发射出去就可以了。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232043000.png" alt="OFDM的调制与解调"></p><p>解调所用的子载波与调制用的子载波同频同相，这是根据我们上面的推导（1）得出的，不管各子载波怎么杂糅，我们只要用哪一个子载波调制就用哪一个子载波解调，这样就可以得到我们想要的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">a_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的信息。根据推导（2），子载波不相同的在同一码元周期内就会被积为0，因此毫无影响，这就是正交的好处。</p><hr><h1 id="参考资料-7">参考资料</h1><ul><li><p>李锐博恩. <a href="https://blog.csdn.net/reborn_lee/article/details/81024133">理解原理图</a>. [2018-07-13]</p></li><li><p>ZhangP.H. <a href="https://blog.csdn.net/weixin_40106401/article/details/106885575?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-1.pc_relevant_paycolumn_v3&amp;spm=1001.2101.3001.4242.2&amp;utm_relevant_index=4">理解OFDM技术原理</a>. [2020-06-21]</p></li><li><p>张文军. OFDM技术. [2006-2007]</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 5G技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 5G </tag>
            
            <tag> 学习笔记 </tag>
            
            <tag> 大学生竞赛 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RS232接口分析</title>
      <link href="/9ede2b4c/"/>
      <url>/9ede2b4c/</url>
      
        <content type="html"><![CDATA[<h1 id="RS-232接口概述">RS-232接口概述</h1><p>RS-232标准接口（又称EIA RS-232）是常用的串行通信接口标准之一，它是由美国电子工业协会(EIA)联合贝尔系统公司、调制解调器厂家及计算机终端生产厂家于1970年共同制定。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222403640.png" alt="RS-232串口线图"></p><blockquote><p>主要特点:</p><ul><li><strong>低速</strong>：1200bps,2400bps….最大传输速率为115.2kbps；</li><li><strong>短距离</strong>：最大传输距离为12m，一般不超过3m；</li><li><strong>结构简单</strong>：最简方式只要使用3根普通电线即可。</li></ul></blockquote><p>它是最基本的I/O接口，常用在计算机、嵌入式系统、单片机等产品中。</p><hr><h1 id="各针脚功能">各针脚功能</h1><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222427494.png" alt="RS-232针脚功能图"></p><ul><li>针脚1负责<strong>载波检测</strong>（DCD, Data Carrier Detect），即当本地的<a href="#dce&amp;dte">DCE</a>收到由通信链路另一端的DCE送来的载波信号时，使DCD变为有效(高电平)，表示已检测出远端的载波信号，要求<a href="#dce&amp;dte">DTE</a>准备接收。</li><li>针脚2负责<strong>接受数据</strong>（RxD, Receive Data）；</li><li>针脚3负责<strong>发送数据</strong>（TxD, Transmit Data ）；</li><li>针脚4负责<strong>数据终端就绪</strong>（DTR, Data Terminal Ready）；</li><li>针脚5负责<strong>接地</strong>（GND, Ground）；</li><li>针脚6负责<strong>数据准备就绪</strong>（DSR, Data Set Ready），当DCE启动时，在经过自身检测后，用DSR来声明已经准备就绪。因此它既是DCE的输出，同时也是DTE的输入，该信号低电平有效。</li><li>针脚7负责<strong>发送请求</strong>（RTS, Require To Send），为输出信号，用于指示本设备准备好可接收数据，低电平有效，低电平说明本设备可以接收数据。</li><li>针脚8负责<strong>发送允许</strong>（CTS, Clear To Send），为输入信号，用于判断是否可以向对方发送数据，低电平有效，低电平说明本设备可以向对方发送数据。</li><li>针脚9负责<strong>振铃指示</strong>（RI, Ring Indicator）</li></ul><hr><h1 id="规程特性">规程特性</h1><ol><li><p>双方通信前，需确认对方是否准备好</p><ul><li>DTR、DSR：=1分别标明DTE和DCE准备好</li></ul></li><li><p>DCE随时可向DTE发送数据</p></li><li><p>DTE要发送数据时，需要经过以下步骤</p><ul><li>RTS = 1：DTE向DCE请求发送数据</li></ul><ul><li>CTS = 1：DCE告诉DTE可以发送数据</li><li>DTE发送数据</li></ul></li></ol><p>双方通信前，需确认对方是否准备好，此时不一定有数据传送进来，只是提前沟通各自的状态。如下图。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222444702.png" alt="准备阶段"></p><p>下图为二者发送数据时通过请求要求对方做好准备。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222501139.png" alt="请求阶段"></p><p>下图为发送阶段示意图。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222524856.png" alt="发送阶段"></p><hr><h1 id="注意">注意</h1><p>需要注意的是绝大多数接口是有方向的，因此要实现DTE间和DCE间的连接需要改动电缆中的线路才能实现。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222543193.png" alt="接口连接"></p><p>另外是DCD、RI是 <span class="bubble-content">拨号</span><span class="bubble-notation"><span class="bubble-item" style="background-color: #DA70D6;"> 20世纪90年代，刚有互联网的时候，实现上网最为普遍的一种方式是拨号上网。只要用户拥有一台个人电脑、一个外置或内置的调制解调器（Modem）和一根电话线，再向本地ISP供应商申请自己的账号，或购买上网卡，拥有自己的用户名和密码后，然后通过拨打ISP的接入号连接到Internet上。</span></span> 调制解调器专用信号。</p><hr><h1 id="细嗦-4">细嗦</h1><h2 id="dce&dte">DCE & DTE</h2><p>数据通信设备（Data Circuit-termination Equipment,DCE）：它提供了到网络的一条物理连接来转发业务量，并且提供了一个用于同步DCE设备和DTE设备之间数据传输的时钟信号。调制解调器（MODEM）和某些交换机串口都是DCE设备的例子。</p><p>数据终端设备（Data Terminal Equipment,DTE）：它能够作为信源、信宿或同时为二者。数据终端设备通过数据通信设备（例如，调制解调器）连接到一个数据网络上，并且通常使用数据通信设备产生的时钟信号。数据终端设备包括计算机、串口打印机等设备。</p><p>因此，从一方面看，DCE负责在传输介质或网络上收发比特；在另一方面看，DCE必须与DTE相互交互。</p>]]></content>
      
      
      <categories>
          
          <category> 刨根问底 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计算机通信网 </tag>
            
            <tag> 微嵌 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OFDM技术（1）—— 码元与比特的概念</title>
      <link href="/2016264a/"/>
      <url>/2016264a/</url>
      
        <content type="html"><![CDATA[<p><em>最近无论是学5G技术还是计通网课程都有提到码元这一概念，于是就做了点研究。</em></p><hr><h1 id="码元基本概念">码元基本概念</h1><p><strong>码元</strong>的官方解释为：在数字通信中常常用时间间隔相同的符号来表示一个二进制数字，这样的时间间隔内的信号称为（二进制）码元。</p><p>通俗来讲，一个脉冲信号所携带的信息就是一个码元，一个脉冲信号（码元）可以携带1bit、2bit或4bit等的数据，当由0或1组成的比特流转换成模拟信号，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>A</mi><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>f</mi><mi>t</mi><mo>+</mo><mi>φ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s(t) = A\cos (2\pi f t + \varphi  )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">φ</span><span class="mclose">)</span></span></span></span> 时，我们可以利用正弦波的幅度、频率或相位将比特流信息搬移到信道频带上。</p><p><img src="https://s2.loli.net/2022/02/25/GgiBv4kItS68Hdw.png" alt="可调信号类型"></p><p>上图的三种信号中，一个码元只携带1bit数据，非0即1，此时为二进制调制，离散取值数量为2，且<strong>波特率</strong>等于<strong>比特率</strong>。<br>其中，波特率又称码元率，是指每秒传输码元的数目，单位波特(Band)；比特率为每秒传输的比特数。</p><p>由此可得波特率和比特率的关系：<br>若码元的离散取值数目是L，波特率是B，比特率为C，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mi>B</mi><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>L</mi></mrow><annotation encoding="application/x-tex">C = B\log_{2}{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9386em;vertical-align:-0.2441em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">L</span></span></span></span></span> 。</p><p>当一个码元携带多bit数据时，可以用多进制调制或联合调制（即调节多个参数）。</p><hr><h1 id="码间串扰">码间串扰</h1><h2 id="什么是码间串扰">什么是码间串扰</h2><p>码间串扰指信号的前一个码元产生拖尾，使得其后端部分与后一码元杂糅，从而影响抽样判决的准确性。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230914542.png" alt="码间串扰示意图"></p><p>那么为什么会产生拖尾呢？有两个常见的原因：带限信道和多径效应。</p><h2 id="带限信道引起的码间串扰">带限信道引起的码间串扰</h2><p>我们以矩形脉冲信号为例。</p><p>在信号脉冲成型时双极性矩形波很常见，生成理想的矩形波，需要使用矩形脉冲信号。 但是，矩形脉冲信号在频域上是sinc函数覆盖整个频域轴，即带宽B 无限大。但是实际可供信号通过的信道带宽是有限的，因此会使信号频域带减小，相应的时域上信号就会变宽,从而产生拖尾。</p><p><img src="https://cdn.jsdelivr.net/gh/asa-pic/pic_1/img/P8yzutkZ37GdYQX.gif" alt="码间串扰示意图"></p><h2 id="多径效应引起的码间串扰">多径效应引起的码间串扰</h2><p>多径效应（multipath effect）：指电波传播除了直射波和地面反射波之外，在传播过程中还会有各种障碍物所引起的散射波，这些波经不同路径传播后，各分量场到达接收端时间不同，第一个多径分量到达的时刻和最后一个多径分量到达的时刻，这之间存在一个时间差。</p><p>当这个时间差超过了一个码元的宽度之后，就意味着，上一个码元的一部分多径分量，在这个码元本应该传输完毕的时候，还没有到达接收点，而是混在了下一个码元的多径分量中到达的接收点，从而对下一个码元产生了干扰——叠加的时候不仅有自己的分量，还有别人的分量。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230954616.png" alt="image-20220719213053825"></p><h2 id="码间串扰的解决">码间串扰的解决</h2><p>码间干扰是数字通信系统中除噪声干扰之外最主要的干扰，它与加性的噪声干扰不同，是一种乘性的干扰。</p><div class="note blue icon modern"><p>那么如何消除码间干扰呢，这就要请到这一系列的主角了——<strong>OFDM技术</strong>，下一篇博客见。</p></div><hr><h1 id="参考资料-6">参考资料</h1><ul><li>遥遥. <a href="https://www.zhihu.com/question/280404107">怎样形象理解码元？</a>. [2020-01-06]</li><li>青铜葵花IC. <a href="https://blog.csdn.net/ILoveTheWorldSo/article/details/99673715?spm=1001.2101.3001.6650.11&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-11.pc_relevant_antiscanv2&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-11.pc_relevant_antiscanv2&amp;utm_relevant_index=14">什么是码间串扰</a>. [ 2019-08-16]</li><li>凝望，划过星空.scut. <a href="https://blog.csdn.net/weixin_44586473/article/details/104372110?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.pc_relevant_default&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=3">深入理解奈奎斯特第一准则与码间串扰</a>. [2020-02-18]</li></ul>]]></content>
      
      
      <categories>
          
          <category> 5G技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 5G </tag>
            
            <tag> 学习笔记 </tag>
            
            <tag> 大学生竞赛 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>物理层概述</title>
      <link href="/f55d2ac4/"/>
      <url>/f55d2ac4/</url>
      
        <content type="html"><![CDATA[<h2 id="帧结构">帧结构</h2><p>5G帧结构5G帧结构是时间维度上对资源进行划分和使用，博主理解就是对时域的一个量度以便于量化。具体相关概念可以戳 这篇博客 中的“子载波相关概念”。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232150529.png" alt="5G帧结构"></p><p>在5G系统中，子载波配置<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span>一共有5中取值，对应的子载波间隔为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>μ</mi></msup><mo>×</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">2^{\mu } \times 15</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">μ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">15</span></span></span></span>（kHz），对于常规循环前缀，每个时隙由14个OFDM（正交频分复用）符号构成；对于扩展循环前缀，每个时隙由12个符号构成，且仅有60kHz子载波（即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span> = 2）时可以配置扩展循环前缀。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232205606.png" alt="三者关系"></p><blockquote><p>在5G中，符号是最小可分配传输方向的时间单位，有上下行之分，还可以为flexible，每个时隙最多两个转换点，采用半静态无线资源控制（RRC）和动态下行控制信息（DCI）两种配置</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230118201850158.png" alt="image-20230118201850158"></p><p><img src="https://image.asa-world.cn/pic/image-20230118202039907.png" alt="image-20230118202039907"></p><h2 id="物理信道和信号">物理信道和信号</h2><p><img src="https://image.asa-world.cn/pic/image-20230120161527916.png" alt="image-20230120161527916"></p><blockquote><p><a href="https://zhuanlan.zhihu.com/p/401875663">https://zhuanlan.zhihu.com/p/401875663</a></p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230120181825972.png" alt="image-20230120181825972"></p><blockquote><p>信道频点相当于绝对频点号的标识，二者存在唯一的映射关系</p></blockquote><h2 id="小区搜索">小区搜索</h2><p><img src="https://image.asa-world.cn/pic/image-20230120203850700.png" alt="image-20230120203850700"></p><blockquote><p>终端开机需要同步和获取系统信息，系统信息由MIB和SIB构成</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230120174651815.png" alt="image-20230120174651815"></p><p><img src="https://image.asa-world.cn/pic/image-20230120174744328.png" alt="image-20230120174744328"></p><blockquote><p><img src="https://image.asa-world.cn/pic/image-20230120193406165.png" alt="image-20230120193406165"></p></blockquote><h3 id="SSB的位置">SSB的位置</h3><p><img src="https://image.asa-world.cn/pic/image-20230120194153600.png" alt="image-20230120194153600"></p><p>频域位置</p><p><img src="https://image.asa-world.cn/pic/image-20230120194720777.png" alt="image-20230120194720777"></p><p><img src="https://image.asa-world.cn/pic/image-20230120194658858.png" alt="image-20230120194658858"></p><p><img src="https://image.asa-world.cn/pic/image-20230120200226903.png" alt="image-20230120200226903"></p><p>时域位置</p><p><img src="https://image.asa-world.cn/pic/image-20230120201114308.png" alt="image-20230120201114308"></p><blockquote><p>一个burst是一个时隙内的SSB，一般有两个SSB</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230120200749721.png" alt="image-20230120200749721"></p><blockquote><p>L指一个SSB brust set中的最大SSB个数，SSB Index标识是哪个SSB，每个SSB对应一个波束</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230120201811222.png" alt="image-20230120201811222"></p><p><img src="https://image.asa-world.cn/pic/image-20230120202000693.png" alt="image-20230120202000693"></p><h3 id="DMRS">DMRS</h3><p>获得PCI即可确定DMRS（PBCH的解调信号），用来解调PBCH和获得SSB Index信息</p><p><img src="https://image.asa-world.cn/pic/image-20230120202714260.png" alt="image-20230120202714260"></p><h2 id="系统消息">系统消息</h2><blockquote><p><a href="https://www.yyearth.com/index.php?aid=275">https://www.yyearth.com/index.php?aid=275</a></p></blockquote><h2 id="小区选择">小区选择</h2><p><img src="https://image.asa-world.cn/pic/image-20230120223442336.png" alt="image-20230120223442336"></p><blockquote><p>Srxlev为电平判据</p><p>Pemax1系统规定的最大发射功率，Ppowerclass是终端实际的发射功率</p><p>若无超时无合适小区，终端可自行决定将Qoffsettemp设为零</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230120223505474.png" alt="image-20230120223505474"></p><h2 id="小区重选">小区重选</h2><p><img src="https://image.asa-world.cn/pic/image-20230120225000832.png" alt="image-20230120225000832"></p><blockquote><p>取值越高优先级越高，注意频点是SSB的频点，不是业务信道的</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230120230345562.png" alt="image-20230120230345562"></p><p><img src="https://image.asa-world.cn/pic/image-20230120225310365.png" alt="image-20230120225310365"></p><blockquote><p>启测：质量低于门限时开始测量，鼓励往高优先级切换</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230120225650896.png" alt="image-20230120225650896"></p><p><img src="https://image.asa-world.cn/pic/image-20230120225829363.png" alt="image-20230120225829363"></p><p><img src="https://image.asa-world.cn/pic/image-20230120230016508.png" alt="image-20230120230016508"></p><blockquote><p>高和低优先级的准则为S准则，同优先级的是R准则</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230120230938107.png" alt="image-20230120230938107"></p><blockquote><p>正常移动状态不需要缩放，中高速需要</p></blockquote><h2 id="随机接入">随机接入</h2><blockquote><p>小区搜索为下行同步，随机接入为上行同步</p></blockquote><h3 id="目的">目的</h3><ul><li><p>获得上行10ms帧的同步，即获得上行发送的提前量TA（就好比一个人，到达车站时，迟到的时间，就是下次要提前出发的时间。）</p><p><img src="https://image.asa-world.cn/pic/20160404143436505" alt="img"></p></li><li><p>获得数据发送授权，申请上行资源，基站需要为终端预留上行发送的视频资源、内存资源等。</p></li></ul><h3 id="基本过程">基本过程</h3><p><img src="https://image.asa-world.cn/pic/image-20230122215207453.png" alt="image-20230122215207453"></p><ul><li><p>Msg1：终端发送前导码</p></li><li><p>Msg2：基站发送TA调整、授权和T-CRNTI（临时CRNTI）</p><p><img src="https://image.asa-world.cn/pic/image-20230122220200593.png" alt="image-20230122220200593"></p><blockquote><p>BI: 终端接收到坏的Msg2，再次发Msg1的间隔</p></blockquote></li><li><p>MSG3：终端发送UE-ID</p></li><li><p>MSG4：基站最终判决，通知特定UE-ID的终端</p></li></ul><blockquote><p>没收到Msg2终端发送功率将“爬坡”</p><p><img src="https://image.asa-world.cn/pic/image-20230122220039310.png" alt="image-20230122220039310"></p></blockquote><h3 id="随机接入信道结构">随机接入信道结构</h3><p><img src="https://image.asa-world.cn/pic/image-20230122161744217.png" alt="image-20230122161744217"></p><p>前导码为Zc序列，主要用于区分不同随机接入请求（不是区分用户，不同用户可能使用相同的前导码），前导码有不同的格式，不同格式可覆盖的小区范围不同，每个小区对应一种前导码格式，每种格式有64个前导码序列</p><ul><li><p>长序列839个子载波，适用小SCS（也更容易频偏，因此有限制集）的，子载波越多意味着基站可以接受到越多的能量，获得更好的解调性能，覆盖半径更大</p><p><img src="https://image.asa-world.cn/pic/image-20230122173323754.png" alt="image-20230122173323754"></p></li></ul><blockquote><p>Tc为4G的基本时间单位，Ts为5G基本时间单位，二者相差64倍（k）</p></blockquote><ul><li><p>短序列为139个子载波，适用于大SCS的，节省时频资源，注意PRACH中不能取4，覆盖半径小</p><p><img src="https://image.asa-world.cn/pic/image-20230122173953477.png" alt="image-20230122173953477"></p></li></ul><p>Guard time：保护间隔决定了小区的最大覆盖半径，考虑到UE先从BS接收PBCH再到UE开始发送preamble，信号在一个来回里面不能干扰到BS下一帧的信号接收，所以小区的最大覆盖半径</p><h3 id="前导序列时域资源">前导序列时域资源</h3><p>终端从SIB1获得PRACH的配置索引</p><p><img src="https://image.asa-world.cn/pic/image-20230122174621797.png" alt="image-20230122174621797"></p><ul><li>FR1即miu = 0 或 1</li><li>SFN为哪个无线帧传PRACH</li><li>一个无线帧有十个子帧，Subframe确定在哪个子帧传PRACH</li><li>协议规定n^RA_slot从哪个时隙传PRACH</li><li>倒数第二列表示一个时隙传几个PRACH</li><li>最后一列表示一个PRACH持续符号数</li></ul><h3 id="前导序列频域资源">前导序列频域资源</h3><p><img src="https://image.asa-world.cn/pic/image-20230122185823729.png" alt="image-20230122185823729"></p><h3 id="RACH信道配置">RACH信道配置</h3><p>因为PRACH信道是全向的，因此基站若要确定终端接收的是哪个波束，RO会与SSB Index存在映射（RO是时频域的分组）</p><p><img src="https://image.asa-world.cn/pic/image-20230122190709581.png" alt="image-20230122190709581"></p><blockquote><p>二者积的最大值即为前导码最大值64</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230122190739610.png" alt="image-20230122190739610"></p><blockquote><p>n表示一个RO上有几个前导序列参与竞争一个SSB，CB表示竞争式随机接入，终端在最好的波束对应的RO前导编码集中随机选择一个编码；非竞争式则由基站直接分配</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230122212924508.png" alt="image-20230122212924508"></p><h2 id="波束管理">波束管理</h2><h3 id="目的-2">目的</h3><p>多振子使波束变窄，通过调相可以控制其方向</p><p><img src="https://image.asa-world.cn/pic/image-20230123131019840.png" alt="image-20230123131019840"></p><p><img src="https://image.asa-world.cn/pic/image-20230123140830422.png" alt="image-20230123140830422"></p><h3 id="过程">过程</h3><p><img src="https://image.asa-world.cn/pic/image-20230123141001432.png" alt="image-20230123141001432"></p><p><img src="https://image.asa-world.cn/pic/image-20230123141040794.png" alt="image-20230123141040794"></p><p><img src="https://image.asa-world.cn/pic/image-20230123141116506.png" alt="image-20230123141116506"></p><blockquote><p>宽波束实现粗对准</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230123141200473.png" alt="image-20230123141200473"></p><blockquote><p>基站得知精准发送波束</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230123141409476.png" alt="image-20230123141409476"></p><blockquote><p>终端得知精准接收波束</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230123141602211.png" alt="image-20230123141602211"></p><h3 id="波束上报（终端给基站）">波束上报（终端给基站）</h3><p><img src="https://image.asa-world.cn/pic/image-20230123141802458.png" alt="image-20230123141802458"></p><h3 id="波束指示（基站给终端）">波束指示（基站给终端）</h3><p><img src="https://image.asa-world.cn/pic/image-20230123141901722.png" alt="image-20230123141901722"></p><h2 id="HARQ处理">HARQ处理</h2><p><img src="https://image.asa-world.cn/pic/image-20230123142828719.png" alt="image-20230123142828719"></p><blockquote><p>异步：终端不知道什么时候重传，需要控制信令</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230123143313511.png" alt="image-20230123143313511"></p><p><img src="https://image.asa-world.cn/pic/image-20230123144510627.png" alt="image-20230123144510627"></p><blockquote><p>K0: 在RRC层的PDSCH时频域资源分配表中配置，有DCI进行指示</p><p>K1：有DCI中的反馈定时指示器字段确定</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230123144611403.png" alt="image-20230123144611403"></p><blockquote><p>K2由DCI获得</p></blockquote><p><img src="https://image.asa-world.cn/pic/image-20230123145122187.png" alt="image-20230123145122187"></p><p><img src="https://image.asa-world.cn/pic/image-20230123145356173.png" alt="image-20230123145356173"></p><h3 id="HARQ处理进程（下行）">HARQ处理进程（下行）</h3><p><img src="https://image.asa-world.cn/pic/image-20230123145713702.png" alt="image-20230123145713702"></p><p><img src="https://image.asa-world.cn/pic/image-20230123145727561.png" alt="image-20230123145727561"></p><h3 id="HARQ处理进程（上行）">HARQ处理进程（上行）</h3><p><img src="https://image.asa-world.cn/pic/image-20230123145753507.png" alt="image-20230123145753507"></p><h3 id="CBG">CBG</h3><p><img src="https://image.asa-world.cn/pic/image-20230123150119106.png" alt="image-20230123150119106"></p><p><img src="https://image.asa-world.cn/pic/image-20230123150133809.png" alt="image-20230123150133809"></p><p><img src="https://image.asa-world.cn/pic/image-20230123150315102.png" alt="image-20230123150315102"></p>]]></content>
      
      
      <categories>
          
          <category> 5G技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 5G </tag>
            
            <tag> 学习笔记 </tag>
            
            <tag> 大学生竞赛 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Twikoo部署心得</title>
      <link href="/8289185f/"/>
      <url>/8289185f/</url>
      
        <content type="html"><![CDATA[<p>评论系统比较目前评论系统有很多，各有各的特点，最常见的如valine、gitalk、Livere(来必力)、twikoo等。</p><ul><li>valine简洁、高速，但提醒功能不完善；</li><li>gitalk只支持github登录，国内API不稳定；</li><li>Livere来自韩国，管理功能强大，支持很多社交账号登录，但是网速较慢；</li><li>twikoo比较简洁，可免费使用，支持邮箱甚至微信提醒，但需实名认证。</li></ul><p>我之前用过一段时间的valine,之所以我选择使用twikoo，因为我比较喜欢twikoo的自动补全邮箱和头像的功能，给评论者带来很多方便。</p><hr><h1 id="twikoo部署">twikoo部署</h1><p>twikoo是基于腾讯云开发的一个简洁、安全、免费的静态博客评论系统。详细部署细节可参考<a href="https://twikoo.js.org/quick-start.html#%E4%BA%91%E5%87%BD%E6%95%B0%E9%83%A8%E7%BD%B2">官方文档</a> 中的“手动部署”。</p><hr><h1 id="部署心得">部署心得</h1><p>本篇文章主要讲述我在部署twikoo的一些技巧。</p><h2 id="免费资源入口（已失效）">免费资源入口（已失效）</h2><p>twikoo宣称自己是一个永久免费的系统，话虽如此，其官方文档所指引的腾讯云开发CloudBase无论是包年包月套餐还是按量计费资源包均无免费体验内容，难道twikoo的“免费”要打引号，难道白嫖党只能停步于此了吗？</p><p>经过博主一个小时的苦苦寻找，终于找到了云开发CloudBase的免费体验版，快点<a href="https://cloud.tencent.com/act/free">这里</a> ，找到云开发CloudBase，点击0元试用即可！</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225139828.png" alt="找到云开发CloudBase，点击“0元试用”"></p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225223177.png" alt="点击“新建环境”"></p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225239249.png" alt="选择空模板，点击“下一步”"></p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225302180.png" alt="依次选择“上海”、“包年包月”、“免费版”，“环境名称”不限，点击“下一步”"></p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225318356.png" alt="点击“立即购买即可”"></p><p>其他步骤请参考<a href="https://twikoo.js.org/quick-start.html#%E4%BA%91%E5%87%BD%E6%95%B0%E9%83%A8%E7%BD%B2">官方文档</a> 中的“手动部署”。</p><h2 id="正确添加域名">正确添加域名</h2><p>博主添加域名时输入 “<a href="https://asa-world.github.io/">https://asa-world.github.io/</a> ” 后发现报错。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225337569.png" alt="报错详情"></p><p>一开始以为需要再申请一个万维网的域名，转念一想这也太麻烦了吧，进入官方群询问大佬后发现原来真的只是“格式错误”！</p><p>正确做法为输入“<a href="http://asa-world.github.io">asa-world.github.io</a>”即可。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103225350352.png" alt="正确输入域名"></p><p><del>被自己蠢到</del></p><h2 id="twikoo美化">twikoo美化</h2><p>原始的twikoo评论界面太过简约，而且评论框有亿点小，于是博主开始美化twikoo。</p><p>前端知识入门后，美化不是很难，博主使用的是外部样式表引入的方式。只需要在.\themes\butterfly\source\css目录下新建css文件，输入下面的代码可实现博主自用的美化方案：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><span class="line">2</span><span class="line">3</span><span class="line">4</span><span class="line">5</span><span class="line">6</span><span class="line">7</span><span class="line">8</span><span class="line">9</span><span class="line">10</span><span class="line">11</span><span class="line">12</span><span class="line">13</span><span class="line">14</span><span class="line">15</span><span class="line">16</span><span class="line">17</span><span class="line">18</span><span class="line">19</span><span class="line">20</span></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Twikoo评论框高度设置 */</span></span><span class="line"><span class="selector-class">.el-textarea__inner</span> &#123;</span><span class="line">    <span class="attribute">min-height</span>: <span class="number">210px</span> <span class="meta">!important</span>;</span><span class="line">  &#125;</span><span class="line">  </span><span class="line"><span class="comment">/* Twikoo评论框添加背景图*/</span></span><span class="line"><span class="selector-class">.el-textarea</span> &#123;</span><span class="line"><span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">https://s2.loli.net/2022/02/06/gy6AcWI4MTjrNVx.gif</span>);</span><span class="line"><span class="attribute">background-size</span>: contain;</span><span class="line"><span class="attribute">background-repeat</span>: no-repeat;</span><span class="line"><span class="attribute">background-position</span>: right;</span><span class="line"><span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>);</span><span class="line"><span class="attribute">resize</span>: vertical</span><span class="line">&#125;</span><span class="line"></span><span class="line"><span class="comment">/* Twikoo评论框背景图实现点击下移*/</span></span><span class="line"><span class="selector-class">.el-textarea</span><span class="selector-pseudo">:focus</span>-within &#123;</span><span class="line"><span class="attribute">background-position</span>-y: <span class="number">800px</span>;</span><span class="line"><span class="attribute">transition</span>: all <span class="number">0.2s</span> ease-in-out <span class="number">0s</span>;</span><span class="line">&#125;</span></pre></td></tr></table></figure><p>保存后，在主题文件中引入即可。</p><p><img src="https://cdn.jsdelivr.net/gh/asa-pic/pic_1/img/dC7fVBLP8JsUYHK.png" alt="引入外部样式表"></p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客搭建 </tag>
            
            <tag> 教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5G基站的开通与调测</title>
      <link href="/51e5371d/"/>
      <url>/51e5371d/</url>
      
        <content type="html"><![CDATA[<h1 id="简述">简述</h1><p>让我们先来理清楚小区的有关概念。 扇区是一个基站下单个天线覆盖的地理区域。可以认为一个天线对应一个扇区，使用单个全向天线的基站只有一个扇区，在一般的宏基站系统中，定向天线的使用最为普遍，使用定向天线的基站一般有三个扇区。每个扇区使用一个或多个无线载波完成无线覆盖。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222748289.png" alt="扇区示意图"></p><p>可以基于载频、扰码的不同在一个扇区下定义多个小区。<strong>小区</strong>是提供终端接入的最小单位，<strong>本地小区</strong>指小区具体实现的物理资源集合（如传输资源、基带资源、射频资源和时钟资源等），<strong>逻辑小区</strong>是小区在无线资源管理的角度的另一个名称，它的建立前提是本地小区正常建立。三者一一对应。</p><p>5G系统开通调测的目标是完成逻辑小区的建立。</p><hr><h1 id="5G基站系统配置">5G基站系统配置</h1><p>SA模式下，5G基站系统通常由EMB6216（BBU）+AU构成。</p><p>对于电信和联通的5G系统配置主要分为以下几种</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222807396.png" alt="S111配置图"></p><ol><li><p>3.5G<a href="#%E5%8D%95%E6%A8%A1%E5%85%89%E7%BA%A4%E4%B8%8E%E5%A4%9A%E6%A8%A1%E5%85%89%E7%BA%A4">单模</a>100M配置(S111)</p><ul><li>每个AAU建立1个100M NR小区（即一个扇区对应一个小区）；</li></ul><ul><li>插1块HBPOF基带板，支持3个100M 64通道NR小区；（关于“通道”的概念可点击<a href="https://xueqiu.com/7282046183/160061589">这里</a> 文章很清晰明白，推荐。）</li><li>支持的64 TR AAU包括：TDAU5164N78-a、TDAU5364N78。</li></ul></li><li><p>3.5G单模100M配置（S111111）</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222823347.png" alt="S111111配置图"></p><ul><li>每个AAU建立1个100M NR小区；</li></ul><ul><li>插2块HBPOF <span class="bubble-content">基带板</span><span class="bubble-notation"><span class="bubble-item" style="background-color: #BDB76B;">基带板主要实现调制信号及解调制信号的处理，如加密解密、电路控制等功能。</span></span>，每块支持3个100M 64通道NR小区。</li></ul></li><li><p>3.5G单模200M配置(S222)</p><ul><li>每个AAU建立2个100M NR小区（即一个扇区对应两个小区）；</li></ul><ul><li>插2块 HBPOF基带板，支持6个100M 64通道NR小区；</li><li>具体连接方式如图，槽位1&amp;5、槽位6&amp;7可以再接2组AAU,最大共支持9个AAU接入；</li><li>针对每个AAU,要支持2*100M的载波聚合，其中AAU1和AAU2是板内载波聚合，AAU3是板间载波聚合。</li></ul><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222855835.png" alt="S222配置图"></p></li></ol><p>对于中国移动，其5G系统配置通常为2.6G的S111配置。</p><hr><h1 id="基站开通调测流程">基站开通调测流程</h1><p>开通准备 -&gt; 开通调测 -&gt; 联调测试</p><blockquote><p>开通准备<br>软硬件准备、上电前检查、连接基站准备</p><p>开通调测<br>配置文件制作、基站版本升级、配置文件下载、开通状态查询</p><p>联调测试<br>NG联调、故障排查、业务验证</p></blockquote><hr><h1 id="细嗦">细嗦</h1><h2 id="单模光纤与多模光纤">单模光纤与多模光纤</h2><p>按光在光纤中的传输模式分为：单模光纤和多模光纤。单模光纤：只能传输一种模式的光；多模光纤：可以传输多种模式的光。<br>二者的主要区别有：</p><ul><li>单模光纤采用固体激光器做光源；多模光纤则采用发光二极管做光源；</li><li>单模光纤传输频带宽、传输距离长，但因其需要激光源，成本较高；而多模光纤传输速度低、距离短，但其成本比较低；</li><li>单模光纤芯径和色散小，仅允许一种模式传输；多模光纤芯径和色散大，允许上百种模式传输。</li></ul><hr><h1 id="参考资料">参考资料</h1><ul><li>者行金. <a href="https://blog.csdn.net/u010378992/article/details/107752084?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_paycolumn_v3&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_paycolumn_v3&amp;utm_relevant_index=2">5G学习之路——认识基站、扇区、小区</a>. [2020-08-02]</li><li>飞畅科技. <a href="http://m.elecfans.com/article/1462054.html">单模光纤和多模光纤是什么，有什么区别</a>. [2021-01-13]</li></ul>]]></content>
      
      
      <categories>
          
          <category> 5G技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 5G </tag>
            
            <tag> 大唐杯 </tag>
            
            <tag> 学习笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>理工男也会写诗，想不到吧</title>
      <link href="/de5b8c0f/"/>
      <url>/de5b8c0f/</url>
      
        <content type="html"><![CDATA[<p><em>今天整理文件的时候突然翻到大一刚入学写的诗歌，当时好像是参加什么诗歌比赛，以银杏为主题（因为电子科大的银杏很有名），本人还是对诗歌比较感兴趣的，诗歌用极短的文字就能描绘一幅幅动人场景，每一篇诗歌就仿佛一部电影，或感人至深，或发人深省。 这首散文诗自我感觉良好hhhhhh，在文末我会给出我的写作思路，当然如果你能认真读一下，其中的故事和逻辑也很容易理解。</em></p><center><blockquote><p><strong>梦</strong></p><p>裹挟秋光，<br>那个女孩抬头仰望，<br>文杏鎏金，树影婆娑，<br>虽初入成电，<br>一切竟如此熟悉。</p><p>还记得小时候，<br>无数个甜甜的睡梦中，<br>漫天黄蝶触风飘摇，<br>岑寂一切繁华与喧嚣，<br>柔软所有烦恼与苦笑。<br>女孩和男孩追逐打闹，<br>乱了头发，<br>也乱了心梢。</p><p>梦<br>也在男孩心里逐渐扎根。</p><p>回望，<br>树依旧缄默，<br>享受着书墨芬芳，<br>守望着长乐未央，<br>看尽人间岁月长。<br>历尽千帆，<br>成电是他的心之所向，<br>也是素履以往。</p><p>那个女孩熟悉而陌生，<br>从双辫到马尾，<br>从活泼到文静，<br>蓦然相视，笑靥浅浅，<br>她伸手拈来一枚银杏叶，<br>道了声：<br>岁月静好，别来无恙。</p></blockquote></center><span class='nota' data-nota='勤奋的男孩和女孩都考入了心仪的大学——电子科大，他们在银杏树下邂逅，虽初次见面，但有种莫名的熟悉。这是因为在童年的梦中他们已是最好的玩伴。“梦”一语双关，既是小时候的梦，也是两人的人生梦想。（不过反复读来，感觉诗中缺乏两人素未谋面的描写，有种两人小时候既在梦中相识，在现实中也是好友的感觉，欢迎斧正）'>写作思路</span><style>#article-container > center > blockquote {font-size:1.2em;}</style>]]></content>
      
      
      <categories>
          
          <category> 广开门路 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 研究报告 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于苹果电脑发展的案例分析</title>
      <link href="/dc8e6bf2/"/>
      <url>/dc8e6bf2/</url>
      
        <content type="html"><![CDATA[<h1 id="摘要">摘要</h1><p><strong>本文简要分析苹果电脑的发展，并从中探寻其成功的原因。</strong> 从乔布斯决心要搞个人电脑开始，到一手创办苹果公司，看似势如破竹，但也不乏心酸和坎坷，比如第一款提供图形化用户接口（GUI）的商用电脑Lisa电脑因其兼容性差，价格昂贵而夭折。 但是苹果电脑在技术和外形设计方面的创新能力以及可靠的产品品质，是很多人无法实现的。在30多年的发展和进化中，苹果重新定义了技术创新的内涵，并在结合内、外部研发力量的同时，将技术创新与设计创新、营销创新、模式创新等创新方式有效结合起来，确保技术研发的高效性。</p><p>与此同时，苹果电脑继承了苹果公司“酷”的风格，并重新定义“酷”，引领“酷”的潮流。苹果公司利用设计增加独一无二的人类感觉，让技术产品更通人性，让人们面对的不再是惹人生气的冰冷机器，而是生动有趣的“小精灵”。这种<strong>以人为本</strong>的设计理念是苹果电脑一直处于不败之地的重要原因。</p><h1 id="苹果电脑的发展分析">苹果电脑的发展分析</h1><h2 id="专注一点，厚积薄发——苹果公司的创立">专注一点，厚积薄发——苹果公司的创立</h2><p>1975年初，美国著名的科技杂志——《大众电子学》刊登一条醒目的新闻：世界上第一台被称为“<strong>牛郎星</strong>”的个人计算机诞生了。这就对于科技迷来说是件轰动的大事，20岁的史蒂夫·乔布斯（Steve Jobs）心中的热情也被点燃。</p><p>乔布斯天生喜欢挑战，个性叛逆以及固执促使他很快着手研究个人计算机事业。</p><p>但是，研制计算机需要很多工具以及组件，此时乔布斯打起了惠普的主意。经过耐心说服，惠普公司实验室主管竟同意将一块被改造过得芯片借给乔布斯使用。于是乔布斯与助手们开始全身心的投入到研发工作中去。他们在计算机上连接了电视机，并且还使用了一个黑色键盘作为数据输入使用。当时，乔布斯根本没有意识到这样的举动会对此后个人计算机的定型产生了多么深远的影响。</p><p>1976年，乔布斯成功说服史蒂芬·沃兹涅克（Stephen Wozniak）装配机器之余跟他去推销，他们另一位朋友，罗·韦恩（Ron Wayne）也加入，三人在1976年4月1日组成了<strong>苹果电脑公司</strong>（Apple Computer Inc.）。</p><p>同年5月，乔布斯与一间本地电脑商店The Byte Shop洽商，店主保罗·泰瑞尔（Paul Terrell）同意订购50部后来被称为Apple I的设备，并在交货时支付每部500美元。乔布斯取得了这份订单后，出售自己贵重物品进行筹款，并且说服大型电子零件分销商Cramer Electronics店铺信用部经理，先给零件后付款，最终乔布斯成功地完成了这笔交易。亨利-福特组织总裁帕特里夏·莫拉迪安(Patricia Mooradian)发表声明称：“Apple-I不仅具有创新意义，而且还是为数字革命奠基的重要人工制品。”</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222925825.png" alt="apple I图 需连接电视机做为显示器"></p><h2 id="历史只会铭记成功者——Lisa的问世与退场">历史只会铭记成功者——Lisa的问世与退场</h2><p>Lisa电脑的研发早在1978年秋天就已经开始，乔布斯集中精力想开发出一款新的电脑，取代老化的apple II。Lisa电脑的研发并不顺利，但突破众多。只花了<strong>三年</strong>时间（苹果电脑公司的说法是投入200人的多年努力）和5000万美元的投资，苹果公司就推出了Lisa PC机。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103222946282.png" alt="apple Lisa图"></p><p>在硬件部分，Lisa使用一个按键的鼠标和12英寸的黑白显示屏。虽然，以今天的标准来看，Lisa非常丑，就像是一台电视机和一台烤箱的不快乐婚姻的产物，但它却远比当时市场上长相最佳的电脑性能优越。</p><p>不过，真正的创新在于软件方面，Lisa是第一款提供<strong>图形化用户接口</strong>（GUI）的商用电脑，它的特色包括下拉菜单、可视窗口、滚动条功能、垃圾箱、剪贴簿、整合的应用程序（包括电子表格应用程序、文字处理、绘图应用程序等）。</p><div class="note blue icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>Lisa几乎什么都具备了，那它少了什么？</p></div><p>首先，Lisa与其他机器<strong>没有兼容性</strong>，这造成了一个明显的问题：有多少趋避风险的商业人士会舍弃IBM而选择苹果呢？更糟的是，Lisa的心脏——摩托罗拉68000处理器——根本无法胜任处理的GUI导向信息的所有工作；最后，也是最重要的，Lisa的<strong>价格并不低</strong>，它的市场价高达9995美元，这使得苹果电脑公司必须雇佣专门的销售团队进行推销。但是，市场上不断谣传苹果公司很快就会推出和Lisa相似但售价只有一半的新款电脑，这使得电脑销售团的工作非常艰难。</p><p>商场如战场，苹果公司最终在1985年4月把Lisa撤出市场，将近一年半内只销售了约8万台。事实上，如若不是失败的定价策略、累赘卡慢的系统和惨淡的销量，现在被众人所铭记的很有可能就是 Lisa 了。</p><h2 id="开放包容，与对手握手——iMac的辉煌">开放包容，与对手握手——iMac的辉煌</h2><p>20世纪90年代世界范围内兴起互联网浪潮，在乔布斯看来，这是一场史无前例的变革，这既是苹果公司的一次机遇，同时也是一次挑战。而乔布斯也意识到苹果不能像以前那样故步自封了。</p><p>为了能够将 iMac 打造成具有竞争力的产品，乔布斯采用了大胆的举措——他破天荒地在 iMac 上使用了竞争对手微软的软件。他知道苹果公司没有赢得用户的原因是因为可供使用的软件不多，从而让用户得不到满足而选择放弃了苹果。无疑，当 iMac 装上这些令用户得心应手的软件后，用户就不用担心 iMac 在使用使用上带来的不便了。</p><p>另外，乔布斯还亲自带领设计团队到美国的一些生产糖果的工厂里去找灵感，虚心地向糖果工人请教如何让糖果看上去更让顾客喜爱。凭借在糖果工厂里面得到的经验，iMac 的外观被设计成通体圆润、色泽明亮透明，而且将传统意义上的显示器与主机结合在一起，不仅体积变轻了，而且让用户感觉更舒服了。</p><p>可以说，iMac 的出现完全融合了乔布斯的设计理念。在这种情况下，iMac一经推向市场便大受欢迎——短短一个月的时间内就卖掉了20多万台，一年时间内卖出的数量更是高达200万台。在强手如林、竞争日益激烈的情况下，苹果的表现着实让人钦佩不已。</p><h1 id="苹果电脑的成功原因分析">苹果电脑的成功原因分析</h1><h2 id="技术革新焕发魅力">技术革新焕发魅力</h2><p><strong>技术创新</strong>是苹果产品生产中的一个关键环节，从诞生之日起，它就存在于苹果公司的血液之中。在30多年的发展和进化中，苹果重新定义了技术创新的内涵，并在结合内、外部研发力量的同时，将技术创新与设计创新、营销创新、模式创新等创新方式有效结合起来，确保技术研发的高效性。</p><p>当多数企业选择委外研发的方式来降低研发成本、增进组织效率时，苹果却往反方向前进——努力控制产品被创造的过程，将自行研发作为打造其产品竞争力的关键。这对当下环境仍有借鉴意义，显然，只有自研，掌握核心科技，才不会被别人“卡脖子”，才能在当下竞争市场下留有不败之地。</p><h2 id="保持“酷”-定义“酷”">保持“酷” , 定义“酷”</h2><p>思考一下，苹果电脑卖的究竟是什么呢？除了它的无穷创新外，苹果卖的更是一个“<strong>酷</strong>”字。</p><p>然而回看苹果公司的历史，在沃兹尼克和apple I和apple II时代，苹果卖的更是一种“亲切”。产品本身——使用简便、个人化、色彩鲜艳、没有生硬的棱角，跟IBM冷酷的公司味道恰好相反。苹果商标就凸显了这一点：这时，苹果的“酷”是嬉皮的“酷”——拒绝主流价值观，它最早的广告好玩、轻松、反传统。在演变过程中的某个时段，苹果改变了，它抛掉了嬉皮和其他反主流文化的根基。它舍弃了彩虹色的商标，改用更雅致、更酷的苹果。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103223012095.png" alt="图左为改版前的图标，图右为改版后的图标"></p><div class="note blue icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>是什么促使苹果改变呢？</p></div><p>最简单的答案是：苹果长大了。苹果终究还是看出，为了成长或是为了生存，它必须做出改变。停留在最初的花盆里就没有茁长成长的空间。</p><p>另一个答案是：苹果变得不像沃兹尼克了，它更像乔布斯了。沃兹尼克是个亲切、惹人喜爱的人，而乔布斯是出了名的冷酷，会令人同他无话可说。</p><blockquote><p>说到乔布斯的冷酷，插播个乔布斯小故事。<br>乔布斯的母亲23岁遗弃了他，而乔布斯在23岁时让女友怀孕并选择放弃了自己的女儿，甚至在女友拿着99%的医院血缘证明的情况下，乔布斯依旧不承认是Lisa是自己的女儿，以至于在Lisa童年近10年的时间里乔布斯都对这个小女孩儿的成长不闻不问，可奇怪的是在新一代苹果电脑命名时，他却坚持使用自己不承认的女儿的名字Lisa给新开发的电脑产品命名，非常的匪夷所思。（黑人问号.jpg）</p></blockquote><p>哪么被视为“酷”的好处之一是，你有时可以定义什么是“酷”，让人们会觉得：要是苹果这么做的话，那就代表这是酷的东西。不过坏处是，人们会对你的标准变高，会注视你的一举一动，并思考：这是否符合我们对苹果期望的最高酷标准。任何事情都有两面性，不过苹果真的很少让我们失望。</p><h2 id="以人为本的设计理念">以人为本的设计理念</h2><p>苹果公司会在设计过程中会假设出客户角色，并以此仔细斟酌产品的方方面面，从用户界面的设计，到客户最直接接触产品时的店内零售体验无所不及。更令人惊叹的是，这一理念贯穿苹果公司发展始终：从Lisa的图形化界面，到“火线”（FireWire）配件让不同设备的传输更加便捷，再到iMac的无感体验等等再小的细节，也是以人为本的设计工作中必不可少的一环，因为这些细节决定了产品看起来值一千万美元，还是一文不值。</p><p>苹果公司利用设计增加独一无二的人类感觉，让技术产品更通人性，就像房间里多了一位朋友，而不是一个惹人生气的冰冷机器。技术虽然只是在幕后通过苹果产品发挥着作用，但却给我们留下了通人性的印象。当用鼠标滑动程序界面到最后一页时，如果继续滑动，界面就会稍微移动一下紧接着反弹回来，苹果将这种交互方式称为“橡皮筋动作”。橡皮筋动作在程序设计的角度看起来完全不必要，但这样做却给人愉悦的体验感受。</p><p>苹果公司深刻理解到，人们本能地会把复杂的系统当做生物看待。因为我们在给出评价时，评价的是所有关于产品的综合体验感受，我们期待一个“<strong>友好</strong>”的产品。</p><h1 id="参考资料-8">参考资料</h1><ul><li>郝美丽. 《四巨头：亚马逊、苹果、脸书和谷歌的隐藏基因》翻译报告[D]. 华南理工大学. 2019</li><li>苹果电脑诞生记[J]. 小学科学. 2019(01):34-35</li><li>“改变世界”的激将法[J]. 当代兵团. 2017(02):56</li><li>李鹏.苹果模式的思考[J]. 出版参考. 2013(33):16</li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目报告 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 研究报告 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5G系统的勘察与规划设计</title>
      <link href="/c7fc23e2/"/>
      <url>/c7fc23e2/</url>
      
        <content type="html"><![CDATA[<h1 id="5G建设规划">5G建设规划</h1><p>5G网络建设主要依托现网站址资源，合理利用4G现网的 <span class="bubble-content">MR</span><span class="bubble-notation"><span class="bubble-item" style="background-color: Measurement Report)是4G LTE系统的一项重要功能，报告包括参考信号接收功率、参考信号接收质量、eNB接收干扰功率、eNB天线到达角、UE发射功率余量、上行丢包率、下行丢包率、上行信噪比、PRB粒度eNB接收干扰功率等。基于MR可以进行全网覆盖情况、干扰情况、上行高发射功率、UE位置定位分析，例如可利用MR中eNB接收干扰功率RIP统计分析全网干扰情况，定位高干扰小区。;">测量报告(MR</span></span>、业务统计、测试等多维数据，以提升网规方案的完备度和准确性。5G网络规划的主要流程分为两个阶段，六个环节网络规划工作的输入项包括现网基站信息、网管统计、MR数据、测试数据、投诉和电子地图等；输出网规方案，包括5G站点规模、位置、RF参数、无线参数、性能预测（仿真）结果等。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232316977.png" alt="5G规划基本流程图"></p><h2 id="站点规模估算">站点规模估算</h2><p>容量规划主要根据现场移动用户数、<span class="bubble-content">RRC连接</span><span class="bubble-notation"><span class="bubble-item" style="background-color: #DB7093;">RRC连接是会话建立以及入网的必须步骤，主要是为了建立UE和UTRAN之间的信令连接。</span></span> 用户数、在线激活用户数、上下行用户基础使用体验速率、上下行单载扇多用户吞吐能力等数据。</p><p>站点覆盖能力估算主要是根据边缘速率进行规划，是覆盖比率最差时的用户体验速率。</p><h2 id="仿真设计">仿真设计</h2><p>5G仿真设计内容包括：精细化覆盖预测、RF参数规划、MM广播权值优化调整。</p><p>RF参数规划的目的是5G网络信道质量可以满足不同场景下业务的需求。</p><p>MM广播权值优化：由于5G采用 <span class="bubble-content">波束管理</span><span class="bubble-notation"><span class="bubble-item" style="background-color: #BA55D3;">当使用高频通信时，无线信号的衰减很大，因此需要使用波束赋形技术形成有指向性的波束，以增强该方向上发射信号的功率。波束管理的主要目是为了获取和维护可用于上下行传输/接收的一组最优传输/接收点和UE波束。在5G NR的波束管理过程中，主要执行四种操作：波束扫描、波束测量、波束选择和波束上报。</span></span> ，天线权值设置对网络容量和覆盖效果产生较大影响。所以，在不同场景下对天线权值进行有针对性的选择非常重要。天线权值的概念与广播波束和业务信道的波束息息相关。在网络规划时，重点考虑SSB波束的设置问题。当前SSB的波束选择有多种组合，常见的组合包括：单波束、8波束、1+7波束、2+4波束。上述四种波束的实现都需要不同的天线权值。天线权值使用LMT软件配置到AAU中生效。</p><hr><h1 id="勘察设计">勘察设计</h1><h2 id="基站结构与建设要求">基站结构与建设要求</h2><p>基站主要分为室内的BBU和室内的AAU，二者用光纤连接。与4G不同的是，各元件功率变大，散热需求变大，因此安装环境变高</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232333436.png" alt="基站结构图"></p><blockquote><p>BBU19英寸机柜安装要求:</p><ul><li>大于450mm深度的安装空间，立柱距前]100mm的走线空间；机柜后方至少留有0.6m散热空间；机柜顶部建议有风扇；安装位置不能遮挡BBU进风口和出风口；</li><li>推荐BBU优先安装位置靠机柜下侧；</li><li>单机柜推荐安装1台5GBBU,安装多台推荐使用导风理线架，两个设备间隔1U。不安装导风理线架时，两个设备间距小于 <span class="bubble-content">1U</span><span class="bubble-notation"><span class="bubble-item" style="background-color: #6A5ACD;">U为工控机箱的标准规格高度单位，1u=44MM。</span></span>（防止热风循环进入设备入风口），2个设备不能紧贴；</li><li>如有风路相反设备，BBU应安装在风路相反设备下方，并且两个设备间要留出25U散热空间；</li><li>BBU的高度是3U；BBU在19寸机柜安装时必须使用托盘或托架。</li></ul></blockquote><p>馈线窗进出线缆：GPS馈线、GPS避雷器接地、AAU电源线、BBU-AAU光纤。</p><p>室外天面环境需无明显遮挡，AAU前一百米无明显遮挡。安装AAU时，道杆直径需大于其壁厚。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232345521.png" alt="AAU安装示例图"></p><blockquote><p>冷知识——基站辐射对人体有害吗？<br>从国际上看，我国电磁辐射的辐射标准较许多发达国家还要严格。公众投诉的焦点集中在小区宏基站，担心辐射对人体健康造成影响。事实上通信基站电磁辐射只要低于国家标准限值，对人体健康是没有影响的。环境保护部对单个项目移动通信基站的环评要求更严，仅为国家标准的1/5。基站的辐射微乎其微，不会对人体造成危害。</p></blockquote><p>为了让减少群众焦虑，一般会在AAU外加装美化罩。美化罩也应符合一定标准，如AAU前面罩、左右两侧距美化罩最小50mm。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232400607.png" alt="美化罩安装示例图"></p><h2 id="BBU结构">BBU结构</h2><p>BBU（EMB6216）前面板视图如下图。安装中，0槽位放置5G主控板，1槽位放置4G主控板，5G基带板优先插入2、3槽位，4槽位放置电源模块，8槽位放置风扇单元。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232418062.png" alt="EMB6216前面板视图"></p><p>其主要接口如下图。其中25GE接口连入核心网接口，LMT接口为5G/4G维护接口，IR接口连入AAU，10GE接口为4G回传接口。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232434025.png" alt="EMB6216接口视图"></p><h2 id="AAU接口">AAU接口</h2><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232452422.png" alt="AAU接口视图"></p><h2 id="GPS系统">GPS系统</h2><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232505060.png" alt="GPS系统"></p><p>时钟级联：用时钟级联网线SSI -&gt; SSO。</p><h2 id="勘察流程">勘察流程</h2><p>勘察分为初勘（网络规划现场勘察）和复勘（工程设计现场勘察）。勘察准备：人员准备（网络优化、设计院、运营商、工建等）、信息准备（工程情况、特殊要求、工程任务和范围）、拟定计划、资料收集、车辆准备、工具准备等</p><p>初勘和复勘流程如下。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232518287.png" alt="初勘流程图"></p><p><img src="https://cdn.jsdelivr.net/gh/asa-pic/pic_1/img/yNK85rAbYo7zZpg.jpg" alt="复勘流程图"></p><p>复勘分为三部分：总体情况勘察、机房室内勘察、天面室外勘察。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103232543922.png" alt="室内勘察流程图"></p><p><img src="https://cdn.jsdelivr.net/gh/asa-pic/pic_1/img/6xO7D32fuzSgIGU.jpg" alt="室外勘察流程图"></p><hr><h1 id="参考资料-3">参考资料</h1><ul><li>李东霏. <a href="http://www.ictbaike.com/2021/03/26/%E4%BB%80%E4%B9%88%E6%98%AF5g-nr%E7%9A%84%E6%B3%A2%E6%9D%9F%E7%AE%A1%E7%90%86%EF%BC%9F/">什么是5G NR的波束管理？</a>. [2021-03-26]</li><li>胡郝文. <a href="https://rf.eefocus.com/article/id-335047">5G NR 波束管理和波束优化简介</a>. [2020-12-09]</li><li>中国环境报. <a href="https://nnsa.mee.gov.cn/ztzl/kpcl/201712/t20171201_427295.html">通信基站的辐射会危害健康吗？</a>. [2017-12-01]</li></ul>]]></content>
      
      
      <categories>
          
          <category> 5G技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 5G </tag>
            
            <tag> 学习笔记 </tag>
            
            <tag> 大学生竞赛 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5G频谱划分及应用</title>
      <link href="/1eae6b2/"/>
      <url>/1eae6b2/</url>
      
        <content type="html"><![CDATA[<h1 id="5G工作频段">5G工作频段</h1><p>5G频谱分为两个区域——低频FR1和高频FR2，FR指Frequency Range,即频率范围。根据3GPP的R16版本规范，FR1的频率范围为720MHz到7125MHz；FR2的频率范围为24250MHz到52600MHz,FR2称为毫米波通信。</p><p>具体FR1和FR2的工作频带如下图。其中第一列为频带的编号，第二列为<a href="#%E4%B8%8A%E8%A1%8C%E5%92%8C%E4%B8%8B%E8%A1%8C">上行</a>工作频带，第三列为<a href="#%E4%B8%8A%E8%A1%8C%E5%92%8C%E4%B8%8B%E8%A1%8C">下行</a>工作频带，第四列为<a href="#%E5%8F%8C%E5%B7%A5">双工模式</a>。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230218606.png" alt="FR1工作频段"></p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/Ny2SvfYp9KzndbV.jpg" alt="FR2工作频段"></p><hr><h1 id="基本概念">基本概念</h1><h2 id="信道基本概念">信道基本概念</h2><p>说到信道，其中有很多概念，我们主要辨析以下的名词。</p><p><strong>信道</strong>就是信息传输的通道，它在通信系统中的位置如图。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230328714.png" alt="通信系统基本模型"></p><p><strong>信道带宽</strong>但是不是所有频率的信号都可以通过信道传输，所以我们把可以通过信道传输的信号频率范围大小就是信道带宽</p><p>还有一个比较容易混淆的概念是<strong>信道容量</strong>。信道容量就是指信号在信道上进行无差错传输所能达到的最大传输速率。对于只有单源单宿的单用户信道，它是一个数，单位是比特每秒或比特每信道符号。它代表每秒或每个信道符号能传送的最大信息量，或者说小于这个数的信息率必能在此信道中无错误地传送。由香农公式：</p><center><div class="tip key"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mi>B</mi><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mrow><mo fence="true">(</mo><mrow><mn>1</mn><mo>+</mo><mfrac><mi>S</mi><mi>N</mi></mfrac></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">C=B\log_{2}\left ( {1+\frac{S}{N} } \right )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2223em;vertical-align:-0.35em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><br>其中，C：信道容量，单位bit/s；B：信道带宽，单位Hz；S：信号平均功率，单位W；N：噪声平均功率，单位W}</p></div></center><p>可以看出信道带宽和信道容量的关系。<br>显然我们从公式可以看出：信道容量与信道带宽成正比，同时还取决于系统信噪比以及编码技术种类。</p><p>将信道带宽细分，可以分为<strong>传输带宽</strong>和<strong>保护带宽</strong>。传输带宽是实际有效的传输信息的频率范围。三者的关系如下图。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230345430.png" alt="信道带宽结构"></p><h2 id="子载波基本概念">子载波基本概念</h2><p>子载波可以认为是可独立调制的一小段频域资源,我们把子载波的带宽叫做<strong>子载波间隔</strong>（SCS），与4G LTE网络子载波间隔固定为15kHZ不同，5G新空口（NR）子载波间隔是不固定的。原因是单一的载波配置无法满足5G各种场景的具体需求，应针对不同场景选择不同子载波间隔。</p><blockquote><ul><li>时延场景。子载波间隔越大，对应时隙越短，可以支持实验敏感型业务。</li><li>移动场景。不同的移动速度，产生的 <span class="bubble-content">多普勒频偏</span><span class="bubble-notation"><span class="bubble-item" style="background-color: #87CEFA;">多普勒效应是指发送端和接收端存在相对位置的偏移会产生频率失真即多普勒频移。与LTE系统相类似，如果频率偏移的大小不到子载波间隔的5%，就不会对NR系统产生无法容忍的影响。例如一个使用3.5GHz载频的NR终端的移动速度是350公里/小时，产生的多普勒频移大约是1134Hz。1134Hz是15kHz的7.56%，是30kHz的3.78%，所以对于高铁这样的高速场景，载波间隔也要至少是30kHz。</span></span> 不同。速度越快多普勒频偏越大。因此增大子载波间隔，可以提升系统对频偏的鲁棒性。</li><li>覆盖场景。子载波间隔越小，对应 <span class="bubble-content">循环前缀</span><span class="bubble-notation"><span class="bubble-item" style="background-color: CP)是将OFDM符号尾部的信号复制到头部构成的。这样可以保证有时延的OFDM信号在FFT积分周期内总是具有整倍数周期。CP的长度主要有两种，分别为常规循环前缀（Normal Cyclic Prefix）和扩展循环前缀（Extended Cyclic Prefix）。常规循环前缀长度4.7μs，扩展循环前缀长度16.67μs。循环前缀可以与其他多径分量信息相关联，得到完整的信息。;"> 循环前缀(Cyclic Prefix</span></span>（CP）长度越大，支持的小区覆盖半径也就越大。</li><li>高频应用场景。主要应用于热点区域，子载波间隔越大，越能对抗系统产生的相位噪声。</li><li>大连接场景。子载波间隔越小，子载波数目越多，覆盖范围越广，支持的接入数越多。</li></ul></blockquote><p>另外还涉及到<strong>OFDM符号</strong>的概念，一个OFDM符号的时域表示就是在时域上一次采样的结果；频域上看，一个OFDM符号占据系统带宽下的所有子载波。在5G网络中一个<strong>资源块</strong>（RB）占据一个时隙，为14个OFDM符号，在频域上占12子载波。</p><blockquote><p>e.g.<br>假设系统带宽20MHz，包含100个RB，每一个RB包含12个子载波，一共1200个子载波，子载波叠加起来作为一个时域信号，在一个时隙内做7次采样，得到7个OFDM符号，每一个符号为包含了所有1200个子载波信息。假设15KHz的子载波间隔，传输带宽就是1200*15KHz = 18M，实际上小于20M带宽。那么剩余的2M带宽则分布在两边，起保护作用，即为保护带宽。</p></blockquote><p>FR1和FR2的最大传输带宽如下图。以FR1最大传输带宽配置中“160”为例，它表示当信道带宽为30MHz、子载波间隔为15kHz时，最多能配置160个资源块。<br><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230400370.png" alt="FR1最大传输带宽配置"></p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230516645.png" alt="FR2最大传输带宽配置"></p><p>根据下面的公式即可计算出对应的最小保护带宽。</p><center><div class="tip key"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>最小保护带宽</mtext><mo>=</mo><mrow><mo fence="true">(</mo><mi>C</mi><mi>H</mi><mi>B</mi><mi>W</mi><mtext>（带宽</mtext><mi>M</mi><mi>H</mi><mi>z</mi><mtext>）</mtext><mo>×</mo><mn>1000</mn><mo>−</mo><msub><mi>N</mi><mrow><mi>R</mi><mi>B</mi></mrow></msub><mo>×</mo><mi>S</mi><mi>C</mi><mi>S</mi><mo>×</mo><mn>12</mn><mo fence="true">)</mo></mrow><mi mathvariant="normal">/</mi><mn>2</mn><mo>−</mo><mi>S</mi><mi>C</mi><mi>S</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">最小保护带宽 = \left ( CHBW（带宽MHz）\times 1000 - N_{RB}\times SCS\times 12 \right ) /2- SCS/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">最小保护带宽</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord cjk_fallback">（带宽</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal" style="margin-right:0.04398em;">Hz</span><span class="mord cjk_fallback">）</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1000</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">RB</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">SCS</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">12</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">/2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">SCS</span><span class="mord">/2</span></span></span></span></p></div></center>---<h1 id="国内三大运营商的频谱划分">国内三大运营商的频谱划分</h1><p>中国联通和中国电信获得3.5GHz的国际主流频段；中国移动获得2.6+4.9GHz的组合频段。</p><blockquote><ul><li>中国电信：3400MHz——3500MHz的100MHz</li><li>中国联通：3500MHz——3600MHz的100MHz</li><li>中国移动：2515MHz——2675MHz的160MHz和4800MHz——4900MHz的100MHz</li><li>另外，中国广播电视网络有限公司（中国广电）获得698MHz——790MHz的700MHz的5G牌照</li></ul></blockquote><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230617400.png" alt="国内四大运营商工作频带总体分布情况"></p><hr><h1 id="细嗦-3">细嗦</h1><h2 id="上行和下行">上行和下行</h2><p>简单来讲，上行就是终端给基站发送信息，下行指基站给终端发送信息。</p><p>生活中，我们访问互联网的过程中存在这两种行为：一是上传数据，二是下载数据。上行宽带(速度)指的是上传的速度，而下行宽带(速度)指的是下载数据是的速度。上行宽带(速度)和下行宽带(速度)是不对称的，一般是下行速度大于上行的速度。我们平时所使用的宽带说多少M，都是指的下行宽带，因为我们上网主要是从互联网上下载数据，而上传的数据量要少很多。</p><p>另外，生活中办理的10M的宽带，结果下载速度只有1M/s左右的速度，这是为什么呢?</p><p>这是因为宽带运行商对下行速度的描述和Windows电脑显示的下行速度的单位不一样，Windows电脑的单位是KBbs,而宽带运营商的单位是 Kbbs，1B=8b。那么办理了10M的宽带，10Mbps=10240Kbps/8=1280KBps,所以在电脑上下载数据 时最大的下载速度也就是只有1M/s左右</p><h2 id="双工">双工</h2><p>双工(Duplex)是一种在单一通信信道上实现双向通信的过程，包括两种类型，分别为半双工和全双工。</p><p>在半双工系统中，通信双方使用单一的共享信道轮流发送数据。在一方发送数据时，另一方只能收听。全双工则是指同时的双向通信。通信双方可以在同一时刻收发数据。固定电话和手机的通信采用了这种方式。全双工技术又分为两种：时分双工(TDD)和频分双工(FDD)。</p><p>TDD使用单一频率来进行收发。通过分配不同的时隙，TDD系统可以利用单一频段来进行收发操作。由于数据传输速率很快，因此通信双方很难分辨数据传输是间歇性的。因此，与其使用“同时”一词来描述这种传输，“并发”一词可能更合适。TDD的真正优势在于，系统只需使用频谱的一个信道。此外，没有必要浪费频谱资源设置“安全频段”，或采取信道隔离措施。不过TDD的主要问题在于，系统在发送机和接收机两端需要非常精确的时间同步，以确保时隙不会重叠，产生相互影响。</p><p>FDD要求移动通信系统则需要两个不同的频段或信道。两个信道之间需要有足够的间距来确保收发不会相互干扰。这样的系统必须对信号进行滤波或屏蔽，才能确保信号发送机不会影响邻近的接收机。FDD通常需要更多的频谱资源，一般情况下是TDD的两倍。FDD的另一个缺点在于，很难应用多输入多输出(MIMO)天线技术和波束成形技术，因此大幅提高传输速率困难。</p><hr><h1 id="参考资料-4">参考资料</h1><ul><li>operation_w. <a href="https://blog.csdn.net/weixin_41975471/article/details/106224566">信道带宽、信道容量、香农公式</a>. [ 2020-05-19]</li><li>kkkeep learning. <a href="https://blog.csdn.net/qq_37041791/article/details/118144131">子载波间隔</a>. [2021-06-23]</li><li>水煮肉片煮面. <a href="https://www.douban.com/note/637991056/">一个OFDM符号含义的理解</a>. [2017-09-19]</li><li>软件小刘. <a href="https://zhuanlan.zhihu.com/p/90872436">上行带宽和下行带宽是什么意思，各有什么作用？</a>. [2019-11-08]</li><li>u010698858. <a href="https://blog.csdn.net/u010698858/article/details/43564809">什么是频分双工(FDD)/时分双工(TDD)</a>. [2015-02-06]</li></ul>]]></content>
      
      
      <categories>
          
          <category> 5G技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 5G </tag>
            
            <tag> 学习笔记 </tag>
            
            <tag> 大学生竞赛 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5G网络架构与组网部署</title>
      <link href="/b38434f5/"/>
      <url>/b38434f5/</url>
      
        <content type="html"><![CDATA[<h1 id="蜂窝移动通信系统简介">蜂窝移动通信系统简介</h1><p>美国的贝尔实验室最早在1947年就提出了蜂窝无线移动通信（Cellular Radio Mobile Communication）的概念，1978年完成了芝加哥先进移动电话系统 AMPS（Advanced Mobile Phone System）的试验，并且在1983年正式投入运营。由于微电子学与VLSI技术的发展，促进了蜂窝移动通信的迅速发展。</p><p>早期的移动通信系统采用大区制的强覆盖区，即建立一个无线电台基站，架设很高的天线塔(一般高于 30 m),使用很大的发射功率(一般在 50W-200W)，覆盖范围可以达到 30 km-50 km。大区制的优点是结构简单，不需要交换，但频道数量较少，覆盖范围有限。为了提高覆盖区域的系统容量与充分利用频率资源，人们提出了<strong>小区制</strong>的概念。<br><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230650614.png" alt="蜂窝网络图"><br>如果将一个大区制覆盖的区域划分成多个小区，每个小区(cell)中设立一个基站(BS),通过基站在用户的移动台（MS）之间建立通信。小区覆盖的半径较小，一般为 1km-20 km，因此可以用较小的发射功率实现双向通信。如果每个基站提供一到几个频道，可容纳的移动用户数就可以有几十到几百个。这样，由多个小区构成的通信系统的总容量将大大提高。由若干小区构成的覆盖区叫做区群。由于小区通常呈现<strong>六边形</strong>，区群的结构酷似蜂窝，因此人们将小区制移动通信系统叫做<strong>蜂窝移动通信系统</strong>。在每个小区设立一个（或多个）基站，它与若干个移动站建立无线通信链路。区群中各小区的基站之间可以通过电缆、光缆或微波链路与移动交换中心（MSC)连接。移动交换中心通过PCM电路与市话交换局连接，从而构成了一个完整的蜂窝移动通信的网络结构。</p><h1 id="5G网络架构">5G网络架构</h1><h2 id="5G总体架构">5G总体架构</h2><p>蜂窝通信系统的网络可以划分成<strong>核心网</strong>（CN）和<strong>接入网</strong>（RAN）两部分，核心网主要由基站管理器、<span class="bubble-content">网关</span><span class="bubble-notation"><span class="bubble-item" style="background-color: #8B008B;">网关(Gateway)又称网间连接器、协议转换器。默认网关在网络层以上实现网络互连，是最复杂的网络互连设备，仅用于两个高层协议不同的网络互连。网关的结构也和路由器类似，不同的是互连层。网关既可以用于广域网互连，也可以用于局域网互连。</span></span>、计费系统组成，主要为用户提供<strong>网络接入服务和管理功能</strong>;接入网主要由基站（一种<span class="bubble-content">网元</span><span class="bubble-notation"><span class="bubble-item" style="background-color:SGN;">网元是网络中的基本元素，是网络管理和监视的最小单位，基站就是一种网元，其与网元关系就是苹果与水果的关系，除此之外，网元还有MME</span></span>）组成，为用户提供<strong>无线接入功能</strong>。<br><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230704758.png" alt="5G网络架构图"><br>那么5G系统的总体架构是由5G核心网（5GC）和5G接入网（NG-RAN）构成的。对于非独立组网（NSA）来说，5G接入网的网元有4G增强型基站（ng-eNB）,其可以实现部分5G功能，还有5G基站（gNB）;对于独立组网（SA)来说，接入网网元全部为5G基站，接入网各网元之间由Xn接口完成控制面和用户面的实现，即可传递信令和用户数据。核心网的网元很多，主要有AMF,UPF,SMF等，核心网网元通过NG接口实现与接入网各网元的通信。</p><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230720716.png" alt="4G与5G移动通信系统整体架构对比"></p><p>与4G的网络架构对比，4G中接入网的基带处理单元（<a href="#bbu%E4%B8%8Erru">BBU</a>）分离成为5G接入网的集中单元（CU）和分布单元（DU）,这两个模块既可以合设也可将多个DU挂载到CU上，这样便于基站间的协同管理和集中处理；4G中的射频拉远模块（<a href="#BBU%E4%B8%8ERRU">RRU</a>）和天线重构成为5G中的有源天线单元（AAU），利于5G中大规模天线场景的实现。也可看到，5G核心网的功能可下放到多接入边缘计算单元（MEC），使其靠近接入网基站，便于时延的减小控制。</p><h2 id="5G核心网架构">5G核心网架构</h2><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230738409.png" alt="5G核心网架构"><br>5G核心网通过以下技术的应用，完全实现了控制与用户面的分离（CUPS)。</p><blockquote><p>NFV技术 -&gt; 灵活重构网络功能<br>SDN技术 -&gt; 灵活构建数据转发通道<br>切片技术 -&gt; 业务保障与资源利用率最大化</p></blockquote><h2 id="5G主要网元功能">5G主要网元功能</h2><ul><li><p><strong>用户面功能（UPF）</strong></p><blockquote><ul><li>用于 <span class="bubble-content">RAT</span><span class="bubble-notation"><span class="bubble-item" style="background-color: #778899;">RAT适用于无线通信网络的基础物理连接方法。现代手机可以在一个设备中支持多种无线接入技术（RAT），例如蓝牙、Wi-Fi、 NFC（近场通信）以及 3G、4G 或 LTE 和 5G。</span></span> 内/ RAT间移动性的锚点（适用时）。支持将用户业务铆钉在某一核心网锚点（anchor）（即用户从不同接入系统接入时，用户的业务数据流都从某个CN网元出去。当用户在不同接入系统之间移动时，可以保证该网元分配的用户地址保持不变），以支持计费和其他业务需求。</li><li>连接到移动通信网络的外部PDU会话点。关于什么是PDU会话，可参考这篇<a href="https://blog.csdn.net/CodeSavior/article/details/115978251">博客</a>，讲解的很详细，推荐。</li><li>数据包路由及转发。</li></ul></blockquote></li><li><p><strong>会话管理功能（SMF）</strong></p><blockquote><ul><li><p>会话建立修改和删除。（注意：在5G网络中建立PDU会话只能由终端发起，但这并不意味着终端不发起会话外部数据就无法发送给终端，在这种情况下网络会对终端进行寻呼，终端接收到寻呼进行响应，再申请PDU会话的建立即可。）</p></li><li><p>终端IP地址的分配和管理。因为PDU会话的建立是基于IP化的。</p></li><li><p>选择控制UPF。</p></li></ul></blockquote></li><li><p><strong>访问和移动性管理功能（AMF）</strong></p><blockquote><ul><li>非接入层（NAS）信令和信令的加密与完整性保护，以及 <span class="bubble-content">用户鉴权</span><span class="bubble-notation"><span class="bubble-item" style="background-color: #ADD8E6;">一种用于在通信网络中对试图访问来自服务提供商的服务的用户进行鉴权的方法。用于用户登陆到DSMP或使用数据业务时，业务网关或Portal发送此消息到DSMP，对该用户使用数据业务的合法性和有效性（状态是否为激活）进行检查。</span></span> 和秘钥管理。</li><li>初始接入使得注册与连接管理。</li><li>NAS的移动性管理。</li><li>作为终端与SMF连接的桥梁，进行消息的透传。</li></ul></blockquote></li><li><p><strong>控制面的集中单元（CU-C）</strong></p><blockquote><ul><li>接口管理。</li><li>连接管理：单连接、双连接、多连接和D2D。</li><li>负载均衡和切片资源动态管理。</li></ul></blockquote></li><li><p><strong>用户面的集中单元（CU-U）</strong></p><blockquote><p>数据包处理和转换。</p></blockquote></li><li><p><strong>分布单元（DU）</strong></p><blockquote><p>mac层的资源调度、模式转换和信道映射。</p></blockquote></li><li><p><strong>有源天线单元（AAU）</strong></p><blockquote><p>信号收发等。</p></blockquote></li></ul><h2 id="网元间的接口">网元间的接口</h2><p><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230811393.png" alt="5G主要网元接口"></p><p>下面主要讲解Uu空口，它是终端和基站间的接口，其协议栈及功能如下图。至于网络协议为什么要分层，以及分层的好处，请点击 <a href="#BBU%E4%B8%8ERRU">这里</a> 快速阅读。我们通常用“<strong>三层两面</strong>”来描述协议栈的特点，其中PHY层为第一层，MAC层和RLC层为第二层，PDCP层、RRC层和NAS层为第三层，两面即指控制面和用户面。<br><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230838656.png" alt="空口控制面协议栈"><br>上图为空口控制面的协议栈，其用户面协议栈如下图，5G用户面新增一个协议层——SDAP层，以完成 <span class="bubble-content">QoS</span><span class="bubble-notation"><span class="bubble-item" style="background-color: #20B2AA;">QoS流是PDU会话中最精细的QoS区分粒度，这就是说两个PDU会话的区别就在于它们的QoS流不一样（具体一般就是QoS流的TFT参数不同）；在5G系统中一个QoS流ID（QFI）用于标识一条QoS流；PDU会话中具有相同QFI的用户平面数据会获得相同的转发处理（如相同的调度、相同的准入门限等）；QFI在一个PDU会话内要唯一，也就是说一个PDU会话可以有多条（最多64条）QoS流，但每条QoS流的QFI都是不同的（取值范围0~63），UE的两条PDU会话的QFI是可能会重复的；QFI可以动态配置或等于5QI。</span></span> 映射功能。<br><img src="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103230850743.png" alt="空口用户面协议栈"></p><h1 id="网络协议分层">网络协议分层</h1><p>在计算机网络中，人们往往进行分层处理，OSI、TCP/IP都是将这个网络体系工作的流程进行了层次化的划分，按照分层的思想把网络协议栈进行分层主要有以下好处：</p><ul><li><p>各层之间是独立的。某一层并不需要知道它的下一层是如何实现的，而仅仅需要知道该层通过层间的接口所提供的服务。这样，整个问题的复杂程度就下降了。也就是说上一层的工作如何进行并不影响下一层的工作，这样我们在进行每一层的工作设计时只要保证接口不变可以随意调整层内的工作方式。</p></li><li><p>灵活性好。当任何一层发生变化时，只要层间接口关系保持不变，则在这层以上或以下各层均不受影响。当某一层出现技术革新或者某一层在工作中出现问题时不会连累到其他层的工作，排除问题时也只需要考虑这一层单独的问题即可。</p></li><li><p>结构上可分割开。各层都可以采用最合适的技术来实现。技术的发展往往是不对称的，层次化的划分有效避免了木桶效应，不会因为某一方面技术的不完善而影响整体的工作效率。</p></li><li><p>易于实现和维护。这种结构使得实现和调试一个庞大又复杂的系统变得易于处理，因为整个的系统已被分解为若干个相对独立的子系统。进行调试和维护时，可以对每一层进行单独的调试，避免了出现找不到问题、解决错问题的情况。</p></li><li><p>能促进标准化工作。因为每一层的功能及其所提供的服务都已有了精确的说明。标准化的好处就是可以随意替换其中的某几层，对于使用和科研来说十分方便。</p></li></ul><h1 id="细嗦-2">细嗦</h1><h2 id="BBU与RRU">BBU与RRU</h2><p>BBU(Building Baseband Unite室内基带处理单元)集中放置在机房，RRU(Rerate Radio Unite远端射频模块)可安装至楼层，BBU与RRU之间采用光纤传输，RRU再通过同轴电缆（<del>大物电磁学噩梦</del>）及功分器(耦合器)等连接至天线，即主干采用光纤，支路采用同轴电缆。</p><ul><li><p>对于下行方向：光纤从BBU直接连到RRU，BBU和RRU之间传输的是基带数字信号，这样基站可以控制某个用户的信号从指定的RRU通道发射出去，这样可以大大降低对本小区其他通道上用户的干扰。</p></li><li><p>对于上行方向：用户手机信号被距离最近的通道收到，然后从这个通道经过光纤传到基站，这样也可以大大降低不同通道上用户之间的干扰。BBU+RRU方案对于容量配置非常灵活，可按容量需求，在不改变RRU和室内分布系统的前提下，通过配置BBU来支持每通道从1／6载波到3载波的扩容。</p></li></ul><p>理论与实践证实该方案具有下列特点：独特的多通道算法实现空间隔离，可以降低干扰；覆盖和容量可独立规划；降低对干线放大器的依赖；基带容量可实现共享，扩容能力大；光纤无损耗，主干布放简便，RRU部署灵活。但是缺点是需增加光电转换单元，且光纤较容易损坏，需要采用铠装。</p><h1 id="参考资料-2">参考资料</h1><ul><li><a href="https://zhidao.baidu.com/question/1637392502351103540.html">什么是蜂窝无线通信</a>. [2018-04-16]</li><li>中移物联. <a href="https://iot.ofweek.com/2019-07/ART-132209-11000-30400453.html">深度技术剖析长文：5G核心网与接入网的演进</a>. [2019-07-26]</li><li>zhangqing822. <a href="https://www.mscbsc.com/askpro/question2642">什么是RRU和BBU?</a>. [2009-03-11]*   <a href="https://www.arrowsolution.com.cn/mobile.php/Home/Detail/articles/id/140.html">5G无线接入网中的硬件架构— 浅析BBU、RRU、AAU</a>. [2021-01-27]</li><li>LaoYuanPython. <a href="https://blog.csdn.net/LaoYuanPython/article/details/105394978">老猿学5G随笔：RAN、RAT以及anchor移动性锚点的概念</a>. [ 2020-04-08]</li><li>cloudfly_cn. <a href="https://blog.csdn.net/u010178611/article/details/81746532">5G系统——5G QoS</a>. [2018-08-16]</li></ul>]]></content>
      
      
      <categories>
          
          <category> 5G技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 5G </tag>
            
            <tag> 学习笔记 </tag>
            
            <tag> 大学生竞赛 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编程语言，脚本语言or标记语言？？？</title>
      <link href="/38fd64a1/"/>
      <url>/38fd64a1/</url>
      
        <content type="html"><![CDATA[<p><s>不是所有语言都叫编程语言</s></p><hr><h1 id="名词解释">名词解释</h1><p><em>要解释名词，当然是先百科一波。</em></p><ul><li>编程语言（英语：programming language），是用来定义计算机程序的形式语言。</li><li>脚本语言（英语：Scripting language），是为了缩短传统的“编写、编译、链接、运行”（edit-compile-link-run）过程而创建的计算机编程语言。</li><li>标记语言（英语：markup language），是一种将文本（Text）以及文本相关的其他信息结合起来，展现出关于文档结构和数据处理细节的计算机文字编码。</li></ul><p><em>看不懂正常，下面用人话翻译一下</em></p><hr><h1 id="人话辨析">人话辨析</h1><p>编程语言通常用于向机器发出一系列复杂的指令。在程序执行之前，需要一个专门的编译过程，即使用一个编译器把代码编译成为机器语言的二进制文件，以<strong>可执行文件</strong>的形式存在，比如exe文件，以后要运行的话就不用重新翻译了，直接使用编译的结果就行了（exe文件），因为翻译只做了一次，<strong>运行时不需要翻译</strong>，所以编译型语言的程序执行效率较高。如C语言、C艹等</p><p>而脚本语言是一种解释性的语言，不需要编译，需要<strong>解释</strong>执行，由解释器来负责解释。只有在执行程序时,解释器一条一条的解释成机器语言给计算机来执行（<strong>并不生成二进制文件</strong>）, 所以运行速度是不如编译后的程序运行的快。需要注意的是，翻译器并不产生目标机器代码，而是产生易于执行的中间代码，这种中间代码与机器代码是不同的，中间代码的解释是由软件支持的，不能直接使用硬件，这也是它执行效率较低的另一个原因。如比如JavaScript、PHP、Python等</p><p>简单的来讲，标记语言就是带信息的文本，其本身没有行为能力，不能向计算机发送指令。如markdown、html等</p><hr><h1 id="编译和解释">编译和解释</h1><p>下面具体说一些编译和解释。</p><p>编译是将源程序翻译成可执行的目标代码，翻译与执行是分开的；而解释是对源程序的翻译与执行一次性完成，不生成可存储的目标代码。这只是表象，二者背后的最大区别是：对编译执行而言，运行时的控制权在<strong>用户程序</strong>; 对解释执行而言，程序运行时的控制权在<strong>解释器</strong>而不在用户程序。</p><p>解释具有良好的动态特性和可移植性，比如在解释执行时可以动态改变变量的类型、对程序进行修改以及在程序中插入良好的调试诊断信息等，而在不同系统中，只要将解释器移植过来，则程序不用改动就可以在该系统上运行。同时解释器也有很大的缺点，比如执行效率低，占用空间大，因为不仅要给用户程序分配空间，解释器本身也占用了宝贵的系统资源。</p><p>值得注意的是，一个语言是不是”脚本”我们不应该只是从语言角度去看待,应该要从<strong>运行所在的环境</strong>去区别。比如你完全可以写一个C语言的解释器,并且将它作为脚本语言来运行。同样也可以将JavaScript编译成机器代码并且存放在可执行文件中。Ruby就是一个很好的例子,它以一个解释器(脚本语言)出现,但现在已经有多个编译器可以编译它了。</p><hr><h1 id="冷知识">冷知识</h1><p>最早的编程语言是在电脑发明之前产生的，当时是用来控制提花织布机及自动演奏钢琴的动作。<del>想不到吧hhh</del></p><hr><h1 id="参考资料-9">参考资料</h1><ul><li>wikipedia. <a href="https://zh.wikipedia.org/wiki/%E7%BD%AE%E6%A0%87%E8%AF%AD%E8%A8%80">markup language</a></li><li>wikipedia. <a href="https://zh.wikipedia.org/wiki/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80">programming language</a></li><li>wikipedia. <a href="https://zh.wikipedia.org/wiki/%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80">Scripting language</a></li><li>petercao. <a href="https://www.cnblogs.com/bluestorm/archive/2012/12/09/2810167.html">编译和解释的区别是什么？</a>. [2012-12-09]</li><li>晨曦之园. <a href="https://blog.csdn.net/ChinaGir/article/details/97886786?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_default&amp;utm_relevant_index=1">标记语言、脚本语言和编程语言的含义和比较</a>. [2019-07-31]</li><li>ophui123. <a href="https://blog.csdn.net/OPHUI123/article/details/46765615">标记语言、编程语言、脚本语言的区别？</a>. [2015.07.05]</li></ul>]]></content>
      
      
      <categories>
          
          <category> 刨根问底 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 研究报告 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MarkDown的诞生</title>
      <link href="/53450568/"/>
      <url>/53450568/</url>
      
        <content type="html"><![CDATA[<p><em>搭建完博客框架，之后的博客将以markdown的形式书写。虽然之前也有耳闻，但这算是第一次正式使用markdown写作。<br>我的第一个专栏是刨根问底系列，主要探索各项产品、技术或服务等的前世今生，分析其产生的原因，作者的背景以及小故事，从而对其有更全面和深入的了解。那么第一篇博客就从markdown入手吧。<br>——编者按</em></p><img src ="https://asa-world-1309727865.cos.ap-chengdu.myqcloud.com/pic/image-20230103221138387.png" align ="right" height="200"><hr><h1 id="天才少年——Aaron-Swartz">天才少年——Aaron Swartz</h1><p>让我们先聊聊markdown的创始人之一 、<span class="bubble-content">“互联网之子”</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#708090;">《互联网之子：亚伦斯沃茨的故事》（The Internet’s Own Boy:The Story of Aaron Swartz）讲述了Swartz，国安局，和《禁止网络盗版法案》法案的故事。《Mashable》称这部纪录片是给“Aaron Swartz的有力量的献礼”，在圣丹普西的首映中得到了观众的起立鼓掌。</span></span> Aaron Swartz吧。</p><h2 id="“互联网之子”">“互联网之子”</h2><p>1986年出生在芝加哥的一个犹太家庭。由于父亲创立一家软件公司，Swartz很小的时候就接触和研究编程和互联网文化。<br>2000年，14岁的他成为编写 <span class="bubble-content">RSS</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#DA70D6;">英文全称：RDF Site Summary 或 Really Simple Syndication，中文译作简易信息聚合，也称聚合内容，是一种消息来源格式规范，用以聚合多个网站更新的内容并自动通知网站订阅者。</span></span> 1.0网络联合规范的工作组成员。<br>2005年，他就读于<strong>斯坦福大学</strong>，但在第一年之后就离开了学校。</p><blockquote><p>“这里有一些很棒的教授，我当然学到了很多，但我觉得那里的氛围不是很学术，因为大多数其他孩子似乎对他们的学习完全不关心。”他在后来的博客文章中写道。</p></blockquote><p>之后他开始创业。2005年创建 <span class="bubble-content">Infogami</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#191970;"> Swartz曾申请Y Combinator的第一批夏日创始人计划，提出创办一家叫做Infogami的公司，通过建设内容管理系统，来帮助创建生动有趣的网站或者是结构化数据的维基。</span></span>，之后与Reddit合并成为其合伙人。<br>同时他也关心政治。2009 年，Swartz帮助发起了进步变革运动委员会（Progressive Change Campaign Committee）。2010 年，Swartz 与他人共同创立了政治倡导组织——求进会（Demand Progress），该组织在网上组织人们*“通过联系国会和其他领导人、资助施压策略和传播有关公民自由、政府改革的信息采取行动”* 等问题。</p><blockquote><p>他在他的博客中写道：“我每天都在试验新的方法来制定进步政策并选出进步的政治家。”</p><p>“Aaron拥有无以伦比的政治洞见力、技术能力和处理人、事的智能。我认为他本可以彻底改变美国（及世界）政治。” 科幻小说作家Cory Doctorow如是说。</p></blockquote><p>如此优秀的“天才少年”本可以大展身手，推动科技和政治的发展，不料，<strong>灾难</strong>逐渐来临。</p><h2 id="天妒英才">天妒英才</h2><p>根据州和联邦当局的说法，在 2010 年底和 2011 年初的几周内 Swartz 通过麻省理工学院（MIT）的计算机网络使用JSTOR（一个数字存储库）下载了大量学术期刊文章并上传到网络提供给网民。</p><blockquote><p>2010 年 9 月 29 日，一名 JSTOR 员工给麻省理工学院发了电子邮件：<br>请注意，这是一个极端情况。我们通常一次只暂停一个单独的 IP，并且相对不频繁地这样做（在忙碌的一天可能会暂停 6 个，来自 7000 多个机构订阅者）。在这种情况下，我在这里的 5 年里只看过大约 3 或 4 次。使用的模式是为每个 PDF 下载或每隔几个创建一个新会话，我们在高峰期的一小时内看到了超过 200K 的会话。</p></blockquote><p>2012 年 9 月 12 日，联邦检察官提交了替代起诉书，增加 9 项重罪，将 Swartz 的最高刑事风险提高到 50 年监禁和 100 万美元的罚款。2013 年 1 月 11 日晚上，斯沃茨的女友发现他在布鲁克林的公寓自缢而死。</p><p>年仅27的Swartz以这样一个方式离开真的蛮可惜的，他的生命正是为了“自由”而燃烧。他的成绩是显著的，维基百科对他的介绍是：软件工程师、作家、政治组织者、互联网活动家、维基百科人，2013年，Swartz被追授入<strong>互联网名人堂</strong>（Internet Hall of Fame）。向前看，正如媒体称，他留下的遗产仍然对当下产生着影响 。</p><h2 id="Swartz和markdawn">Swartz和markdawn</h2><p><s>逐渐忘记标题</s><br>话归正题，Swartz为什么要创造markdown呢，markdown的优势在于什么呢？我们从Swartz的博客中就可窥见一斑。</p><blockquote><p>几个月来，我一直在和John Gruber合作一个新项目。这个想法是通过允许你使用几乎相同的语法并将其自动转换为HTML，使编写简单的网页，尤其是博客条目，与编写电子邮件一样简单。我们一起从上到下仔细研究了语法细节，试图开发出完美的格式，我认为我们得到了一些非常棒的东西。</p></blockquote><p>同时John Gruber 在其博客也中写到在还没有Markdown 的当年，用 BBEdit 编辑和预览 HTML 并拷贝到 Movable Type 发布的不愉快经历。这种不爽的体验促使他做出改变，才有了 Markdown 的诞生。</p><p>显然，设计 Markdown 最主要目的，是为了<strong>更好地编辑和更高的可读性</strong>。针对那些要发布在网络上的文档来说，如果需要做到结构清晰段落分明，最终都是需要转化为 HTML 格式，而书写大段的 HTML 内容绝对是糟糕的体验。Markdown 用尽可能简洁的语法格式，让创作者更专注于文章内容而非形式，这种<strong>极简主义</strong>我很欣赏，话说回来，Swartz的博客充分体现了他的极简倾向，一开始打开博客的时候我还以为没有加载完，结果等了半天发现真的只有这么多hhhhhh</p><hr><h1 id="MarkDown优缺点">MarkDown优缺点</h1><h2 id="优点">优点</h2><ul><li><strong>输入简单， 容易聚焦</strong><br>像之前的 <span class="bubble-content">富文本编辑器</span><span class="bubble-notation"><span class="bubble-item" style="background-color: #556B2F;"> 英文全称：Multi-function Text Editor， 简称MTE， 是一种可内嵌于浏览器，所见即所得的文本编辑器。它可以使用户方便的更改帖子的字体、颜色等信息而不是使用html语言。</span></span> 的使用其实较为耗费创作者心智，需要选中文字，然后在选择某个样式排版功能。<br>Markdown 让一切都发生在文字输入层面。这种简化的操作使得创作不会被打断，让人容易聚焦。</li><li><strong>标准公开统一，让人安心</strong><br>使用 Markdown 进行写作是让人安心的，无论使用哪个编辑器里，基本的语法都是一致的，例如：# 就是1级标题开头，这点不会变。无论是大厂还是小厂，都要遵循这个公开标准，因此不会将创作者绑架在一个特定产品上。</li></ul><h2 id="缺点">缺点</h2><ul><li><strong>需要一定的学习成本</strong><br>相比于word之类的可视化编辑，markdown需要一定的学习成本，需要创作者了解相关的编辑格式，因此对于小白不太友好。</li></ul><hr><h1 id="MarkDown速记知识点">MarkDown速记知识点</h1><p><s>敲黑板</s></p><ul><li>标题：n个#就是n级标题。</li><li>换行：文末加两个以上Enter可空出一行</li><li>字体：<ul><li>*斜体* —&gt; <em>斜体</em></li><li>**粗体** —&gt; <strong>粗体</strong></li><li>***粗斜体*** —&gt; <em><strong>粗斜体</strong></em></li></ul></li><li>分割线：三个以上的-<br>删除线：~~删除线~~ —&gt; <s>删除线</s><br>下划线：~~下划线~~ —&gt; <s>下划线</s></li><li>无序列表：- + <kbd>Space</kbd><br>有序列表：<kbd>num</kbd>+<kbd>.</kbd>+<kbd>Space</kbd><br>区块：<kbd>></kbd><br>代码句：<kbd>`</kbd> + 代码 + <kbd>`</kbd><br>代码块：首尾 <kbd>```</kbd> 包裹代码（可在第一个<kbd>```</kbd> 后添加代码语言）</li><li>链接：[链接名](网址) 或 &lt;网址&gt; 或 [链接名][变量]，文末加注释<br>链接到标题：[名称](#标题名)</li><li>具体教程请戳<a href="https://www.runoob.com/markdown/md-tutorial.html">菜鸟教程</a></li></ul><hr><h1 id="参考资料-5">参考资料</h1><ul><li>Matthews, Laura. <a href="https://www.ibtimes.com/who-aaron-swartz-jstor-mit-hacker-full-text-300177">Who is Aaron Swartz, the JSTOR MIT Hacker?</a>. <em>International Business Times</em>. [2011-07-19].</li><li>Aaron Swartz. <a href="http://www.aaronsw.com/weblog/pcccjob">How to Get a Job Like Mine</a>. [2010-04-07]</li><li>Aaron Swartz.<a href="http://www.aaronsw.com/weblog/001189">markdown</a>. [2004-03-19]</li><li>Wikipedia. <a href="https://zh.wikipedia.org/wiki/%E4%BA%9A%E4%BC%A6%C2%B7%E6%96%AF%E6%B2%83%E8%8C%A8">Aaron Swartz</a></li><li>github_39294367. <a href="https://blog.csdn.net/github_39294367/article/details/103784632?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1.pc_relevant_aa&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1.pc_relevant_aa&amp;utm_relevant_index=1">markdown</a>. [2019-05-09]</li><li>Another developer’s blog. <a href="https://lin.am/blog/2018-11-15-markdown-history/">Markdown 发展史</a></li><li>望儿山下小苗圃. <a href="https://blog.csdn.net/leozhangit/article/details/109224226">Markdown的前世今生 + CSDN的Markdown语法和使用大全</a>. [2020-10-22]</li></ul>]]></content>
      
      
      <categories>
          
          <category> 刨根问底 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 研究报告 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
